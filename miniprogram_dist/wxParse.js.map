{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/wxParse.js","webpack:///./src/utils/html2json.js","webpack:///./src/utils/wxDiscode.js","webpack:///./src/utils/htmlparser.js","webpack:///./src/utils/showdown.js","webpack:///./src/utils/util.js"],"names":["Component","properties","nodes","type","observer","val","language","_parseNodes","converter","showdown","Converter","parseNodes","makeHtml","String","value","data","nodesData","bindData","detached","bindInstance","clear","methods","_parseHtml","html","bindName","transData","HtmlToJson","html2json","view","imagePadding","setData","set","console","log","Array","isArray","wxParseImgLoad","e","target","dataset","tagFrom","from","index","length","detail","width","height","recal","_wxAutoImageCal","imageWidth","imageHeight","wxParseImgTap","src","imageUrls","wx","previewImage","current","urls","originalWidth","originalHeight","autoWidth","autoHeight","results","windowWidth","windowHeight","wxParseTagATap","currentTarget","curPages","getCurrentPages","currentPage","handleTagATap","isInnerPage","indexOf","navigateTo","url","__placeImgeUrlHttps","__emojisReg","__emojisBaseSrc","__emojis","wxDiscode","require","HTMLParser","empty","makeMap","block","inline","closeSelf","fillAttrs","special","str","obj","items","split","i","q","v","removeDOCTYPE","replace","trimHtml","strDiscode","bufArray","node","images","start","tag","attrs","unary","toString","parent","undefined","tagType","attr","reduce","pre","name","classStr","styleStr","match","push","imgIndex","imgUrl","splice","urlToHttpUrl","fontSize","styleAttrs","style","key","source","unshift","end","shift","error","chars","text","textArray","transEmojiStr","comment","emojiObjs","emojiObj","array","eReg","RegExp","ele","baseSrc","emojisInit","reg","emojis","module","exports","strNumDiscode","strGreeceDiscode","strcharacterDiscode","strOtherDiscode","strMoreDiscode","rep","patt1","result","test","startTag","endTag","handler","stack","last","substring","parseEndTag","parseStartTag","all","tagName","rest","toLowerCase","arguments","escaped","pos","getDefaultOpts","simple","defaultOptions","omitExtraWLInCodeBlocks","defaultValue","describe","noHeaderId","prefixHeaderId","headerLevelStart","parseImgDimensions","simplifiedAutoLink","literalMidWordUnderscores","strikethrough","tables","tablesHeaderId","ghCodeBlocks","tasklists","smoothLivePreview","smartIndentationFix","description","JSON","parse","stringify","ret","opt","hasOwnProperty","parsers","extensions","globalOptions","flavor","github","vanilla","helper","setOption","getOption","getOptions","resetOptions","setFlavor","preset","option","getDefaultOptions","subParser","func","isString","Error","extension","ext","stdExtName","isUndefined","validExtension","validate","valid","getAllExtensions","removeExtension","resetExtensions","errMsg","baseMsg","listeners","filter","regex","ln","validateExtension","warn","a","isFunction","getType","call","forEach","callback","constructor","s","escapeCharactersCallback","wholeMatch","m1","charCodeToEscape","charCodeAt","escapeCharacters","charsToEscape","afterBackslash","regexString","rgxFindMatchPos","left","right","flags","f","g","x","l","t","m","exec","lastIndex","matchRecursiveRegExp","matchPos","slice","replaceRecursiveRegExp","replacement","repStr","finalStr","lng","bits","join","msg","alert","converterOptions","options","langExtensions","outputModifiers","_constructor","gOpt","_parseExtension","legacyExtensionLoading","validExt","listen","rTrimInputText","rsp","rgx","_dispatch","dispatch","evtName","globals","ei","nText","gHtmlBlocks","gHtmlMdBlocks","gHtmlSpans","gUrls","gTitles","gDimensions","gListLevel","hashLinkCounts","addExtension","useExtension","extensionName","ii","output","writeAnchorTag","m2","m3","m4","m5","m6","m7","linkText","linkId","title","search","simpleURLRegex","delimUrlRegex","simpleMailRegex","delimMailRegex","replaceLink","replaceMail","wm","link","lnkTxt","unescapedStr","bq","pattern","codeblock","nextChar","c","leadingText","numSpaces","addr","encode","ch","Math","floor","random","r","blockText","blockTags","repFunc","txt","config","matches","prefixHeader","isNaN","parseInt","setextRegexH1","setextRegexH2","spanGamut","hID","headerId","hLevel","hashBlock","matchFound","span","header","escapedId","inlineRegExp","referenceRegExp","writeImageTag","altText","gDims","processListItems","listStr","trimTrailing","isParagraphed","taskbtn","checked","trim","item","bulletStyle","otp","parseConsecutiveLists","list","listType","counterRxg","subLists","parseCL","wholeList","grafs","grafsOut","grafsOutIt","codeFlag","delim","$1","num","$2","re","blankLines","tableRgx","parseStyles","sLine","parseHeaders","id","tableHeaderId","parseCells","cell","subText","buildTable","headers","cells","tb","tblLgn","rawTable","tableLines","rawHeaders","map","rawStyles","rawCells","styles","row","charCodeToReplace","fromCharCode","getSystemInfo","success","res","instance"],"mappings":";;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;;;;;;;;AClFA;;;;AACA;;;;AACA;;;;AAEAA,UAAU;AACRC,cAAY;AACVC,WAAO;AACLC,YAAM,IADD;AAELC,cAFK,oBAEIC,GAFJ,EAES;AAAA,YACJC,QADI,GACS,KAAKL,UADd,CACJK,QADI;;AAEZ,YAAID,GAAJ,EAAS;AACP,cAAIC,aAAa,MAAjB,EAAyB;AACvB,iBAAKC,WAAL,CAAiBF,GAAjB;AACD;;AAED,cAAIC,aAAa,UAAb,IAA2BA,aAAa,IAA5C,EAAkD;AAChD,gBAAME,YAAY,IAAIC,mBAASC,SAAb,EAAlB;AACA,gBAAMC,aAAaH,UAAUI,QAAV,CAAmBP,GAAnB,CAAnB;AACA,iBAAKE,WAAL,CAAiBI,UAAjB;AACD;AACF;AACF;AAfI,KADG;;AAmBVL,cAAU;AACRH,YAAMU,MADE;AAERC,aAAO,MAFC,CAEM;AAFN;AAnBA,GADJ;;AA0BRC,QAAM;AACJC,eAAW,EADP;AAEJC,cAAU;AAFN,GA1BE;;AA+BRC,UA/BQ,sBA+BG;AACT;AACAC,uBAAaC,KAAb;AACD,GAlCO;;;AAoCRC,WAAS;AACPC,cADO,sBACIC,IADJ,EACUC,QADV,EACoB;AAAA;;AACzBA,iBAAW,aAAX;;AAEA;AACA,UAAMC,YAAYC,oBAAWC,SAAX,CAAqBJ,IAArB,EAA2BC,QAA3B,CAAlB;;AAEAC,gBAAUG,IAAV,GAAiB,EAAjB;AACAH,gBAAUG,IAAV,CAAeC,YAAf,GAA8B,CAA9B;AACA,WAAKC,OAAL,CAAa;AACXd,mBAAWS,UAAUvB,KADV;AAEXe,6CACGO,QADH,IACcC,SADd;AAFW,OAAb;AAMAN,yBAAaY,GAAb,CAAiBP,QAAjB,EAA2BC,SAA3B;AACAO,cAAQC,GAAR,CAAY,KAAKlB,IAAjB;AACD,KAjBM;AAmBPR,eAnBO,uBAmBKL,KAnBL,EAmBY;AACjB,UAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAAE;AAC/B,aAAKoB,UAAL,CAAgBpB,KAAhB;AACD,OAFD,MAEO,IAAIgC,MAAMC,OAAN,CAAcjC,KAAd,CAAJ,EAA0B;AAAE;AACjC,aAAK4B,OAAL,CAAa,EAAEd,WAAWd,KAAb,EAAb;AACD,OAFM,MAEA;AAAE;AACP,YAAMc,YAAY,CAAEd,KAAF,CAAlB;AACA,aAAK4B,OAAL,CAAa,EAAEd,oBAAF,EAAb;AACD;AACF,KA5BM;;;AA8BP;;;;AAIAoB,kBAlCO,0BAkCQC,CAlCR,EAkCW;AAChB;AADgB,iBAEiBA,EAAEC,MAAF,CAASC,OAAT,IAAoB,EAFrC;AAAA,UAEFC,OAFE,QAERC,IAFQ;AAAA,UAEOC,KAFP,QAEOA,KAFP;;AAGhB,UAAI,OAAOF,OAAP,KAAmB,WAAnB,IAAkCA,QAAQG,MAAR,GAAiB,CAAvD,EAA0D;AAAA;;AAAA,wBAC9BN,EAAEO,MAD4B;AAAA,YAChDC,KADgD,aAChDA,KADgD;AAAA,YACzCC,MADyC,aACzCA,MADyC;;AAGxD;;AACA,YAAMC,QAAQ,KAAKC,eAAL,CAAqBH,KAArB,EAA4BC,MAA5B,CAAd;AACA,aAAKhB,OAAL;AACEe,iBAAOE,MAAME,UADf;AAEEH,kBAAQC,MAAMG;AAFhB,mCAGgBR,KAHhB,iBAGkC,IAHlC;AAKD;AACF,KAhDM;;;AAkDP;;;;AAIAS,iBAtDO,yBAsDOd,CAtDP,EAsDU;AAAA,UACPe,GADO,GACCf,EAAEC,MAAF,CAASC,OADV,CACPa,GADO;;AAEf,UAAM5B,WAAW,aAAjB;;AAFe,8BAGOL,mBAAaY,GAAb,CAAiBP,QAAjB,CAHP;AAAA,UAGP6B,SAHO,qBAGPA,SAHO;;AAIfC,SAAGC,YAAH,CAAgB;AACdC,iBAASJ,GADK;AAEdK,cAAMJ;AAFQ,OAAhB;AAID,KA9DM;;;AAgEP;;;;;AAKAL,mBArEO,2BAqESU,aArET,EAqEwBC,cArExB,EAqEwC;AAC7C,UAAIC,YAAY,CAAhB;AAAA,UAAmBC,aAAa,CAAhC;AACA,UAAMC,UAAU,EAAhB;;AAF6C,2BAGP,0BAHO;AAAA,UAGrCC,WAHqC;AAAA,UAGxBC,YAHwB;;AAK7C;;;AACA,UAAIN,gBAAgBK,WAApB,EAAiC;AAAE;AACjCH,oBAAYG,WAAZ;AACAF,qBAAcD,YAAYD,cAAb,GAA+BD,aAA5C;AACAI,gBAAQb,UAAR,GAAqBW,SAArB;AACAE,gBAAQZ,WAAR,GAAsBW,UAAtB;AACD,OALD,MAKO;AAAE;AACPC,gBAAQb,UAAR,GAAqBS,aAArB;AACAI,gBAAQZ,WAAR,GAAsBS,cAAtB;AACD;AACD,aAAOG,OAAP;AACD,KArFM;;;AAuFP;;;;;;AAMAG,kBA7FO,0BA6FQ5B,CA7FR,EA6FW;AAAA,kCACKA,EAAE6B,aAAF,CAAgB3B,OADrB,CACRa,GADQ;AAAA,UACRA,GADQ,yCACF,EADE;;AAGhB;;AACA,UAAMe,WAAYC,iBAAlB;AACA,UAAMC,cAAcF,SAASA,SAASxB,MAAT,GAAkB,CAA3B,CAApB;AACA,UAAI0B,eAAeA,YAAYC,aAA/B,EAA8C;AAC5CD,oBAAYC,aAAZ,CAA0BlB,GAA1B;AACA;AACD;;AAED;AACA,UAAMmB,cAAcnB,IAAIoB,OAAJ,CAAY,MAAZ,MAAwB,CAAC,CAA7C;AACA,UAAID,WAAJ,EAAiB;AACfjB,WAAGmB,UAAH,CAAc;AACZC,eAAKtB;AADO,SAAd;AAGD,OAJD,MAIO;AACLE,WAAGmB,UAAH,CAAc;AACZC,0FAA8EtB;AADlE,SAAd;AAGD;AACF;AAnHM;AApCD,CAAV,E;;;;;;;;;ACJA;;;;;;AAMA,IAAIuB,sBAAsB,OAA1B;AACA,IAAIC,cAAc,EAAlB;AACA,IAAIC,kBAAkB,EAAtB;AACA,IAAIC,WAAW,EAAf;AACA,IAAIC,YAAYC,mBAAOA,CAACA,EAAgBA,CAAxC;AACA,IAAIC,aAAaD,mBAAOA,CAACA,EAAiBA,CAA1C;AACA;AACA,IAAIE,QAAQC,QAAQ,oGAAR,CAAZ;AACA;AACA,IAAIC,QAAQD,QAAQ,uTAAR,CAAZ;;AAEA;AACA,IAAIE,SAASF,QAAQ,0LAAR,CAAb;;AAEA;AACA;AACA,IAAIG,YAAYH,QAAQ,kDAAR,CAAhB;;AAEA;AACA,IAAII,YAAYJ,QAAQ,wGAAR,CAAhB;;AAEA;AACA,IAAIK,UAAUL,QAAQ,oDAAR,CAAd;AACA,SAASA,OAAT,CAAiBM,GAAjB,EAAsB;AAClB,QAAIC,MAAM,EAAV;AAAA,QAAcC,QAAQF,IAAIG,KAAJ,CAAU,GAAV,CAAtB;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,MAAMhD,MAA1B,EAAkCkD,GAAlC;AACIH,YAAIC,MAAME,CAAN,CAAJ,IAAgB,IAAhB;AADJ,KAEA,OAAOH,GAAP;AACH;;AAED,SAASI,CAAT,CAAWC,CAAX,EAAc;AACV,WAAO,MAAMA,CAAN,GAAU,GAAjB;AACH;;AAED,SAASC,aAAT,CAAuBzE,IAAvB,EAA6B;AACzB,WAAOA,KACF0E,OADE,CACM,eADN,EACuB,EADvB,EAEFA,OAFE,CAEM,mBAFN,EAE2B,EAF3B,EAGFA,OAHE,CAGM,mBAHN,EAG2B,EAH3B,CAAP;AAIH;;AAED,SAASC,QAAT,CAAkB3E,IAAlB,EAAwB;AACtB,WAAOA,KACA0E,OADA,CACQ,SADR,EACmB,EADnB,EAEAA,OAFA,CAEQ,cAFR,EAEwB,EAFxB,EAGAA,OAHA,CAGQ,eAHR,EAGyB,EAHzB,EAIAA,OAJA,CAIQ,SAJR,EAImB,GAJnB,CAAP;AAKD;;AAGD,SAAStE,SAAT,CAAmBJ,IAAnB,EAAyBC,QAAzB,EAAmC;AAC/B;AACAD,WAAOyE,cAAczE,IAAd,CAAP;AACAA,WAAO2E,SAAS3E,IAAT,CAAP;AACAA,WAAOwD,UAAUoB,UAAV,CAAqB5E,IAArB,CAAP;AACA;AACA,QAAI6E,WAAW,EAAf;AACA,QAAItC,UAAU;AACVuC,cAAM7E,QADI;AAEVtB,eAAO,EAFG;AAGVoG,gBAAO,EAHG;AAIVjD,mBAAU;AAJA,KAAd;AAMA,QAAIX,QAAQ,CAAZ;AACAuC,eAAW1D,IAAX,EAAiB;AACbgF,eAAO,eAAUC,GAAV,EAAeC,KAAf,EAAsBC,KAAtB,EAA6B;AAChC;AACA;AACA,gBAAIL,OAAO;AACPA,sBAAM,SADC;AAEPG,qBAAKA;AAFE,aAAX;;AAKA,gBAAIJ,SAASzD,MAAT,KAAoB,CAAxB,EAA2B;AACvB0D,qBAAK3D,KAAL,GAAaA,MAAMiE,QAAN,EAAb;AACAjE,yBAAS,CAAT;AACH,aAHD,MAGO;AACH,oBAAIkE,SAASR,SAAS,CAAT,CAAb;AACA,oBAAIQ,OAAO1G,KAAP,KAAiB2G,SAArB,EAAgC;AAC5BD,2BAAO1G,KAAP,GAAe,EAAf;AACH;AACDmG,qBAAK3D,KAAL,GAAakE,OAAOlE,KAAP,GAAe,GAAf,GAAqBkE,OAAO1G,KAAP,CAAayC,MAA/C;AACH;;AAED,gBAAIyC,MAAMoB,GAAN,CAAJ,EAAgB;AACZH,qBAAKS,OAAL,GAAe,OAAf;AACH,aAFD,MAEO,IAAIzB,OAAOmB,GAAP,CAAJ,EAAiB;AACpBH,qBAAKS,OAAL,GAAe,QAAf;AACH,aAFM,MAEA,IAAIxB,UAAUkB,GAAV,CAAJ,EAAoB;AACvBH,qBAAKS,OAAL,GAAe,WAAf;AACH;;AAED,gBAAIL,MAAM9D,MAAN,KAAiB,CAArB,EAAwB;AACpB0D,qBAAKU,IAAL,GAAYN,MAAMO,MAAN,CAAa,UAAUC,GAAV,EAAeF,IAAf,EAAqB;AAC1C,wBAAIG,OAAOH,KAAKG,IAAhB;AACA,wBAAIpG,QAAQiG,KAAKjG,KAAjB;AACA,wBAAIoG,QAAQ,OAAZ,EAAqB;AACjB;AACA;AACAb,6BAAKc,QAAL,GAAgBrG,KAAhB;AACH;AACD;AACA;AACA,wBAAIoG,QAAQ,OAAZ,EAAqB;AACjB;AACA;AACAb,6BAAKe,QAAL,GAAgBtG,KAAhB;AACH;AACD,wBAAIA,MAAMuG,KAAN,CAAY,GAAZ,CAAJ,EAAsB;AAClBvG,gCAAQA,MAAM8E,KAAN,CAAY,GAAZ,CAAR;AACH;;AAGD;AACA;AACA,wBAAIqB,IAAIC,IAAJ,CAAJ,EAAe;AACX,4BAAIhF,MAAMC,OAAN,CAAc8E,IAAIC,IAAJ,CAAd,CAAJ,EAA8B;AAC1B;AACAD,gCAAIC,IAAJ,EAAUI,IAAV,CAAexG,KAAf;AACH,yBAHD,MAGO;AACH;AACAmG,gCAAIC,IAAJ,IAAY,CAACD,IAAIC,IAAJ,CAAD,EAAYpG,KAAZ,CAAZ;AACH;AACJ,qBARD,MAQO;AACH;AACAmG,4BAAIC,IAAJ,IAAYpG,KAAZ;AACH;;AAED,2BAAOmG,GAAP;AACH,iBApCW,EAoCT,EApCS,CAAZ;AAqCH;;AAED;AACA,gBAAIZ,KAAKG,GAAL,KAAa,KAAjB,EAAwB;AACpBH,qBAAKkB,QAAL,GAAgBzD,QAAQwC,MAAR,CAAe3D,MAA/B;AACA,oBAAI6E,SAASnB,KAAKU,IAAL,CAAU3D,GAAvB;AACA,oBAAIoE,OAAO,CAAP,KAAa,EAAjB,EAAqB;AACjBA,2BAAOC,MAAP,CAAc,CAAd,EAAiB,CAAjB;AACH;AACDD,yBAASzC,UAAU2C,YAAV,CAAuBF,MAAvB,EAA+B7C,mBAA/B,CAAT;AACA0B,qBAAKU,IAAL,CAAU3D,GAAV,GAAgBoE,MAAhB;AACAnB,qBAAK5D,IAAL,GAAYjB,QAAZ;AACAsC,wBAAQwC,MAAR,CAAegB,IAAf,CAAoBjB,IAApB;AACAvC,wBAAQT,SAAR,CAAkBiE,IAAlB,CAAuBE,MAAvB;AACH;;AAED;AACA,gBAAInB,KAAKG,GAAL,KAAa,MAAjB,EAAyB;AACrB,oBAAImB,WAAW,CAAC,SAAD,EAAY,OAAZ,EAAqB,QAArB,EAA+B,OAA/B,EAAwC,SAAxC,EAAmD,UAAnD,EAA+D,mBAA/D,CAAf;AACA,oBAAIC,aAAa;AACb,6BAAS,OADI;AAEb,4BAAQ,aAFK;AAGb,4BAAQ;AAHK,iBAAjB;AAKA,oBAAI,CAACvB,KAAKU,IAAL,CAAUc,KAAf,EAAsBxB,KAAKU,IAAL,CAAUc,KAAV,GAAkB,EAAlB;AACtB,oBAAI,CAACxB,KAAKe,QAAV,EAAoBf,KAAKe,QAAL,GAAgB,EAAhB;AACpB,qBAAK,IAAIU,GAAT,IAAgBF,UAAhB,EAA4B;AACxB,wBAAIvB,KAAKU,IAAL,CAAUe,GAAV,CAAJ,EAAoB;AAChB,4BAAIhH,QAAQgH,QAAQ,MAAR,GAAiBH,SAAStB,KAAKU,IAAL,CAAUe,GAAV,IAAe,CAAxB,CAAjB,GAA8CzB,KAAKU,IAAL,CAAUe,GAAV,CAA1D;AACAzB,6BAAKU,IAAL,CAAUc,KAAV,CAAgBP,IAAhB,CAAqBM,WAAWE,GAAX,CAArB;AACAzB,6BAAKU,IAAL,CAAUc,KAAV,CAAgBP,IAAhB,CAAqBxG,KAArB;AACAuF,6BAAKe,QAAL,IAAiBQ,WAAWE,GAAX,IAAkB,IAAlB,GAAyBhH,KAAzB,GAAiC,GAAlD;AACH;AACJ;AACJ;;AAED;AACA,gBAAGuF,KAAKG,GAAL,KAAa,QAAhB,EAAyB;AACrB1C,wBAAQiE,MAAR,GAAiB1B,KAAKU,IAAL,CAAU3D,GAA3B;AACH;;AAED,gBAAIsD,KAAJ,EAAW;AACP;AACA;AACA;AACA,oBAAIE,SAASR,SAAS,CAAT,KAAetC,OAA5B;AACA,oBAAI8C,OAAO1G,KAAP,KAAiB2G,SAArB,EAAgC;AAC5BD,2BAAO1G,KAAP,GAAe,EAAf;AACH;AACD0G,uBAAO1G,KAAP,CAAaoH,IAAb,CAAkBjB,IAAlB;AACH,aATD,MASO;AACHD,yBAAS4B,OAAT,CAAiB3B,IAAjB;AACH;AACJ,SAvHY;AAwHb4B,aAAK,aAAUzB,GAAV,EAAe;AAChB;AACA;AACA,gBAAIH,OAAOD,SAAS8B,KAAT,EAAX;AACA,gBAAI7B,KAAKG,GAAL,KAAaA,GAAjB,EAAsBxE,QAAQmG,KAAR,CAAc,iCAAd;;AAEtB;AACA,gBAAG9B,KAAKG,GAAL,KAAa,OAAb,IAAwB1C,QAAQiE,MAAnC,EAA0C;AACtC1B,qBAAKU,IAAL,CAAU3D,GAAV,GAAgBU,QAAQiE,MAAxB;AACA,uBAAOjE,QAAQiE,MAAf;AACH;;AAED,gBAAI3B,SAASzD,MAAT,KAAoB,CAAxB,EAA2B;AACvBmB,wBAAQ5D,KAAR,CAAcoH,IAAd,CAAmBjB,IAAnB;AACH,aAFD,MAEO;AACH,oBAAIO,SAASR,SAAS,CAAT,CAAb;AACA,oBAAIQ,OAAO1G,KAAP,KAAiB2G,SAArB,EAAgC;AAC5BD,2BAAO1G,KAAP,GAAe,EAAf;AACH;AACD0G,uBAAO1G,KAAP,CAAaoH,IAAb,CAAkBjB,IAAlB;AACH;AACJ,SA7IY;AA8Ib+B,eAAO,eAAUC,IAAV,EAAgB;AACnB;AACA,gBAAIhC,OAAO;AACPA,sBAAM,MADC;AAEPgC,sBAAMA,IAFC;AAGPC,2BAAUC,cAAcF,IAAd;AAHH,aAAX;;AAMA,gBAAIjC,SAASzD,MAAT,KAAoB,CAAxB,EAA2B;AACvB0D,qBAAK3D,KAAL,GAAaA,MAAMiE,QAAN,EAAb;AACAjE,yBAAS,CAAT;AACAoB,wBAAQ5D,KAAR,CAAcoH,IAAd,CAAmBjB,IAAnB;AACH,aAJD,MAIO;AACH,oBAAIO,SAASR,SAAS,CAAT,CAAb;AACA,oBAAIQ,OAAO1G,KAAP,KAAiB2G,SAArB,EAAgC;AAC5BD,2BAAO1G,KAAP,GAAe,EAAf;AACH;AACDmG,qBAAK3D,KAAL,GAAakE,OAAOlE,KAAP,GAAe,GAAf,GAAqBkE,OAAO1G,KAAP,CAAayC,MAA/C;AACAiE,uBAAO1G,KAAP,CAAaoH,IAAb,CAAkBjB,IAAlB;AACH;AACJ,SAlKY;AAmKbmC,iBAAS,iBAAUH,IAAV,EAAgB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AA9KY,KAAjB;AAgLA,WAAOvE,OAAP;AACH;;AAED,SAASyE,aAAT,CAAuB9C,GAAvB,EAA2B;AACzB;AACF;;AAEE,QAAIgD,YAAY,EAAhB;AACA;AACA,QAAG7D,YAAYjC,MAAZ,IAAsB,CAAtB,IAA2B,CAACmC,QAA/B,EAAwC;AACpC,YAAI4D,WAAW,EAAf;AACAA,iBAASrC,IAAT,GAAgB,MAAhB;AACAqC,iBAASL,IAAT,GAAgB5C,GAAhB;AACAkD,gBAAQ,CAACD,QAAD,CAAR;AACA,eAAOC,KAAP;AACH;AACD;AACAlD,UAAMA,IAAIQ,OAAJ,CAAY,iBAAZ,EAA8B,MAA9B,CAAN;AACA,QAAI2C,OAAO,IAAIC,MAAJ,CAAW,KAAX,CAAX;AACA,QAAIF,QAAQlD,IAAIG,KAAJ,CAAUgD,IAAV,CAAZ;AACA,SAAI,IAAI/C,IAAI,CAAZ,EAAeA,IAAI8C,MAAMhG,MAAzB,EAAiCkD,GAAjC,EAAqC;AACnC,YAAIiD,MAAMH,MAAM9C,CAAN,CAAV;AACA,YAAI6C,WAAW,EAAf;AACA,YAAG5D,SAASgE,GAAT,CAAH,EAAiB;AACfJ,qBAASrC,IAAT,GAAgB,SAAhB;AACAqC,qBAASlC,GAAT,GAAe,OAAf;AACAkC,qBAASL,IAAT,GAAgBvD,SAASgE,GAAT,CAAhB;AACAJ,qBAASK,OAAT,GAAkBlE,eAAlB;AACD,SALD,MAKK;AACH6D,qBAASrC,IAAT,GAAgB,MAAhB;AACAqC,qBAASL,IAAT,GAAgBS,GAAhB;AACD;AACDL,kBAAUnB,IAAV,CAAeoB,QAAf;AACD;;AAED,WAAOD,SAAP;AACD;;AAED,SAASO,UAAT,GAA6D;AAAA,QAAzCC,GAAyC,uEAArC,EAAqC;AAAA,QAAlCF,OAAkC,uEAA1B,kBAA0B;AAAA,QAAPG,MAAO;;AACzDtE,kBAAcqE,GAAd;AACApE,sBAAgBkE,OAAhB;AACAjE,eAASoE,MAAT;AACH;;AAEDC,OAAOC,OAAP,GAAiB;AACbzH,eAAWA,SADE;AAEbqH,gBAAWA;AAFE,CAAjB,C;;;;;;;;;AClSA;AACA,SAASK,aAAT,CAAuB5D,GAAvB,EAA2B;AACzBA,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACA,SAAOR,GAAP;AACD;;AAED;AACA,SAAS6D,gBAAT,CAA0B7D,GAA1B,EAA8B;AAC5BA,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,GAA1B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,GAA1B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,GAA1B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;;AAEAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,GAA1B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,GAA1B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,GAA1B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,aAAZ,EAA2B,GAA3B,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACA,SAAOR,GAAP;AACD;;AAED;;AAEA,SAAS8D,mBAAT,CAA6B9D,GAA7B,EAAiC;AAC/B;AACAA,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACA;AACA;;AAEAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAqB,GAArB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;;AAEA,SAAOR,GAAP;AACD;;AAED;AACA,SAAS+D,eAAT,CAAyB/D,GAAzB,EAA6B;AAC3BA,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,EAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,EAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,EAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,EAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;;AAEAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,SAAZ,EAAuB,GAAvB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;;AAEAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,GAAtB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,WAAZ,EAAyB,GAAzB,CAAN;;AAEAR,QAAMA,IAAIQ,OAAJ,CAAY,UAAZ,EAAwB,GAAxB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,QAAZ,EAAsB,IAAtB,CAAN;AACA,SAAOR,GAAP;AACD;;AAED,SAASgE,cAAT,CAAwBhE,GAAxB,EAA4B;AAC1BA,QAAMA,IAAIQ,OAAJ,CAAY,OAAZ,EAAoB,EAApB,CAAN;AACAR,QAAMA,IAAIQ,OAAJ,CAAY,KAAZ,EAAkB,EAAlB,CAAN;;AAEA;AACA,SAAOR,GAAP;AACD;;AAED,SAASU,UAAT,CAAoBV,GAApB,EAAwB;AACtBA,QAAM4D,cAAc5D,GAAd,CAAN;AACAA,QAAM6D,iBAAiB7D,GAAjB,CAAN;AACAA,QAAM8D,oBAAoB9D,GAApB,CAAN;AACAA,QAAM+D,gBAAgB/D,GAAhB,CAAN;AACAA,QAAMgE,eAAehE,GAAf,CAAN;AACA,SAAOA,GAAP;AACD;AACD,SAASiC,YAAT,CAAsBhD,GAAtB,EAA0BgF,GAA1B,EAA8B;;AAE5B,MAAIC,QAAQ,IAAId,MAAJ,CAAW,KAAX,CAAZ;AACA,MAAIe,SAASD,MAAME,IAAN,CAAWnF,GAAX,CAAb;AACA,MAAGkF,MAAH,EAAU;AACNlF,UAAMgF,MAAI,GAAJ,GAAQhF,GAAd;AACH;AACD,SAAQA,GAAR;AACD;;AAEDyE,OAAOC,OAAP,GAAiB;AACfjD,cAAWA,UADI;AAEfuB,gBAAaA;AAFE,CAAjB,C;;;;;;;;;AC3MA;;;;;;AAMA;AACA,IAAIoC,WAAW,gHAAf;AAAA,IACCC,SAAS,4BADV;AAAA,IAEChD,OAAO,oGAFR;;AAIA;AACA,IAAI7B,QAAQC,QAAQ,oGAAR,CAAZ;;AAEA;AACA,IAAIC,QAAQD,QAAQ,oTAAR,CAAZ;;AAEA;AACA,IAAIE,SAASF,QAAQ,6LAAR,CAAb;;AAEA;AACA;AACA,IAAIG,YAAYH,QAAQ,kDAAR,CAAhB;;AAEA;AACA,IAAII,YAAYJ,QAAQ,wGAAR,CAAhB;;AAEA;AACA,IAAIK,UAAUL,QAAQ,oDAAR,CAAd;;AAEA,SAASF,UAAT,CAAoB1D,IAApB,EAA0ByI,OAA1B,EAAmC;AAClC,KAAItH,KAAJ;AAAA,KAAW0F,KAAX;AAAA,KAAkBf,KAAlB;AAAA,KAAyB4C,QAAQ,EAAjC;AAAA,KAAqCC,OAAO3I,IAA5C;AACA0I,OAAMC,IAAN,GAAa,YAAY;AACxB,SAAO,KAAK,KAAKvH,MAAL,GAAc,CAAnB,CAAP;AACA,EAFD;;AAIA,QAAOpB,IAAP,EAAa;AACZ6G,UAAQ,IAAR;;AAEA;AACA,MAAI,CAAC6B,MAAMC,IAAN,EAAD,IAAiB,CAAC1E,QAAQyE,MAAMC,IAAN,EAAR,CAAtB,EAA6C;;AAE5C;AACA,OAAI3I,KAAKiD,OAAL,CAAa,MAAb,KAAwB,CAA5B,EAA+B;AAC9B9B,YAAQnB,KAAKiD,OAAL,CAAa,KAAb,CAAR;;AAEA,QAAI9B,SAAS,CAAb,EAAgB;AACf,SAAIsH,QAAQxB,OAAZ,EACCwB,QAAQxB,OAAR,CAAgBjH,KAAK4I,SAAL,CAAe,CAAf,EAAkBzH,KAAlB,CAAhB;AACDnB,YAAOA,KAAK4I,SAAL,CAAezH,QAAQ,CAAvB,CAAP;AACA0F,aAAQ,KAAR;AACA;;AAED;AACA,IAXD,MAWO,IAAI7G,KAAKiD,OAAL,CAAa,IAAb,KAAsB,CAA1B,EAA6B;AACnC6C,YAAQ9F,KAAK8F,KAAL,CAAW0C,MAAX,CAAR;;AAEA,QAAI1C,KAAJ,EAAW;AACV9F,YAAOA,KAAK4I,SAAL,CAAe9C,MAAM,CAAN,EAAS1E,MAAxB,CAAP;AACA0E,WAAM,CAAN,EAASpB,OAAT,CAAiB8D,MAAjB,EAAyBK,WAAzB;AACAhC,aAAQ,KAAR;AACA;;AAED;AACA,IAVM,MAUA,IAAI7G,KAAKiD,OAAL,CAAa,GAAb,KAAqB,CAAzB,EAA4B;AAClC6C,YAAQ9F,KAAK8F,KAAL,CAAWyC,QAAX,CAAR;;AAEA,QAAIzC,KAAJ,EAAW;AACV9F,YAAOA,KAAK4I,SAAL,CAAe9C,MAAM,CAAN,EAAS1E,MAAxB,CAAP;AACA0E,WAAM,CAAN,EAASpB,OAAT,CAAiB6D,QAAjB,EAA2BO,aAA3B;AACAjC,aAAQ,KAAR;AACA;AACD;;AAED,OAAIA,KAAJ,EAAW;AACV1F,YAAQnB,KAAKiD,OAAL,CAAa,GAAb,CAAR;AACA,QAAI6D,OAAO,EAAX;AACA,WAAO3F,UAAU,CAAjB,EAAoB;AACU2F,aAAQ,GAAR;AACA9G,YAAOA,KAAK4I,SAAL,CAAe,CAAf,CAAP;AACAzH,aAAQnB,KAAKiD,OAAL,CAAa,GAAb,CAAR;AAC7B;AACD6D,YAAQ3F,QAAQ,CAAR,GAAYnB,IAAZ,GAAmBA,KAAK4I,SAAL,CAAe,CAAf,EAAkBzH,KAAlB,CAA3B;AACAnB,WAAOmB,QAAQ,CAAR,GAAY,EAAZ,GAAiBnB,KAAK4I,SAAL,CAAezH,KAAf,CAAxB;;AAEA,QAAIsH,QAAQ5B,KAAZ,EACC4B,QAAQ5B,KAAR,CAAcC,IAAd;AACD;AAED,GAjDD,MAiDO;;AAEN9G,UAAOA,KAAK0E,OAAL,CAAa,IAAI4C,MAAJ,CAAW,oBAAoBoB,MAAMC,IAAN,EAApB,GAAmC,QAA9C,CAAb,EAAsE,UAAUI,GAAV,EAAejC,IAAf,EAAqB;AACjGA,WAAOA,KAAKpC,OAAL,CAAa,6CAAb,EAA4D,MAA5D,CAAP;AACA,QAAI+D,QAAQ5B,KAAZ,EACC4B,QAAQ5B,KAAR,CAAcC,IAAd;;AAED,WAAO,EAAP;AACA,IANM,CAAP;;AASA+B,eAAY,EAAZ,EAAgBH,MAAMC,IAAN,EAAhB;AACA;;AAED,MAAI3I,QAAQ2I,IAAZ,EACC,MAAM,kBAAkB3I,IAAxB;AACD2I,SAAO3I,IAAP;AACA;;AAED;AACA6I;;AAEA,UAASC,aAAT,CAAuB7D,GAAvB,EAA4B+D,OAA5B,EAAqCC,IAArC,EAA2C9D,KAA3C,EAAkD;AACjD6D,YAAUA,QAAQE,WAAR,EAAV;;AAEA,MAAIrF,MAAMmF,OAAN,CAAJ,EAAoB;AACnB,UAAON,MAAMC,IAAN,MAAgB7E,OAAO4E,MAAMC,IAAN,EAAP,CAAvB,EAA6C;AAC5CE,gBAAY,EAAZ,EAAgBH,MAAMC,IAAN,EAAhB;AACA;AACD;;AAED,MAAI5E,UAAUiF,OAAV,KAAsBN,MAAMC,IAAN,MAAgBK,OAA1C,EAAmD;AAClDH,eAAY,EAAZ,EAAgBG,OAAhB;AACA;;AAED7D,UAAQxB,MAAMqF,OAAN,KAAkB,CAAC,CAAC7D,KAA5B;;AAEA,MAAI,CAACA,KAAL,EACCuD,MAAM3C,IAAN,CAAWiD,OAAX;;AAED,MAAIP,QAAQzD,KAAZ,EAAmB;AAClB,OAAIE,QAAQ,EAAZ;;AAEA+D,QAAKvE,OAAL,CAAac,IAAb,EAAmB,UAAUM,KAAV,EAAiBH,IAAjB,EAAuB;AACzC,QAAIpG,QAAQ4J,UAAU,CAAV,IAAeA,UAAU,CAAV,CAAf,GACXA,UAAU,CAAV,IAAeA,UAAU,CAAV,CAAf,GACCA,UAAU,CAAV,IAAeA,UAAU,CAAV,CAAf,GACCnF,UAAU2B,IAAV,IAAkBA,IAAlB,GAAyB,EAH5B;;AAKAT,UAAMa,IAAN,CAAW;AACVJ,WAAMA,IADI;AAEVpG,YAAOA,KAFG;AAGV6J,cAAS7J,MAAMmF,OAAN,CAAc,aAAd,EAA6B,QAA7B,CAHC,CAGsC;AAHtC,KAAX;AAKA,IAXD;;AAaA,OAAI+D,QAAQzD,KAAZ,EAAmB;AAClByD,YAAQzD,KAAR,CAAcgE,OAAd,EAAuB9D,KAAvB,EAA8BC,KAA9B;AACA;AAED;AACD;;AAED,UAAS0D,WAAT,CAAqB5D,GAArB,EAA0B+D,OAA1B,EAAmC;AAClC;AACA,MAAI,CAACA,OAAL,EACC,IAAIK,MAAM,CAAV;;AAED;AAHA,OAIK;AACJL,cAAUA,QAAQE,WAAR,EAAV;AACA,SAAK,IAAIG,MAAMX,MAAMtH,MAAN,GAAe,CAA9B,EAAiCiI,OAAO,CAAxC,EAA2CA,KAA3C;AACC,SAAIX,MAAMW,GAAN,KAAcL,OAAlB,EACC;AAFF;AAGA;AACD,MAAIK,OAAO,CAAX,EAAc;AACb;AACA,QAAK,IAAI/E,IAAIoE,MAAMtH,MAAN,GAAe,CAA5B,EAA+BkD,KAAK+E,GAApC,EAAyC/E,GAAzC;AACC,QAAImE,QAAQ/B,GAAZ,EACC+B,QAAQ/B,GAAR,CAAYgC,MAAMpE,CAAN,CAAZ;AAFF,IAFa,CAMb;AACAoE,SAAMtH,MAAN,GAAeiI,GAAf;AACA;AACD;AACD;;AAGD,SAASzF,OAAT,CAAiBM,GAAjB,EAAsB;AACrB,KAAIC,MAAM,EAAV;AAAA,KAAcC,QAAQF,IAAIG,KAAJ,CAAU,GAAV,CAAtB;AACA,MAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,MAAMhD,MAA1B,EAAkCkD,GAAlC;AACCH,MAAIC,MAAME,CAAN,CAAJ,IAAgB,IAAhB;AADD,EAEA,OAAOH,GAAP;AACA;;AAEDyD,OAAOC,OAAP,GAAiBnE,UAAjB,C;;;;;;;;;;;ACxLA;;;;AAIA,SAAS4F,cAAT,CAAwBC,MAAxB,EAAgC;AAC9B;;AAEA,MAAIC,iBAAiB;AACnBC,6BAAyB;AACvBC,oBAAc,KADS;AAEvBC,gBAAU,uDAFa;AAGvB/K,YAAM;AAHiB,KADN;AAMnBgL,gBAAY;AACVF,oBAAc,KADJ;AAEVC,gBAAU,iCAFA;AAGV/K,YAAM;AAHI,KANO;AAWnBiL,oBAAgB;AACdH,oBAAc,KADA;AAEdC,gBAAU,0CAFI;AAGd/K,YAAM;AAHQ,KAXG;AAgBnBkL,sBAAkB;AAChBJ,oBAAc,KADE;AAEhBC,gBAAU,+BAFM;AAGhB/K,YAAM;AAHU,KAhBC;AAqBnBmL,wBAAoB;AAClBL,oBAAc,KADI;AAElBC,gBAAU,qCAFQ;AAGlB/K,YAAM;AAHY,KArBD;AA0BnBoL,wBAAoB;AAClBN,oBAAc,KADI;AAElBC,gBAAU,gCAFQ;AAGlB/K,YAAM;AAHY,KA1BD;AA+BnBqL,+BAA2B;AACzBP,oBAAc,KADW;AAEzBC,gBAAU,kDAFe;AAGzB/K,YAAM;AAHmB,KA/BR;AAoCnBsL,mBAAe;AACbR,oBAAc,KADD;AAEbC,gBAAU,mCAFG;AAGb/K,YAAM;AAHO,KApCI;AAyCnBuL,YAAQ;AACNT,oBAAc,KADR;AAENC,gBAAU,4BAFJ;AAGN/K,YAAM;AAHA,KAzCW;AA8CnBwL,oBAAgB;AACdV,oBAAc,KADA;AAEdC,gBAAU,4BAFI;AAGd/K,YAAM;AAHQ,KA9CG;AAmDnByL,kBAAc;AACZX,oBAAc,IADF;AAEZC,gBAAU,4CAFE;AAGZ/K,YAAM;AAHM,KAnDK;AAwDnB0L,eAAW;AACTZ,oBAAc,KADL;AAETC,gBAAU,kCAFD;AAGT/K,YAAM;AAHG,KAxDQ;AA6DnB2L,uBAAmB;AACjBb,oBAAc,KADG;AAEjBC,gBAAU,iEAFO;AAGjB/K,YAAM;AAHW,KA7DA;AAkEnB4L,yBAAqB;AACnBd,oBAAc,KADK;AAEnBe,mBAAa,gDAFM;AAGnB7L,YAAM;AAHa;AAlEF,GAArB;AAwEA,MAAI2K,WAAW,KAAf,EAAsB;AACpB,WAAOmB,KAAKC,KAAL,CAAWD,KAAKE,SAAL,CAAepB,cAAf,CAAX,CAAP;AACD;AACD,MAAIqB,MAAM,EAAV;AACA,OAAK,IAAIC,GAAT,IAAgBtB,cAAhB,EAAgC;AAC9B,QAAIA,eAAeuB,cAAf,CAA8BD,GAA9B,CAAJ,EAAwC;AACtCD,UAAIC,GAAJ,IAAWtB,eAAesB,GAAf,EAAoBpB,YAA/B;AACD;AACF;AACD,SAAOmB,GAAP;AACD;;AAED;;;;AAIA;AACA,IAAI3L,WAAW,EAAf;AAAA,IACI8L,UAAU,EADd;AAAA,IAEIC,aAAa,EAFjB;AAAA,IAGIC,gBAAgB5B,eAAe,IAAf,CAHpB;AAAA,IAII6B,SAAS;AACPC,UAAQ;AACN3B,6BAA2B,IADrB;AAENI,oBAA2B,eAFrB;AAGNG,wBAA2B,IAHrB;AAINC,+BAA2B,IAJrB;AAKNC,mBAA2B,IALrB;AAMNC,YAA2B,IANrB;AAONC,oBAA2B,IAPrB;AAQNC,kBAA2B,IARrB;AASNC,eAA2B;AATrB,GADD;AAYPe,WAAS/B,eAAe,IAAf;AAZF,CAJb;;AAmBA;;;;AAIApK,SAASoM,MAAT,GAAkB,EAAlB;;AAEA;;;;AAIApM,SAAS+L,UAAT,GAAsB,EAAtB;;AAEA;;;;;;;AAOA/L,SAASqM,SAAT,GAAqB,UAAUhF,GAAV,EAAehH,KAAf,EAAsB;AACzC;;AACA2L,gBAAc3E,GAAd,IAAqBhH,KAArB;AACA,SAAO,IAAP;AACD,CAJD;;AAMA;;;;;;AAMAL,SAASsM,SAAT,GAAqB,UAAUjF,GAAV,EAAe;AAClC;;AACA,SAAO2E,cAAc3E,GAAd,CAAP;AACD,CAHD;;AAKA;;;;;AAKArH,SAASuM,UAAT,GAAsB,YAAY;AAChC;;AACA,SAAOP,aAAP;AACD,CAHD;;AAKA;;;;AAIAhM,SAASwM,YAAT,GAAwB,YAAY;AAClC;;AACAR,kBAAgB5B,eAAe,IAAf,CAAhB;AACD,CAHD;;AAKA;;;;AAIApK,SAASyM,SAAT,GAAqB,UAAUhG,IAAV,EAAgB;AACnC;;AACA,MAAIwF,OAAOJ,cAAP,CAAsBpF,IAAtB,CAAJ,EAAiC;AAC/B,QAAIiG,SAAST,OAAOxF,IAAP,CAAb;AACA,SAAK,IAAIkG,MAAT,IAAmBD,MAAnB,EAA2B;AACzB,UAAIA,OAAOb,cAAP,CAAsBc,MAAtB,CAAJ,EAAmC;AACjCX,sBAAcW,MAAd,IAAwBD,OAAOC,MAAP,CAAxB;AACD;AACF;AACF;AACF,CAVD;;AAYA;;;;;;AAMA3M,SAAS4M,iBAAT,GAA6B,UAAUvC,MAAV,EAAkB;AAC7C;;AACA,SAAOD,eAAeC,MAAf,CAAP;AACD,CAHD;;AAKA;;;;;;;;;;AAUArK,SAAS6M,SAAT,GAAqB,UAAUpG,IAAV,EAAgBqG,IAAhB,EAAsB;AACzC;;AACA,MAAI9M,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBtG,IAAzB,CAAJ,EAAoC;AAClC,QAAI,OAAOqG,IAAP,KAAgB,WAApB,EAAiC;AAC/BhB,cAAQrF,IAAR,IAAgBqG,IAAhB;AACD,KAFD,MAEO;AACL,UAAIhB,QAAQD,cAAR,CAAuBpF,IAAvB,CAAJ,EAAkC;AAChC,eAAOqF,QAAQrF,IAAR,CAAP;AACD,OAFD,MAEO;AACL,cAAMuG,MAAM,qBAAqBvG,IAArB,GAA4B,kBAAlC,CAAN;AACD;AACF;AACF;AACF,CAbD;;AAeA;;;;;;;AAOAzG,SAASiN,SAAT,GAAqB,UAAUxG,IAAV,EAAgByG,GAAhB,EAAqB;AACxC;;AAEA,MAAI,CAAClN,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBtG,IAAzB,CAAL,EAAqC;AACnC,UAAMuG,MAAM,qCAAN,CAAN;AACD;;AAEDvG,SAAOzG,SAASoM,MAAT,CAAgBe,UAAhB,CAA2B1G,IAA3B,CAAP;;AAEA;AACA,MAAIzG,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BF,GAA5B,CAAJ,EAAsC;AACpC,QAAI,CAACnB,WAAWF,cAAX,CAA0BpF,IAA1B,CAAL,EAAsC;AACpC,YAAMuG,MAAM,qBAAqBvG,IAArB,GAA4B,qBAAlC,CAAN;AACD;AACD,WAAOsF,WAAWtF,IAAX,CAAP;;AAEA;AACD,GAPD,MAOO;AACL;AACA,QAAI,OAAOyG,GAAP,KAAe,UAAnB,EAA+B;AAC7BA,YAAMA,KAAN;AACD;;AAED;AACA,QAAI,CAAClN,SAASoM,MAAT,CAAgB1K,OAAhB,CAAwBwL,GAAxB,CAAL,EAAmC;AACjCA,YAAM,CAACA,GAAD,CAAN;AACD;;AAED,QAAIG,iBAAiBC,SAASJ,GAAT,EAAczG,IAAd,CAArB;;AAEA,QAAI4G,eAAeE,KAAnB,EAA0B;AACxBxB,iBAAWtF,IAAX,IAAmByG,GAAnB;AACD,KAFD,MAEO;AACL,YAAMF,MAAMK,eAAe3F,KAArB,CAAN;AACD;AACF;AACF,CApCD;;AAsCA;;;;AAIA1H,SAASwN,gBAAT,GAA4B,YAAY;AACtC;;AACA,SAAOzB,UAAP;AACD,CAHD;;AAKA;;;;AAIA/L,SAASyN,eAAT,GAA2B,UAAUhH,IAAV,EAAgB;AACzC;;AACA,SAAOsF,WAAWtF,IAAX,CAAP;AACD,CAHD;;AAKA;;;AAGAzG,SAAS0N,eAAT,GAA2B,YAAY;AACrC;;AACA3B,eAAa,EAAb;AACD,CAHD;;AAKA;;;;;;AAMA,SAASuB,QAAT,CAAkBL,SAAlB,EAA6BxG,IAA7B,EAAmC;AACjC;;AAEA,MAAIkH,SAAUlH,IAAD,GAAS,cAAcA,IAAd,GAAqB,cAA9B,GAA+C,4BAA5D;AAAA,MACEkF,MAAM;AACJ4B,WAAO,IADH;AAEJ7F,WAAO;AAFH,GADR;;AAMA,MAAI,CAAC1H,SAASoM,MAAT,CAAgB1K,OAAhB,CAAwBuL,SAAxB,CAAL,EAAyC;AACvCA,gBAAY,CAACA,SAAD,CAAZ;AACD;;AAED,OAAK,IAAI7H,IAAI,CAAb,EAAgBA,IAAI6H,UAAU/K,MAA9B,EAAsC,EAAEkD,CAAxC,EAA2C;AACzC,QAAIwI,UAAUD,SAAS,iBAAT,GAA6BvI,CAA7B,GAAiC,IAA/C;AAAA,QACI8H,MAAMD,UAAU7H,CAAV,CADV;AAEA,QAAI,QAAO8H,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;AAC3BvB,UAAI4B,KAAJ,GAAY,KAAZ;AACA5B,UAAIjE,KAAJ,GAAYkG,UAAU,yBAAV,WAA6CV,GAA7C,yCAA6CA,GAA7C,KAAmD,QAA/D;AACA,aAAOvB,GAAP;AACD;;AAED,QAAI,CAAC3L,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBG,IAAIxN,IAA7B,CAAL,EAAyC;AACvCiM,UAAI4B,KAAJ,GAAY,KAAZ;AACA5B,UAAIjE,KAAJ,GAAYkG,UAAU,wCAAV,WAA4DV,IAAIxN,IAAhE,IAAuE,QAAnF;AACA,aAAOiM,GAAP;AACD;;AAED,QAAIjM,OAAOwN,IAAIxN,IAAJ,GAAWwN,IAAIxN,IAAJ,CAASsK,WAAT,EAAtB;;AAEA;AACA,QAAItK,SAAS,UAAb,EAAyB;AACvBA,aAAOwN,IAAIxN,IAAJ,GAAW,MAAlB;AACD;;AAED,QAAIA,SAAS,MAAb,EAAqB;AACnBA,aAAOwN,IAAIxN,IAAJ,GAAW,QAAlB;AACD;;AAED,QAAIA,SAAS,MAAT,IAAmBA,SAAS,QAA5B,IAAwCA,SAAS,UAArD,EAAiE;AAC/DiM,UAAI4B,KAAJ,GAAY,KAAZ;AACA5B,UAAIjE,KAAJ,GAAYkG,UAAU,OAAV,GAAoBlO,IAApB,GAA2B,gFAAvC;AACA,aAAOiM,GAAP;AACD;;AAED,QAAIjM,SAAS,UAAb,EAAyB;AACvB,UAAIM,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BF,IAAIW,SAAhC,CAAJ,EAAgD;AAC9ClC,YAAI4B,KAAJ,GAAY,KAAZ;AACA5B,YAAIjE,KAAJ,GAAYkG,UAAU,yEAAtB;AACA,eAAOjC,GAAP;AACD;AACF,KAND,MAMO;AACL,UAAI3L,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BF,IAAIY,MAAhC,KAA2C9N,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BF,IAAIa,KAAhC,CAA/C,EAAuF;AACrFpC,YAAI4B,KAAJ,GAAY,KAAZ;AACA5B,YAAIjE,KAAJ,GAAYkG,UAAUlO,IAAV,GAAiB,wEAA7B;AACA,eAAOiM,GAAP;AACD;AACF;;AAED,QAAIuB,IAAIW,SAAR,EAAmB;AACjB,UAAI,QAAOX,IAAIW,SAAX,MAAyB,QAA7B,EAAuC;AACrClC,YAAI4B,KAAJ,GAAY,KAAZ;AACA5B,YAAIjE,KAAJ,GAAYkG,UAAU,6CAAV,WAAiEV,IAAIW,SAArE,IAAiF,QAA7F;AACA,eAAOlC,GAAP;AACD;AACD,WAAK,IAAIqC,EAAT,IAAed,IAAIW,SAAnB,EAA8B;AAC5B,YAAIX,IAAIW,SAAJ,CAAchC,cAAd,CAA6BmC,EAA7B,CAAJ,EAAsC;AACpC,cAAI,OAAOd,IAAIW,SAAJ,CAAcG,EAAd,CAAP,KAA6B,UAAjC,EAA6C;AAC3CrC,gBAAI4B,KAAJ,GAAY,KAAZ;AACA5B,gBAAIjE,KAAJ,GAAYkG,UAAU,8EAAV,GAA2FI,EAA3F,GACV,0BADU,WAC0Bd,IAAIW,SAAJ,CAAcG,EAAd,CAD1B,IAC8C,QAD1D;AAEA,mBAAOrC,GAAP;AACD;AACF;AACF;AACF;;AAED,QAAIuB,IAAIY,MAAR,EAAgB;AACd,UAAI,OAAOZ,IAAIY,MAAX,KAAsB,UAA1B,EAAsC;AACpCnC,YAAI4B,KAAJ,GAAY,KAAZ;AACA5B,YAAIjE,KAAJ,GAAYkG,UAAU,mCAAV,WAAuDV,IAAIY,MAA3D,IAAoE,QAAhF;AACA,eAAOnC,GAAP;AACD;AACF,KAND,MAMO,IAAIuB,IAAIa,KAAR,EAAe;AACpB,UAAI/N,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBG,IAAIa,KAA7B,CAAJ,EAAyC;AACvCb,YAAIa,KAAJ,GAAY,IAAI3F,MAAJ,CAAW8E,IAAIa,KAAf,EAAsB,GAAtB,CAAZ;AACD;AACD,UAAI,CAACb,IAAIa,KAAL,YAAsB3F,MAA1B,EAAkC;AAChCuD,YAAI4B,KAAJ,GAAY,KAAZ;AACA5B,YAAIjE,KAAJ,GAAYkG,UAAU,mEAAV,WAAuFV,IAAIa,KAA3F,IAAmG,QAA/G;AACA,eAAOpC,GAAP;AACD;AACD,UAAI3L,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BF,IAAI1H,OAAhC,CAAJ,EAA8C;AAC5CmG,YAAI4B,KAAJ,GAAY,KAAZ;AACA5B,YAAIjE,KAAJ,GAAYkG,UAAU,gEAAtB;AACA,eAAOjC,GAAP;AACD;AACF;AACF;AACD,SAAOA,GAAP;AACD;;AAED;;;;;AAKA3L,SAASiO,iBAAT,GAA6B,UAAUf,GAAV,EAAe;AAC1C;;AAEA,MAAIe,oBAAoBX,SAASJ,GAAT,EAAc,IAAd,CAAxB;AACA,MAAI,CAACe,kBAAkBV,KAAvB,EAA8B;AAC5BhM,YAAQ2M,IAAR,CAAaD,kBAAkBvG,KAA/B;AACA,WAAO,KAAP;AACD;AACD,SAAO,IAAP;AACD,CATD;;AAWA;;;;AAIA,IAAI,CAAC1H,SAAS6L,cAAT,CAAwB,QAAxB,CAAL,EAAwC;AACtC7L,WAASoM,MAAT,GAAkB,EAAlB;AACD;;AAED;;;;;;AAMApM,SAASoM,MAAT,CAAgBW,QAAhB,GAA2B,SAASA,QAAT,CAAkBoB,CAAlB,EAAqB;AAC9C;;AACA,SAAQ,OAAOA,CAAP,KAAa,QAAb,IAAyBA,aAAa/N,MAA9C;AACD,CAHD;;AAKA;;;;;;AAMAJ,SAASoM,MAAT,CAAgBgC,UAAhB,GAA6B,SAASA,UAAT,CAAoBD,CAApB,EAAuB;AAClD;;AACA,MAAIE,UAAU,EAAd;AACA,SAAOF,KAAKE,QAAQnI,QAAR,CAAiBoI,IAAjB,CAAsBH,CAAtB,MAA6B,mBAAzC;AACD,CAJD;;AAMA;;;;;;AAMAnO,SAASoM,MAAT,CAAgBmC,OAAhB,GAA0B,SAASA,OAAT,CAAiBtJ,GAAjB,EAAsBuJ,QAAtB,EAAgC;AACxD;;AACA,MAAI,OAAOvJ,IAAIsJ,OAAX,KAAuB,UAA3B,EAAuC;AACrCtJ,QAAIsJ,OAAJ,CAAYC,QAAZ;AACD,GAFD,MAEO;AACL,SAAK,IAAIpJ,IAAI,CAAb,EAAgBA,IAAIH,IAAI/C,MAAxB,EAAgCkD,GAAhC,EAAqC;AACnCoJ,eAASvJ,IAAIG,CAAJ,CAAT,EAAiBA,CAAjB,EAAoBH,GAApB;AACD;AACF;AACF,CATD;;AAWA;;;;;;AAMAjF,SAASoM,MAAT,CAAgB1K,OAAhB,GAA0B,SAASA,OAAT,CAAiByM,CAAjB,EAAoB;AAC5C;;AACA,SAAOA,EAAEM,WAAF,KAAkBhN,KAAzB;AACD,CAHD;;AAKA;;;;;;AAMAzB,SAASoM,MAAT,CAAgBgB,WAAhB,GAA8B,SAASA,WAAT,CAAqB/M,KAArB,EAA4B;AACxD;;AACA,SAAO,OAAOA,KAAP,KAAiB,WAAxB;AACD,CAHD;;AAKA;;;;;;AAMAL,SAASoM,MAAT,CAAgBe,UAAhB,GAA6B,UAAUuB,CAAV,EAAa;AACxC;;AACA,SAAOA,EAAElJ,OAAF,CAAU,WAAV,EAAuB,EAAvB,EAA2BwE,WAA3B,EAAP;AACD,CAHD;;AAKA,SAAS2E,wBAAT,CAAkCC,UAAlC,EAA8CC,EAA9C,EAAkD;AAChD;;AACA,MAAIC,mBAAmBD,GAAGE,UAAH,CAAc,CAAd,CAAvB;AACA,SAAO,OAAOD,gBAAP,GAA0B,GAAjC;AACD;;AAED;;;;;;;AAOA9O,SAASoM,MAAT,CAAgBuC,wBAAhB,GAA2CA,wBAA3C;;AAEA;;;;;;;;AAQA3O,SAASoM,MAAT,CAAgB4C,gBAAhB,GAAmC,SAASA,gBAAT,CAA0BpH,IAA1B,EAAgCqH,aAAhC,EAA+CC,cAA/C,EAA+D;AAChG;AACA;AACA;;AACA,MAAIC,cAAc,OAAOF,cAAczJ,OAAd,CAAsB,aAAtB,EAAqC,MAArC,CAAP,GAAsD,IAAxE;;AAEA,MAAI0J,cAAJ,EAAoB;AAClBC,kBAAc,SAASA,WAAvB;AACD;;AAED,MAAIpB,QAAQ,IAAI3F,MAAJ,CAAW+G,WAAX,EAAwB,GAAxB,CAAZ;AACAvH,SAAOA,KAAKpC,OAAL,CAAauI,KAAb,EAAoBY,wBAApB,CAAP;;AAEA,SAAO/G,IAAP;AACD,CAdD;;AAgBA,IAAIwH,kBAAkB,SAAlBA,eAAkB,CAAUpK,GAAV,EAAeqK,IAAf,EAAqBC,KAArB,EAA4BC,KAA5B,EAAmC;AACvD;;AACA,MAAIC,IAAID,SAAS,EAAjB;AAAA,MACEE,IAAID,EAAEzL,OAAF,CAAU,GAAV,IAAiB,CAAC,CADxB;AAAA,MAEE2L,IAAI,IAAItH,MAAJ,CAAWiH,OAAO,GAAP,GAAaC,KAAxB,EAA+B,MAAME,EAAEhK,OAAF,CAAU,IAAV,EAAgB,EAAhB,CAArC,CAFN;AAAA,MAGEmK,IAAI,IAAIvH,MAAJ,CAAWiH,IAAX,EAAiBG,EAAEhK,OAAF,CAAU,IAAV,EAAgB,EAAhB,CAAjB,CAHN;AAAA,MAIE2E,MAAM,EAJR;AAAA,MAKEyF,CALF;AAAA,MAKKlB,CALL;AAAA,MAKQmB,CALR;AAAA,MAKW/J,KALX;AAAA,MAKkB0B,GALlB;;AAOA,KAAG;AACDoI,QAAI,CAAJ;AACA,WAAQC,IAAIH,EAAEI,IAAF,CAAO9K,GAAP,CAAZ,EAA0B;AACxB,UAAI2K,EAAEvG,IAAF,CAAOyG,EAAE,CAAF,CAAP,CAAJ,EAAkB;AAChB,YAAI,CAAED,GAAN,EAAY;AACVlB,cAAIgB,EAAEK,SAAN;AACAjK,kBAAQ4I,IAAImB,EAAE,CAAF,EAAK3N,MAAjB;AACD;AACF,OALD,MAKO,IAAI0N,CAAJ,EAAO;AACZ,YAAI,CAAC,GAAEA,CAAP,EAAU;AACRpI,gBAAMqI,EAAE5N,KAAF,GAAU4N,EAAE,CAAF,EAAK3N,MAArB;AACA,cAAI+C,MAAM;AACRoK,kBAAM,EAACvJ,OAAOA,KAAR,EAAe0B,KAAKkH,CAApB,EADE;AAER9H,mBAAO,EAACd,OAAO4I,CAAR,EAAWlH,KAAKqI,EAAE5N,KAAlB,EAFC;AAGRqN,mBAAO,EAACxJ,OAAO+J,EAAE5N,KAAV,EAAiBuF,KAAKA,GAAtB,EAHC;AAIRoH,wBAAY,EAAC9I,OAAOA,KAAR,EAAe0B,KAAKA,GAApB;AAJJ,WAAV;AAMA2C,cAAItD,IAAJ,CAAS5B,GAAT;AACA,cAAI,CAACwK,CAAL,EAAQ;AACN,mBAAOtF,GAAP;AACD;AACF;AACF;AACF;AACF,GAxBD,QAwBSyF,MAAMF,EAAEK,SAAF,GAAcrB,CAApB,CAxBT;;AA0BA,SAAOvE,GAAP;AACD,CApCD;;AAsCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BAnK,SAASoM,MAAT,CAAgB4D,oBAAhB,GAAuC,UAAUhL,GAAV,EAAeqK,IAAf,EAAqBC,KAArB,EAA4BC,KAA5B,EAAmC;AACxE;;AAEA,MAAIU,WAAWb,gBAAiBpK,GAAjB,EAAsBqK,IAAtB,EAA4BC,KAA5B,EAAmCC,KAAnC,CAAf;AAAA,MACElM,UAAU,EADZ;;AAGA,OAAK,IAAI+B,IAAI,CAAb,EAAgBA,IAAI6K,SAAS/N,MAA7B,EAAqC,EAAEkD,CAAvC,EAA0C;AACxC/B,YAAQwD,IAAR,CAAa,CACX7B,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYwJ,UAAZ,CAAuB9I,KAAjC,EAAwCmK,SAAS7K,CAAT,EAAYwJ,UAAZ,CAAuBpH,GAA/D,CADW,EAEXxC,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYwB,KAAZ,CAAkBd,KAA5B,EAAmCmK,SAAS7K,CAAT,EAAYwB,KAAZ,CAAkBY,GAArD,CAFW,EAGXxC,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYiK,IAAZ,CAAiBvJ,KAA3B,EAAkCmK,SAAS7K,CAAT,EAAYiK,IAAZ,CAAiB7H,GAAnD,CAHW,EAIXxC,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYkK,KAAZ,CAAkBxJ,KAA5B,EAAmCmK,SAAS7K,CAAT,EAAYkK,KAAZ,CAAkB9H,GAArD,CAJW,CAAb;AAMD;AACD,SAAOnE,OAAP;AACD,CAfD;;AAiBA;;;;;;;;;AASArD,SAASoM,MAAT,CAAgB+D,sBAAhB,GAAyC,UAAUnL,GAAV,EAAeoL,WAAf,EAA4Bf,IAA5B,EAAkCC,KAAlC,EAAyCC,KAAzC,EAAgD;AACvF;;AAEA,MAAI,CAACvP,SAASoM,MAAT,CAAgBgC,UAAhB,CAA2BgC,WAA3B,CAAL,EAA8C;AAC5C,QAAIC,SAASD,WAAb;AACAA,kBAAc,uBAAY;AACxB,aAAOC,MAAP;AACD,KAFD;AAGD;;AAED,MAAIJ,WAAWb,gBAAgBpK,GAAhB,EAAqBqK,IAArB,EAA2BC,KAA3B,EAAkCC,KAAlC,CAAf;AAAA,MACIe,WAAWtL,GADf;AAAA,MAEIuL,MAAMN,SAAS/N,MAFnB;;AAIA,MAAIqO,MAAM,CAAV,EAAa;AACX,QAAIC,OAAO,EAAX;AACA,QAAIP,SAAS,CAAT,EAAYrB,UAAZ,CAAuB9I,KAAvB,KAAiC,CAArC,EAAwC;AACtC0K,WAAK3J,IAAL,CAAU7B,IAAIkL,KAAJ,CAAU,CAAV,EAAaD,SAAS,CAAT,EAAYrB,UAAZ,CAAuB9I,KAApC,CAAV;AACD;AACD,SAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAImL,GAApB,EAAyB,EAAEnL,CAA3B,EAA8B;AAC5BoL,WAAK3J,IAAL,CACEuJ,YACEpL,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYwJ,UAAZ,CAAuB9I,KAAjC,EAAwCmK,SAAS7K,CAAT,EAAYwJ,UAAZ,CAAuBpH,GAA/D,CADF,EAEExC,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYwB,KAAZ,CAAkBd,KAA5B,EAAmCmK,SAAS7K,CAAT,EAAYwB,KAAZ,CAAkBY,GAArD,CAFF,EAGExC,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYiK,IAAZ,CAAiBvJ,KAA3B,EAAkCmK,SAAS7K,CAAT,EAAYiK,IAAZ,CAAiB7H,GAAnD,CAHF,EAIExC,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYkK,KAAZ,CAAkBxJ,KAA5B,EAAmCmK,SAAS7K,CAAT,EAAYkK,KAAZ,CAAkB9H,GAArD,CAJF,CADF;AAQA,UAAIpC,IAAImL,MAAM,CAAd,EAAiB;AACfC,aAAK3J,IAAL,CAAU7B,IAAIkL,KAAJ,CAAUD,SAAS7K,CAAT,EAAYwJ,UAAZ,CAAuBpH,GAAjC,EAAsCyI,SAAS7K,IAAI,CAAb,EAAgBwJ,UAAhB,CAA2B9I,KAAjE,CAAV;AACD;AACF;AACD,QAAImK,SAASM,MAAM,CAAf,EAAkB3B,UAAlB,CAA6BpH,GAA7B,GAAmCxC,IAAI9C,MAA3C,EAAmD;AACjDsO,WAAK3J,IAAL,CAAU7B,IAAIkL,KAAJ,CAAUD,SAASM,MAAM,CAAf,EAAkB3B,UAAlB,CAA6BpH,GAAvC,CAAV;AACD;AACD8I,eAAWE,KAAKC,IAAL,CAAU,EAAV,CAAX;AACD;AACD,SAAOH,QAAP;AACD,CAtCD;;AAwCA;;;AAGA,IAAItQ,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4B7L,OAA5B,CAAJ,EAA0C;AACxCA,YAAU;AACR2M,UAAM,cAAUwC,GAAV,EAAe;AACnB;;AACAC,YAAMD,GAAN;AACD,KAJO;AAKRlP,SAAK,aAAUkP,GAAV,EAAe;AAClB;;AACAC,YAAMD,GAAN;AACD,KARO;AASRhJ,WAAO,eAAUgJ,GAAV,EAAe;AACpB;;AACA,YAAMA,GAAN;AACD;AAZO,GAAV;AAcD;;AAED;;;;AAIA;;;;;;AAMA1Q,SAASC,SAAT,GAAqB,UAAU2Q,gBAAV,EAA4B;AAC/C;;AAEA;AACI;;;;;AAKAC,YAAU,EANd;;;AAQI;;;;;AAKAC,mBAAiB,EAbrB;;;AAeI;;;;;AAKAC,oBAAkB,EApBtB;;;AAsBI;;;;;AAKAlD,cAAY,EA3BhB;;AA6BAmD;;AAEA;;;;AAIA,WAASA,YAAT,GAAwB;AACtBJ,uBAAmBA,oBAAoB,EAAvC;;AAEA,SAAK,IAAIK,IAAT,IAAiBjF,aAAjB,EAAgC;AAC9B,UAAIA,cAAcH,cAAd,CAA6BoF,IAA7B,CAAJ,EAAwC;AACtCJ,gBAAQI,IAAR,IAAgBjF,cAAciF,IAAd,CAAhB;AACD;AACF;;AAED;AACA,QAAI,QAAOL,gBAAP,yCAAOA,gBAAP,OAA4B,QAAhC,EAA0C;AACxC,WAAK,IAAIhF,GAAT,IAAgBgF,gBAAhB,EAAkC;AAChC,YAAIA,iBAAiB/E,cAAjB,CAAgCD,GAAhC,CAAJ,EAA0C;AACxCiF,kBAAQjF,GAAR,IAAegF,iBAAiBhF,GAAjB,CAAf;AACD;AACF;AACF,KAND,MAMO;AACL,YAAMoB,MAAM,yEAAwE4D,gBAAxE,yCAAwEA,gBAAxE,KACZ,sBADM,CAAN;AAED;;AAED,QAAIC,QAAQ9E,UAAZ,EAAwB;AACtB/L,eAASoM,MAAT,CAAgBmC,OAAhB,CAAwBsC,QAAQ9E,UAAhC,EAA4CmF,eAA5C;AACD;AACF;;AAED;;;;;;AAMA,WAASA,eAAT,CAAyBhE,GAAzB,EAA8BzG,IAA9B,EAAoC;;AAElCA,WAAOA,QAAQ,IAAf;AACA;AACA,QAAIzG,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBG,GAAzB,CAAJ,EAAmC;AACjCA,YAAMlN,SAASoM,MAAT,CAAgBe,UAAhB,CAA2BD,GAA3B,CAAN;AACAzG,aAAOyG,GAAP;;AAEA;AACA,UAAIlN,SAAS+L,UAAT,CAAoBmB,GAApB,CAAJ,EAA8B;AAC5B3L,gBAAQ2M,IAAR,CAAa,0BAA0BhB,GAA1B,GAAgC,6DAAhC,GACX,mEADF;AAEAiE,+BAAuBnR,SAAS+L,UAAT,CAAoBmB,GAApB,CAAvB,EAAiDA,GAAjD;AACA;AACF;AAEC,OAPD,MAOO,IAAI,CAAClN,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BrB,WAAWmB,GAAX,CAA5B,CAAL,EAAmD;AACxDA,cAAMnB,WAAWmB,GAAX,CAAN;AAED,OAHM,MAGA;AACL,cAAMF,MAAM,gBAAgBE,GAAhB,GAAsB,6EAA5B,CAAN;AACD;AACF;;AAED,QAAI,OAAOA,GAAP,KAAe,UAAnB,EAA+B;AAC7BA,YAAMA,KAAN;AACD;;AAED,QAAI,CAAClN,SAASoM,MAAT,CAAgB1K,OAAhB,CAAwBwL,GAAxB,CAAL,EAAmC;AACjCA,YAAM,CAACA,GAAD,CAAN;AACD;;AAED,QAAIkE,WAAW9D,SAASJ,GAAT,EAAczG,IAAd,CAAf;AACA,QAAI,CAAC2K,SAAS7D,KAAd,EAAqB;AACnB,YAAMP,MAAMoE,SAAS1J,KAAf,CAAN;AACD;;AAED,SAAK,IAAItC,IAAI,CAAb,EAAgBA,IAAI8H,IAAIhL,MAAxB,EAAgC,EAAEkD,CAAlC,EAAqC;AACnC,cAAQ8H,IAAI9H,CAAJ,EAAO1F,IAAf;;AAEE,aAAK,MAAL;AACEoR,yBAAejK,IAAf,CAAoBqG,IAAI9H,CAAJ,CAApB;AACA;;AAEF,aAAK,QAAL;AACE2L,0BAAgBlK,IAAhB,CAAqBqG,IAAI9H,CAAJ,CAArB;AACA;AARJ;AAUA,UAAI8H,IAAI9H,CAAJ,EAAOyG,cAAP,CAAsBgC,SAAtB,CAAJ,EAAsC;AACpC,aAAK,IAAIG,EAAT,IAAed,IAAI9H,CAAJ,EAAOyI,SAAtB,EAAiC;AAC/B,cAAIX,IAAI9H,CAAJ,EAAOyI,SAAP,CAAiBhC,cAAjB,CAAgCmC,EAAhC,CAAJ,EAAyC;AACvCqD,mBAAOrD,EAAP,EAAWd,IAAI9H,CAAJ,EAAOyI,SAAP,CAAiBG,EAAjB,CAAX;AACD;AACF;AACF;AACF;AAEF;;AAED;;;;;AAKA,WAASmD,sBAAT,CAAgCjE,GAAhC,EAAqCzG,IAArC,EAA2C;AACzC,QAAI,OAAOyG,GAAP,KAAe,UAAnB,EAA+B;AAC7BA,YAAMA,IAAI,IAAIlN,SAASC,SAAb,EAAJ,CAAN;AACD;AACD,QAAI,CAACD,SAASoM,MAAT,CAAgB1K,OAAhB,CAAwBwL,GAAxB,CAAL,EAAmC;AACjCA,YAAM,CAACA,GAAD,CAAN;AACD;AACD,QAAIK,QAAQD,SAASJ,GAAT,EAAczG,IAAd,CAAZ;;AAEA,QAAI,CAAC8G,MAAMA,KAAX,EAAkB;AAChB,YAAMP,MAAMO,MAAM7F,KAAZ,CAAN;AACD;;AAED,SAAK,IAAItC,IAAI,CAAb,EAAgBA,IAAI8H,IAAIhL,MAAxB,EAAgC,EAAEkD,CAAlC,EAAqC;AACnC,cAAQ8H,IAAI9H,CAAJ,EAAO1F,IAAf;AACE,aAAK,MAAL;AACEoR,yBAAejK,IAAf,CAAoBqG,IAAI9H,CAAJ,CAApB;AACA;AACF,aAAK,QAAL;AACE2L,0BAAgBlK,IAAhB,CAAqBqG,IAAI9H,CAAJ,CAArB;AACA;AACF;AAAQ;AACN,gBAAM4H,MAAM,8CAAN,CAAN;AARJ;AAUD;AACF;;AAED;;;;;AAKA,WAASqE,MAAT,CAAgB5K,IAAhB,EAAsB+H,QAAtB,EAAgC;AAC9B,QAAI,CAACxO,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBtG,IAAzB,CAAL,EAAqC;AACnC,YAAMuG,MAAM,uFAAsFvG,IAAtF,yCAAsFA,IAAtF,KAA6F,QAAnG,CAAN;AACD;;AAED,QAAI,OAAO+H,QAAP,KAAoB,UAAxB,EAAoC;AAClC,YAAMxB,MAAM,6FAA4FwB,QAA5F,yCAA4FA,QAA5F,KAAuG,QAA7G,CAAN;AACD;;AAED,QAAI,CAACX,UAAUhC,cAAV,CAAyBpF,IAAzB,CAAL,EAAqC;AACnCoH,gBAAUpH,IAAV,IAAkB,EAAlB;AACD;AACDoH,cAAUpH,IAAV,EAAgBI,IAAhB,CAAqB2H,QAArB;AACD;;AAED,WAAS8C,cAAT,CAAwB1J,IAAxB,EAA8B;AAC5B,QAAI2J,MAAM3J,KAAKhB,KAAL,CAAW,MAAX,EAAmB,CAAnB,EAAsB1E,MAAhC;AAAA,QACIsP,MAAM,IAAIpJ,MAAJ,CAAW,YAAYmJ,GAAZ,GAAkB,GAA7B,EAAkC,IAAlC,CADV;AAEA,WAAO3J,KAAKpC,OAAL,CAAagM,GAAb,EAAkB,EAAlB,CAAP;AACD;;AAED;;;;;;;;;AASA,OAAKC,SAAL,GAAiB,SAASC,QAAT,CAAmBC,OAAnB,EAA4B/J,IAA5B,EAAkCiJ,OAAlC,EAA2Ce,OAA3C,EAAoD;AACnE,QAAI/D,UAAUhC,cAAV,CAAyB8F,OAAzB,CAAJ,EAAuC;AACrC,WAAK,IAAIE,KAAK,CAAd,EAAiBA,KAAKhE,UAAU8D,OAAV,EAAmBzP,MAAzC,EAAiD,EAAE2P,EAAnD,EAAuD;AACrD,YAAIC,QAAQjE,UAAU8D,OAAV,EAAmBE,EAAnB,EAAuBF,OAAvB,EAAgC/J,IAAhC,EAAsC,IAAtC,EAA4CiJ,OAA5C,EAAqDe,OAArD,CAAZ;AACA,YAAIE,SAAS,OAAOA,KAAP,KAAiB,WAA9B,EAA2C;AACzClK,iBAAOkK,KAAP;AACD;AACF;AACF;AACD,WAAOlK,IAAP;AACD,GAVD;;AAYA;;;;;;AAMA,OAAKyJ,MAAL,GAAc,UAAU5K,IAAV,EAAgB+H,QAAhB,EAA0B;AACtC6C,WAAO5K,IAAP,EAAa+H,QAAb;AACA,WAAO,IAAP;AACD,GAHD;;AAKA;;;;;AAKA,OAAKrO,QAAL,GAAgB,UAAUyH,IAAV,EAAgB;AAC9B;AACA,QAAI,CAACA,IAAL,EAAW;AACT,aAAOA,IAAP;AACD;;AAED,QAAIgK,UAAU;AACZG,mBAAiB,EADL;AAEZC,qBAAiB,EAFL;AAGZC,kBAAiB,EAHL;AAIZC,aAAiB,EAJL;AAKZC,eAAiB,EALL;AAMZC,mBAAiB,EANL;AAOZC,kBAAiB,CAPL;AAQZC,sBAAiB,EARL;AASZxB,sBAAiBA,cATL;AAUZC,uBAAiBA,eAVL;AAWZhR,iBAAiB,IAXL;AAYZoL,oBAAiB;AAZL,KAAd;;AAeA;AACA;AACA;AACA;AACAvD,WAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,IAAnB,CAAP;;AAEA;AACA;AACA;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,IAApB,CAAP;;AAEA;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,OAAb,EAAsB,IAAtB,CAAP,CAjC8B,CAiCM;AACpCoC,WAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,IAApB,CAAP,CAlC8B,CAkCI;;AAElC,QAAIqL,QAAQvF,mBAAZ,EAAiC;AAC/B1D,aAAO0J,eAAe1J,IAAf,CAAP;AACD;;AAED;AACA;AACAA,WAAOA,IAAP;AACA;AACAA,WAAO5H,SAAS6M,SAAT,CAAmB,OAAnB,EAA4BjF,IAA5B,EAAkCiJ,OAAlC,EAA2Ce,OAA3C,CAAP;;AAEA;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,iBAAnB,EAAsCjF,IAAtC,EAA4CiJ,OAA5C,EAAqDe,OAArD,CAAP;;AAEA;AACA5R,aAASoM,MAAT,CAAgBmC,OAAhB,CAAwBuC,cAAxB,EAAwC,UAAU5D,GAAV,EAAe;AACrDtF,aAAO5H,SAAS6M,SAAT,CAAmB,cAAnB,EAAmCK,GAAnC,EAAwCtF,IAAxC,EAA8CiJ,OAA9C,EAAuDe,OAAvD,CAAP;AACD,KAFD;;AAIA;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,iBAAnB,EAAsCjF,IAAtC,EAA4CiJ,OAA5C,EAAqDe,OAArD,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,kBAAnB,EAAuCjF,IAAvC,EAA6CiJ,OAA7C,EAAsDe,OAAtD,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,gBAAnB,EAAqCjF,IAArC,EAA2CiJ,OAA3C,EAAoDe,OAApD,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,eAAnB,EAAoCjF,IAApC,EAA0CiJ,OAA1C,EAAmDe,OAAnD,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,sBAAnB,EAA2CjF,IAA3C,EAAiDiJ,OAAjD,EAA0De,OAA1D,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCjF,IAAjC,EAAuCiJ,OAAvC,EAAgDe,OAAhD,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,iBAAnB,EAAsCjF,IAAtC,EAA4CiJ,OAA5C,EAAqDe,OAArD,CAAP;AACAhK,WAAO5H,SAAS6M,SAAT,CAAmB,sBAAnB,EAA2CjF,IAA3C,EAAiDiJ,OAAjD,EAA0De,OAA1D,CAAP;;AAEA;AACAhK,WAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,IAApB,CAAP;;AAEA;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,GAApB,CAAP;;AAEA;AACAxF,aAASoM,MAAT,CAAgBmC,OAAhB,CAAwBwC,eAAxB,EAAyC,UAAU7D,GAAV,EAAe;AACtDtF,aAAO5H,SAAS6M,SAAT,CAAmB,cAAnB,EAAmCK,GAAnC,EAAwCtF,IAAxC,EAA8CiJ,OAA9C,EAAuDe,OAAvD,CAAP;AACD,KAFD;AAGA,WAAOhK,IAAP;AACD,GA3ED;;AA6EA;;;;;AAKA,OAAKyE,SAAL,GAAiB,UAAUhF,GAAV,EAAehH,KAAf,EAAsB;AACrCwQ,YAAQxJ,GAAR,IAAehH,KAAf;AACD,GAFD;;AAIA;;;;;AAKA,OAAKiM,SAAL,GAAiB,UAAUjF,GAAV,EAAe;AAC9B,WAAOwJ,QAAQxJ,GAAR,CAAP;AACD,GAFD;;AAIA;;;;AAIA,OAAKkF,UAAL,GAAkB,YAAY;AAC5B,WAAOsE,OAAP;AACD,GAFD;;AAIA;;;;;AAKA,OAAK0B,YAAL,GAAoB,UAAUtF,SAAV,EAAqBxG,IAArB,EAA2B;AAC7CA,WAAOA,QAAQ,IAAf;AACAyK,oBAAgBjE,SAAhB,EAA2BxG,IAA3B;AACD,GAHD;;AAKA;;;;AAIA,OAAK+L,YAAL,GAAoB,UAAUC,aAAV,EAAyB;AAC3CvB,oBAAgBuB,aAAhB;AACD,GAFD;;AAIA;;;;AAIA,OAAKhG,SAAL,GAAiB,UAAUhG,IAAV,EAAgB;AAC/B,QAAIwF,OAAOJ,cAAP,CAAsBpF,IAAtB,CAAJ,EAAiC;AAC/B,UAAIiG,SAAST,OAAOxF,IAAP,CAAb;AACA,WAAK,IAAIkG,MAAT,IAAmBD,MAAnB,EAA2B;AACzB,YAAIA,OAAOb,cAAP,CAAsBc,MAAtB,CAAJ,EAAmC;AACjCkE,kBAAQlE,MAAR,IAAkBD,OAAOC,MAAP,CAAlB;AACD;AACF;AACF;AACF,GATD;;AAWA;;;;;;AAMA,OAAKc,eAAL,GAAuB,UAAUR,SAAV,EAAqB;AAC1C,QAAI,CAACjN,SAASoM,MAAT,CAAgB1K,OAAhB,CAAwBuL,SAAxB,CAAL,EAAyC;AACvCA,kBAAY,CAACA,SAAD,CAAZ;AACD;AACD,SAAK,IAAIkB,IAAI,CAAb,EAAgBA,IAAIlB,UAAU/K,MAA9B,EAAsC,EAAEiM,CAAxC,EAA2C;AACzC,UAAIjB,MAAMD,UAAUkB,CAAV,CAAV;AACA,WAAK,IAAI/I,IAAI,CAAb,EAAgBA,IAAI0L,eAAe5O,MAAnC,EAA2C,EAAEkD,CAA7C,EAAgD;AAC9C,YAAI0L,eAAe1L,CAAf,MAAsB8H,GAA1B,EAA+B;AAC7B4D,yBAAe1L,CAAf,EAAkB4B,MAAlB,CAAyB5B,CAAzB,EAA4B,CAA5B;AACD;AACF;AACD,WAAK,IAAIsN,KAAK,CAAd,EAAiBA,KAAK3B,gBAAgB7O,MAAtC,EAA8C,EAAEkD,CAAhD,EAAmD;AACjD,YAAI2L,gBAAgB2B,EAAhB,MAAwBxF,GAA5B,EAAiC;AAC/B6D,0BAAgB2B,EAAhB,EAAoB1L,MAApB,CAA2B5B,CAA3B,EAA8B,CAA9B;AACD;AACF;AACF;AACF,GAjBD;;AAmBA;;;;AAIA,OAAKoI,gBAAL,GAAwB,YAAY;AAClC,WAAO;AACL3N,gBAAUiR,cADL;AAEL6B,cAAQ5B;AAFH,KAAP;AAID,GALD;AAMD,CA3YD;;AA6YA;;;AAGA/Q,SAAS6M,SAAT,CAAmB,SAAnB,EAA8B,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAC9D;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,gBAA5B,EAA8C7J,IAA9C,EAAoDiJ,OAApD,EAA6De,OAA7D,CAAP;;AAEA,MAAIgB,iBAAiB,SAAjBA,cAAiB,CAAUhE,UAAV,EAAsBC,EAAtB,EAA0BgE,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0CC,EAA1C,EAA8CC,EAA9C,EAAkD;AACrE,QAAIlT,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4B8F,EAA5B,CAAJ,EAAqC;AACnCA,WAAK,EAAL;AACD;AACDtE,iBAAaC,EAAb;AACA,QAAIsE,WAAWN,EAAf;AAAA,QACIO,SAASN,GAAG9I,WAAH,EADb;AAAA,QAEI/F,MAAM8O,EAFV;AAAA,QAGIM,QAAQH,EAHZ;;AAKA,QAAI,CAACjP,GAAL,EAAU;AACR,UAAI,CAACmP,MAAL,EAAa;AACX;AACAA,iBAASD,SAASnJ,WAAT,GAAuBxE,OAAvB,CAA+B,OAA/B,EAAwC,GAAxC,CAAT;AACD;AACDvB,YAAM,MAAMmP,MAAZ;;AAEA,UAAI,CAACpT,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BwE,QAAQM,KAAR,CAAckB,MAAd,CAA5B,CAAL,EAAyD;AACvDnP,cAAM2N,QAAQM,KAAR,CAAckB,MAAd,CAAN;AACA,YAAI,CAACpT,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BwE,QAAQO,OAAR,CAAgBiB,MAAhB,CAA5B,CAAL,EAA2D;AACzDC,kBAAQzB,QAAQO,OAAR,CAAgBiB,MAAhB,CAAR;AACD;AACF,OALD,MAKO;AACL,YAAIxE,WAAW0E,MAAX,CAAkB,WAAlB,IAAiC,CAAC,CAAtC,EAAyC;AACvC;AACArP,gBAAM,EAAN;AACD,SAHD,MAGO;AACL,iBAAO2K,UAAP;AACD;AACF;AACF;;AAED3K,UAAMjE,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiC/K,GAAjC,EAAsC,IAAtC,EAA4C,KAA5C,CAAN;AACA,QAAIkF,SAAS,cAAclF,GAAd,GAAoB,GAAjC;;AAEA,QAAIoP,UAAU,EAAV,IAAgBA,UAAU,IAA9B,EAAoC;AAClCA,cAAQA,MAAM7N,OAAN,CAAc,IAAd,EAAoB,QAApB,CAAR;AACA6N,cAAQrT,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiCqE,KAAjC,EAAwC,IAAxC,EAA8C,KAA9C,CAAR;AACAlK,gBAAU,aAAakK,KAAb,GAAqB,GAA/B;AACD;;AAEDlK,cAAU,MAAMgK,QAAN,GAAiB,MAA3B;;AAEA,WAAOhK,MAAP;AACD,GA5CD;;AA8CA;AACA;;;;;;;;;;;;;;;;;;;;AAsBAvB,SAAOA,KAAKpC,OAAL,CAAa,+DAAb,EAA8EoN,cAA9E,CAAP;;AAEA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BAhL,SAAOA,KAAKpC,OAAL,CAAa,gGAAb,EACaoN,cADb,CAAP;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;AASAhL,SAAOA,KAAKpC,OAAL,CAAa,4BAAb,EAA2CoN,cAA3C,CAAP;;AAEAhL,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,eAA5B,EAA6C7J,IAA7C,EAAmDiJ,OAAnD,EAA4De,OAA5D,CAAP;AACA,SAAOhK,IAAP;AACD,CAjID;;AAmIA5H,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAChE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,kBAA5B,EAAgD7J,IAAhD,EAAsDiJ,OAAtD,EAA+De,OAA/D,CAAP;;AAEA,MAAI2B,iBAAkB,2EAAtB;AAAA,MACIC,gBAAkB,+CADtB;AAAA,MAEIC,kBAAkB,oGAFtB;AAAA,MAGIC,iBAAkB,6DAHtB;;AAKA9L,SAAOA,KAAKpC,OAAL,CAAagO,aAAb,EAA4BG,WAA5B,CAAP;AACA/L,SAAOA,KAAKpC,OAAL,CAAakO,cAAb,EAA6BE,WAA7B,CAAP;AACA;AACA;;AAEA,MAAI/C,QAAQ/F,kBAAZ,EAAgC;AAC9BlD,WAAOA,KAAKpC,OAAL,CAAa+N,cAAb,EAA6BI,WAA7B,CAAP;AACA/L,WAAOA,KAAKpC,OAAL,CAAaiO,eAAb,EAA8BG,WAA9B,CAAP;AACD;;AAED,WAASD,WAAT,CAAqBE,EAArB,EAAyBC,IAAzB,EAA+B;AAC7B,QAAIC,SAASD,IAAb;AACA,QAAI,UAAU1K,IAAV,CAAe0K,IAAf,CAAJ,EAA0B;AACxBA,aAAOA,KAAKtO,OAAL,CAAa,SAAb,EAAwB,aAAxB,CAAP;AACD;AACD,WAAO,cAAcsO,IAAd,GAAqB,IAArB,GAA4BC,MAA5B,GAAqC,MAA5C;AACD;;AAED,WAASH,WAAT,CAAqBhF,UAArB,EAAiCC,EAAjC,EAAqC;AACnC,QAAImF,eAAehU,SAAS6M,SAAT,CAAmB,sBAAnB,EAA2CgC,EAA3C,CAAnB;AACA,WAAO7O,SAAS6M,SAAT,CAAmB,oBAAnB,EAAyCmH,YAAzC,CAAP;AACD;;AAEDpM,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,iBAA5B,EAA+C7J,IAA/C,EAAqDiJ,OAArD,EAA8De,OAA9D,CAAP;;AAEA,SAAOhK,IAAP;AACD,CApCD;;AAsCA;;;;AAIA5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACjE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,mBAA5B,EAAiD7J,IAAjD,EAAuDiJ,OAAvD,EAAgEe,OAAhE,CAAP;;AAEA;AACA;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,aAAnB,EAAkCjF,IAAlC,EAAwCiJ,OAAxC,EAAiDe,OAAjD,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,SAAnB,EAA8BjF,IAA9B,EAAoCiJ,OAApC,EAA6Ce,OAA7C,CAAP;;AAEA;AACA,MAAIvK,MAAMrH,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC,QAAhC,EAA0CgE,OAA1C,EAAmDe,OAAnD,CAAV;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,oCAAb,EAAmD6B,GAAnD,CAAP;AACAO,SAAOA,KAAKpC,OAAL,CAAa,oCAAb,EAAmD6B,GAAnD,CAAP;AACAO,SAAOA,KAAKpC,OAAL,CAAa,mCAAb,EAAkD6B,GAAlD,CAAP;;AAEAO,SAAO5H,SAAS6M,SAAT,CAAmB,OAAnB,EAA4BjF,IAA5B,EAAkCiJ,OAAlC,EAA2Ce,OAA3C,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCjF,IAAjC,EAAuCiJ,OAAvC,EAAgDe,OAAhD,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,QAAnB,EAA6BjF,IAA7B,EAAmCiJ,OAAnC,EAA4Ce,OAA5C,CAAP;;AAEA;AACA;AACA;AACA;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,gBAAnB,EAAqCjF,IAArC,EAA2CiJ,OAA3C,EAAoDe,OAApD,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCjF,IAAjC,EAAuCiJ,OAAvC,EAAgDe,OAAhD,CAAP;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,kBAA5B,EAAgD7J,IAAhD,EAAsDiJ,OAAtD,EAA+De,OAA/D,CAAP;;AAEA,SAAOhK,IAAP;AACD,CA9BD;;AAgCA5H,SAAS6M,SAAT,CAAmB,aAAnB,EAAkC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAClE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,oBAA5B,EAAkD7J,IAAlD,EAAwDiJ,OAAxD,EAAiEe,OAAjE,CAAP;AACA;;;;;;;;;;;;;AAaAhK,SAAOA,KAAKpC,OAAL,CAAa,yCAAb,EAAwD,UAAUoJ,UAAV,EAAsBC,EAAtB,EAA0B;AACvF,QAAIoF,KAAKpF,EAAT;;AAEA;AACA;AACAoF,SAAKA,GAAGzO,OAAH,CAAW,kBAAX,EAA+B,IAA/B,CAAL,CALuF,CAK5C;;AAE3C;AACAyO,SAAKA,GAAGzO,OAAH,CAAW,KAAX,EAAkB,EAAlB,CAAL;;AAEAyO,SAAKA,GAAGzO,OAAH,CAAW,YAAX,EAAyB,EAAzB,CAAL,CAVuF,CAUpD;AACnCyO,SAAKjU,SAAS6M,SAAT,CAAmB,kBAAnB,EAAuCoH,EAAvC,EAA2CpD,OAA3C,EAAoDe,OAApD,CAAL;AACAqC,SAAKjU,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCoH,EAAjC,EAAqCpD,OAArC,EAA8Ce,OAA9C,CAAL,CAZuF,CAY1B;;AAE7DqC,SAAKA,GAAGzO,OAAH,CAAW,SAAX,EAAsB,MAAtB,CAAL;AACA;AACAyO,SAAKA,GAAGzO,OAAH,CAAW,4BAAX,EAAyC,UAAUoJ,UAAV,EAAsBC,EAAtB,EAA0B;AACtE,UAAIrI,MAAMqI,EAAV;AACA;AACArI,YAAMA,IAAIhB,OAAJ,CAAY,OAAZ,EAAqB,IAArB,CAAN;AACAgB,YAAMA,IAAIhB,OAAJ,CAAY,KAAZ,EAAmB,EAAnB,CAAN;AACA,aAAOgB,GAAP;AACD,KANI,CAAL;;AAQA,WAAOxG,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC,mBAAmBoH,EAAnB,GAAwB,iBAAxD,EAA2EpD,OAA3E,EAAoFe,OAApF,CAAP;AACD,GAzBM,CAAP;;AA2BAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,mBAA5B,EAAiD7J,IAAjD,EAAuDiJ,OAAvD,EAAgEe,OAAhE,CAAP;AACA,SAAOhK,IAAP;AACD,CA9CD;;AAgDA;;;AAGA5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACjE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,mBAA5B,EAAiD7J,IAAjD,EAAuDiJ,OAAvD,EAAgEe,OAAhE,CAAP;AACA;;;;;;;;;;;;;AAaA;AACAhK,UAAQ,IAAR;;AAEA,MAAIsM,UAAU,kEAAd;AACAtM,SAAOA,KAAKpC,OAAL,CAAa0O,OAAb,EAAsB,UAAUtF,UAAV,EAAsBC,EAAtB,EAA0BgE,EAA1B,EAA8B;AACzD,QAAIsB,YAAYtF,EAAhB;AAAA,QACIuF,WAAWvB,EADf;AAAA,QAEIrL,MAAM,IAFV;;AAIA2M,gBAAYnU,SAAS6M,SAAT,CAAmB,SAAnB,EAA8BsH,SAA9B,CAAZ;AACAA,gBAAYnU,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCsH,SAAjC,CAAZ;AACAA,gBAAYnU,SAAS6M,SAAT,CAAmB,OAAnB,EAA4BsH,SAA5B,CAAZ;AACAA,gBAAYA,UAAU3O,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,CAAZ,CARyD,CAQb;AAC5C2O,gBAAYA,UAAU3O,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,CAAZ,CATyD,CASb;;AAE5C,QAAIqL,QAAQtG,uBAAZ,EAAqC;AACnC/C,YAAM,EAAN;AACD;;AAED2M,gBAAY,gBAAgBA,SAAhB,GAA4B3M,GAA5B,GAAkC,eAA9C;;AAEA,WAAOxH,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCsH,SAAhC,EAA2CtD,OAA3C,EAAoDe,OAApD,IAA+DwC,QAAtE;AACD,GAlBM,CAAP;;AAoBA;AACAxM,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,EAAnB,CAAP;;AAEAoC,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,kBAA5B,EAAgD7J,IAAhD,EAAsDiJ,OAAtD,EAA+De,OAA/D,CAAP;AACA,SAAOhK,IAAP;AACD,CA9CD;;AAgDA;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA5H,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAChE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,kBAA5B,EAAgD7J,IAAhD,EAAsDiJ,OAAtD,EAA+De,OAA/D,CAAP;;AAEA;;;;;;;;;;;;;AAaA,MAAI,OAAOhK,IAAP,KAAiB,WAArB,EAAkC;AAChCA,WAAO,EAAP;AACD;AACDA,SAAOA,KAAKpC,OAAL,CAAa,qCAAb,EACL,UAAUoJ,UAAV,EAAsBC,EAAtB,EAA0BgE,EAA1B,EAA8BC,EAA9B,EAAkC;AAChC,QAAIuB,IAAIvB,EAAR;AACAuB,QAAIA,EAAE7O,OAAF,CAAU,YAAV,EAAwB,EAAxB,CAAJ,CAFgC,CAEC;AACjC6O,QAAIA,EAAE7O,OAAF,CAAU,UAAV,EAAsB,EAAtB,CAAJ,CAHgC,CAGD;AAC/B6O,QAAIrU,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCwH,CAAjC,CAAJ;AACA,WAAOxF,KAAK,QAAL,GAAgBwF,CAAhB,GAAoB,SAA3B;AACD,GAPI,CAAP;;AAUAzM,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,iBAA5B,EAA+C7J,IAA/C,EAAqDiJ,OAArD,EAA8De,OAA9D,CAAP;AACA,SAAOhK,IAAP;AACD,CAjCD;;AAmCA;;;AAGA5H,SAAS6M,SAAT,CAAmB,OAAnB,EAA4B,UAAUjF,IAAV,EAAgB;AAC1C;;AAEA;;AACAA,SAAOA,KAAKpC,OAAL,CAAa,WAAb,EAA0B,MAA1B,CAAP,CAJ0C,CAIA;;AAE1C;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,MAApB,CAAP;;AAEA;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,YAAb,EAA2B,UAAUoJ,UAAV,EAAsBC,EAAtB,EAA0B;AAC1D,QAAIyF,cAAczF,EAAlB;AAAA,QACI0F,YAAY,IAAID,YAAYpS,MAAZ,GAAqB,CADzC,CAD0D,CAEb;;AAE7C;AACA,SAAK,IAAIkD,IAAI,CAAb,EAAgBA,IAAImP,SAApB,EAA+BnP,GAA/B,EAAoC;AAClCkP,qBAAe,GAAf;AACD;;AAED,WAAOA,WAAP;AACD,GAVM,CAAP;;AAYA;AACA1M,SAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,MAApB,CAAP,CAvB0C,CAuBL;AACrCoC,SAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,EAApB,CAAP;;AAEA,SAAOoC,IAAP;AAED,CA5BD;;AA8BA;;;AAGA5H,SAAS6M,SAAT,CAAmB,qBAAnB,EAA0C,UAAUjF,IAAV,EAAgB;AACxD;AACA;AACA;;AACAA,SAAOA,KAAKpC,OAAL,CAAa,oCAAb,EAAmD,OAAnD,CAAP;;AAEA;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,oBAAb,EAAmC,MAAnC,CAAP;;AAEA,SAAOoC,IAAP;AACD,CAVD;;AAYA;;;;;;;;;;;AAWA5H,SAAS6M,SAAT,CAAmB,wBAAnB,EAA6C,UAAUjF,IAAV,EAAgB;AAC3D;;AACAA,SAAOA,KAAKpC,OAAL,CAAa,SAAb,EAAwBxF,SAASoM,MAAT,CAAgBuC,wBAAxC,CAAP;AACA/G,SAAOA,KAAKpC,OAAL,CAAa,0BAAb,EAAyCxF,SAASoM,MAAT,CAAgBuC,wBAAzD,CAAP;AACA,SAAO/G,IAAP;AACD,CALD;;AAOA;;;;;AAKA5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiC,UAAUjF,IAAV,EAAgB;AAC/C;;AAEA;AACA;;AACAA,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,OAAnB,CAAP;;AAEA;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,MAAnB,CAAP;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,MAAnB,CAAP;;AAEA;AACAoC,SAAO5H,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiCpH,IAAjC,EAAuC,UAAvC,EAAmD,KAAnD,CAAP;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAOA,IAAP;AACD,CAtBD;;AAwBA;;;;;;;;;;;;;;;AAeA5H,SAAS6M,SAAT,CAAmB,oBAAnB,EAAyC,UAAU2H,IAAV,EAAgB;AACvD;;AAEA,MAAIC,SAAS,CACX,UAAUC,EAAV,EAAc;AACZ,WAAO,OAAOA,GAAG3F,UAAH,CAAc,CAAd,CAAP,GAA0B,GAAjC;AACD,GAHU,EAIX,UAAU2F,EAAV,EAAc;AACZ,WAAO,QAAQA,GAAG3F,UAAH,CAAc,CAAd,EAAiB7I,QAAjB,CAA0B,EAA1B,CAAR,GAAwC,GAA/C;AACD,GANU,EAOX,UAAUwO,EAAV,EAAc;AACZ,WAAOA,EAAP;AACD,GATU,CAAb;;AAYAF,SAAO,YAAYA,IAAnB;;AAEAA,SAAOA,KAAKhP,OAAL,CAAa,IAAb,EAAmB,UAAUkP,EAAV,EAAc;AACtC,QAAIA,OAAO,GAAX,EAAgB;AACd;AACAA,WAAKD,OAAOE,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,CAA3B,CAAP,EAAsCH,EAAtC,CAAL;AACD,KAHD,MAGO,IAAIA,OAAO,GAAX,EAAgB;AACrB;AACA,UAAII,IAAIH,KAAKE,MAAL,EAAR;AACA;AACAH,WACEI,IAAI,GAAJ,GAAUL,OAAO,CAAP,EAAUC,EAAV,CAAV,GAA0BI,IAAI,IAAJ,GAAWL,OAAO,CAAP,EAAUC,EAAV,CAAX,GAA2BD,OAAO,CAAP,EAAUC,EAAV,CADvD;AAGD;AACD,WAAOA,EAAP;AACD,GAbM,CAAP;;AAeAF,SAAO,cAAcA,IAAd,GAAqB,IAArB,GAA4BA,IAA5B,GAAmC,MAA1C;AACAA,SAAOA,KAAKhP,OAAL,CAAa,QAAb,EAAuB,IAAvB,CAAP,CAjCuD,CAiClB;;AAErC,SAAOgP,IAAP;AACD,CApCD;;AAsCA;;;;AAIAxU,SAAS6M,SAAT,CAAmB,uCAAnB,EAA4D,UAAUjF,IAAV,EAAgB;AAC1E;;AAEA;AACA;;AACA,MAAImG,QAAQ,2DAAZ;;AAEAnG,SAAOA,KAAKpC,OAAL,CAAauI,KAAb,EAAoB,UAAUa,UAAV,EAAsB;AAC/C,QAAI7I,MAAM6I,WAAWpJ,OAAX,CAAmB,oBAAnB,EAAyC,KAAzC,CAAV;AACAO,UAAM/F,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiCjJ,GAAjC,EAAsC,OAAtC,EAA+C,KAA/C,CAAN;AACA,WAAOA,GAAP;AACD,GAJM,CAAP;;AAMA,SAAO6B,IAAP;AACD,CAdD;;AAgBA;;;;;;;;;;AAUA5H,SAAS6M,SAAT,CAAmB,kBAAnB,EAAuC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACvE;;AAEA;;AACA,MAAI,CAACf,QAAQ1F,YAAb,EAA2B;AACzB,WAAOvD,IAAP;AACD;;AAEDA,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,yBAA5B,EAAuD7J,IAAvD,EAA6DiJ,OAA7D,EAAsEe,OAAtE,CAAP;;AAEAhK,UAAQ,IAAR;;AAEAA,SAAOA,KAAKpC,OAAL,CAAa,mCAAb,EAAkD,UAAUoJ,UAAV,EAAsB/O,QAAtB,EAAgCsU,SAAhC,EAA2C;AAClG,QAAI3M,MAAOqJ,QAAQtG,uBAAT,GAAoC,EAApC,GAAyC,IAAnD;;AAEA;AACA4J,gBAAYnU,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCsH,SAAjC,CAAZ;AACAA,gBAAYnU,SAAS6M,SAAT,CAAmB,OAAnB,EAA4BsH,SAA5B,CAAZ;AACAA,gBAAYA,UAAU3O,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,CAAZ,CANkG,CAMtD;AAC5C2O,gBAAYA,UAAU3O,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,CAAZ,CAPkG,CAOtD;;AAE5C2O,gBAAY,gBAAgBtU,WAAW,aAAaA,QAAb,GAAwB,YAAxB,GAAuCA,QAAvC,GAAkD,GAA7D,GAAmE,EAAnF,IAAyF,GAAzF,GAA+FsU,SAA/F,GAA2G3M,GAA3G,GAAiH,eAA7H;;AAEA2M,gBAAYnU,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCsH,SAAhC,EAA2CtD,OAA3C,EAAoDe,OAApD,CAAZ;;AAEA;AACA;AACA;AACA,WAAO,YAAYA,QAAQzG,YAAR,CAAqBtE,IAArB,CAA0B,EAACe,MAAMgH,UAAP,EAAmBuF,WAAWA,SAA9B,EAA1B,IAAsE,CAAlF,IAAuF,OAA9F;AACD,GAjBM,CAAP;;AAmBA;AACAvM,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,EAAnB,CAAP;;AAEA,SAAOoM,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,wBAA5B,EAAsD7J,IAAtD,EAA4DiJ,OAA5D,EAAqEe,OAArE,CAAP;AACD,CAnCD;;AAqCA5R,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAChE;;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,cAAb,EAA6B,EAA7B,CAAP;AACA,SAAO,YAAYoM,QAAQG,WAAR,CAAoBlL,IAApB,CAAyBe,IAAzB,IAAiC,CAA7C,IAAkD,OAAzD;AACD,CAJD;;AAMA5H,SAAS6M,SAAT,CAAmB,aAAnB,EAAkC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAClE;;AAEA,SAAO,UAAUhD,UAAV,EAAsBC,EAAtB,EAA0B;AAC/B,QAAIkG,YAAYlG,EAAhB;;AAEA;AACAkG,gBAAYA,UAAUvP,OAAV,CAAkB,OAAlB,EAA2B,IAA3B,CAAZ;AACAuP,gBAAYA,UAAUvP,OAAV,CAAkB,KAAlB,EAAyB,EAAzB,CAAZ;;AAEA;AACAuP,gBAAYA,UAAUvP,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,CAAZ;;AAEA;AACAuP,gBAAY,YAAYnD,QAAQG,WAAR,CAAoBlL,IAApB,CAAyBkO,SAAzB,IAAsC,CAAlD,IAAuD,OAAnE;;AAEA,WAAOA,SAAP;AACD,GAdD;AAeD,CAlBD;;AAoBA/U,SAAS6M,SAAT,CAAmB,gBAAnB,EAAqC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACrE;;AAEA,MAAIoD,YAAY,CACZ,KADY,EAEZ,KAFY,EAGZ,IAHY,EAIZ,IAJY,EAKZ,IALY,EAMZ,IANY,EAOZ,IAPY,EAQZ,IARY,EASZ,YATY,EAUZ,OAVY,EAWZ,IAXY,EAYZ,IAZY,EAaZ,IAbY,EAcZ,QAdY,EAeZ,UAfY,EAgBZ,MAhBY,EAiBZ,UAjBY,EAkBZ,QAlBY,EAmBZ,MAnBY,EAoBZ,OApBY,EAqBZ,SArBY,EAsBZ,QAtBY,EAuBZ,QAvBY,EAwBZ,KAxBY,EAyBZ,SAzBY,EA0BZ,OA1BY,EA2BZ,SA3BY,EA4BZ,OA5BY,EA6BZ,QA7BY,EA8BZ,QA9BY,EA+BZ,QA/BY,EAgCZ,QAhCY,EAiCZ,OAjCY,EAkCZ,GAlCY,CAAhB;AAAA,MAoCEC,UAAU,SAAVA,OAAU,CAAUrG,UAAV,EAAsBhI,KAAtB,EAA6ByI,IAA7B,EAAmCC,KAAnC,EAA0C;AAClD,QAAI4F,MAAMtG,UAAV;AACA;AACA;AACA,QAAIS,KAAKiE,MAAL,CAAY,cAAZ,MAAgC,CAAC,CAArC,EAAwC;AACtC4B,YAAM7F,OAAOuC,QAAQ7R,SAAR,CAAkBI,QAAlB,CAA2ByG,KAA3B,CAAP,GAA2C0I,KAAjD;AACD;AACD,WAAO,YAAYsC,QAAQG,WAAR,CAAoBlL,IAApB,CAAyBqO,GAAzB,IAAgC,CAA5C,IAAiD,OAAxD;AACD,GA5CH;;AA8CA,OAAK,IAAI9P,IAAI,CAAb,EAAgBA,IAAI4P,UAAU9S,MAA9B,EAAsC,EAAEkD,CAAxC,EAA2C;AACzCwC,WAAO5H,SAASoM,MAAT,CAAgB+D,sBAAhB,CAAuCvI,IAAvC,EAA6CqN,OAA7C,EAAsD,qBAAqBD,UAAU5P,CAAV,CAArB,GAAoC,WAA1F,EAAuG,OAAO4P,UAAU5P,CAAV,CAAP,GAAsB,GAA7H,EAAkI,KAAlI,CAAP;AACD;;AAED;AACAwC,SAAOA,KAAKpC,OAAL,CAAa,qDAAb,EACLxF,SAAS6M,SAAT,CAAmB,aAAnB,EAAkCjF,IAAlC,EAAwCiJ,OAAxC,EAAiDe,OAAjD,CADK,CAAP;;AAGA;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,oBAAb,EACLxF,SAAS6M,SAAT,CAAmB,aAAnB,EAAkCjF,IAAlC,EAAwCiJ,OAAxC,EAAiDe,OAAjD,CADK,CAAP;;AAGA;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,0DAAb,EACLxF,SAAS6M,SAAT,CAAmB,aAAnB,EAAkCjF,IAAlC,EAAwCiJ,OAAxC,EAAiDe,OAAjD,CADK,CAAP;AAEA,SAAOhK,IAAP;AACD,CAjED;;AAmEA;;;AAGA5H,SAAS6M,SAAT,CAAmB,eAAnB,EAAoC,UAAUjF,IAAV,EAAgBuN,MAAhB,EAAwBvD,OAAxB,EAAiC;AACnE;;AAEA,MAAIwD,UAAUpV,SAASoM,MAAT,CAAgB4D,oBAAhB,CAAqCpI,IAArC,EAA2C,gBAA3C,EAA6D,SAA7D,EAAwE,IAAxE,CAAd;;AAEA,OAAK,IAAIxC,IAAI,CAAb,EAAgBA,IAAIgQ,QAAQlT,MAA5B,EAAoC,EAAEkD,CAAtC,EAAyC;AACvCwC,WAAOA,KAAKpC,OAAL,CAAa4P,QAAQhQ,CAAR,EAAW,CAAX,CAAb,EAA4B,QAAQwM,QAAQK,UAAR,CAAmBpL,IAAnB,CAAwBuO,QAAQhQ,CAAR,EAAW,CAAX,CAAxB,IAAyC,CAAjD,IAAsD,GAAlF,CAAP;AACD;AACD,SAAOwC,IAAP;AACD,CATD;;AAWA;;;AAGA5H,SAAS6M,SAAT,CAAmB,iBAAnB,EAAsC,UAAUjF,IAAV,EAAgBuN,MAAhB,EAAwBvD,OAAxB,EAAiC;AACrE;;AAEA,OAAK,IAAIxM,IAAI,CAAb,EAAgBA,IAAIwM,QAAQK,UAAR,CAAmB/P,MAAvC,EAA+C,EAAEkD,CAAjD,EAAoD;AAClDwC,WAAOA,KAAKpC,OAAL,CAAa,OAAOJ,CAAP,GAAW,GAAxB,EAA6BwM,QAAQK,UAAR,CAAmB7M,CAAnB,CAA7B,CAAP;AACD;;AAED,SAAOwC,IAAP;AACD,CARD;;AAUA;;;AAGA5H,SAAS6M,SAAT,CAAmB,iBAAnB,EAAsC,UAAUjF,IAAV,EAAgBuN,MAAhB,EAAwBvD,OAAxB,EAAiC;AACrE;;AAEA,MAAIqD,UAAU,SAAVA,OAAU,CAAUrG,UAAV,EAAsBhI,KAAtB,EAA6ByI,IAA7B,EAAmCC,KAAnC,EAA0C;AACtD;AACA,QAAI6E,YAAY9E,OAAOrP,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCjG,KAAjC,CAAP,GAAiD0I,KAAjE;AACA,WAAO,YAAYsC,QAAQzG,YAAR,CAAqBtE,IAArB,CAA0B,EAACe,MAAMgH,UAAP,EAAmBuF,WAAWA,SAA9B,EAA1B,IAAsE,CAAlF,IAAuF,OAA9F;AACD,GAJD;;AAMAvM,SAAO5H,SAASoM,MAAT,CAAgB+D,sBAAhB,CAAuCvI,IAAvC,EAA6CqN,OAA7C,EAAsD,gDAAtD,EAAwG,kCAAxG,EAA4I,KAA5I,CAAP;AACA,SAAOrN,IAAP;AACD,CAXD;;AAaA5H,SAAS6M,SAAT,CAAmB,SAAnB,EAA8B,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAC9D;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,gBAA5B,EAA8C7J,IAA9C,EAAoDiJ,OAApD,EAA6De,OAA7D,CAAP;;AAEA,MAAIyD,eAAexE,QAAQlG,cAA3B;AAAA,MACIC,mBAAoB0K,MAAMC,SAAS1E,QAAQjG,gBAAjB,CAAN,CAAD,GAA8C,CAA9C,GAAkD2K,SAAS1E,QAAQjG,gBAAjB,CADzE;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACI4K,kBAAiB3E,QAAQxF,iBAAT,GAA8B,+BAA9B,GAAgE,4BAVpF;AAAA,MAWIoK,gBAAiB5E,QAAQxF,iBAAT,GAA8B,+BAA9B,GAAgE,4BAXpF;;AAaAzD,SAAOA,KAAKpC,OAAL,CAAagQ,aAAb,EAA4B,UAAU5G,UAAV,EAAsBC,EAAtB,EAA0B;;AAE3D,QAAI6G,YAAY1V,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCgC,EAAhC,EAAoCgC,OAApC,EAA6Ce,OAA7C,CAAhB;AAAA,QACI+D,MAAO9E,QAAQnG,UAAT,GAAuB,EAAvB,GAA4B,UAAUkL,SAAS/G,EAAT,CAAV,GAAyB,GAD/D;AAAA,QAEIgH,SAASjL,gBAFb;AAAA,QAGIkL,YAAY,OAAOD,MAAP,GAAgBF,GAAhB,GAAsB,GAAtB,GAA4BD,SAA5B,GAAwC,KAAxC,GAAgDG,MAAhD,GAAyD,GAHzE;AAIA,WAAO7V,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCiJ,SAAhC,EAA2CjF,OAA3C,EAAoDe,OAApD,CAAP;AACD,GAPM,CAAP;;AASAhK,SAAOA,KAAKpC,OAAL,CAAaiQ,aAAb,EAA4B,UAAUM,UAAV,EAAsBlH,EAAtB,EAA0B;AAC3D,QAAI6G,YAAY1V,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCgC,EAAhC,EAAoCgC,OAApC,EAA6Ce,OAA7C,CAAhB;AAAA,QACI+D,MAAO9E,QAAQnG,UAAT,GAAuB,EAAvB,GAA4B,UAAUkL,SAAS/G,EAAT,CAAV,GAAyB,GAD/D;AAAA,QAEIgH,SAASjL,mBAAmB,CAFhC;AAAA,QAGEkL,YAAY,OAAOD,MAAP,GAAgBF,GAAhB,GAAsB,GAAtB,GAA4BD,SAA5B,GAAwC,KAAxC,GAAgDG,MAAhD,GAAyD,GAHvE;AAIA,WAAO7V,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCiJ,SAAhC,EAA2CjF,OAA3C,EAAoDe,OAApD,CAAP;AACD,GANM,CAAP;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,mCAAb,EAAkD,UAAUoJ,UAAV,EAAsBC,EAAtB,EAA0BgE,EAA1B,EAA8B;AACrF,QAAImD,OAAOhW,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCgG,EAAhC,EAAoChC,OAApC,EAA6Ce,OAA7C,CAAX;AAAA,QACI+D,MAAO9E,QAAQnG,UAAT,GAAuB,EAAvB,GAA4B,UAAUkL,SAAS/C,EAAT,CAAV,GAAyB,GAD/D;AAAA,QAEIgD,SAASjL,mBAAmB,CAAnB,GAAuBiE,GAAG3M,MAFvC;AAAA,QAGI+T,SAAS,OAAOJ,MAAP,GAAgBF,GAAhB,GAAsB,GAAtB,GAA4BK,IAA5B,GAAmC,KAAnC,GAA2CH,MAA3C,GAAoD,GAHjE;;AAKA,WAAO7V,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCoJ,MAAhC,EAAwCpF,OAAxC,EAAiDe,OAAjD,CAAP;AACD,GAPM,CAAP;;AASA,WAASgE,QAAT,CAAkB/F,CAAlB,EAAqB;AACnB,QAAIwD,KAAJ;AAAA,QAAW6C,YAAYrG,EAAErK,OAAF,CAAU,QAAV,EAAoB,EAApB,EAAwBwE,WAAxB,EAAvB;;AAEA,QAAI4H,QAAQU,cAAR,CAAuB4D,SAAvB,CAAJ,EAAuC;AACrC7C,cAAQ6C,YAAY,GAAZ,GAAmBtE,QAAQU,cAAR,CAAuB4D,SAAvB,GAA3B;AACD,KAFD,MAEO;AACL7C,cAAQ6C,SAAR;AACAtE,cAAQU,cAAR,CAAuB4D,SAAvB,IAAoC,CAApC;AACD;;AAED;AACA,QAAIb,iBAAiB,IAArB,EAA2B;AACzBA,qBAAe,SAAf;AACD;;AAED,QAAIrV,SAASoM,MAAT,CAAgBW,QAAhB,CAAyBsI,YAAzB,CAAJ,EAA4C;AAC1C,aAAOA,eAAehC,KAAtB;AACD;AACD,WAAOA,KAAP;AACD;;AAEDzL,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,eAA5B,EAA6C7J,IAA7C,EAAmDiJ,OAAnD,EAA4De,OAA5D,CAAP;AACA,SAAOhK,IAAP;AACD,CA1ED;;AA4EA;;;AAGA5H,SAAS6M,SAAT,CAAmB,QAAnB,EAA6B,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAC7D;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,eAA5B,EAA6C7J,IAA7C,EAAmDiJ,OAAnD,EAA4De,OAA5D,CAAP;;AAEA,MAAIuE,eAAkB,uHAAtB;AAAA,MACIC,kBAAkB,6CADtB;;AAGA,WAASC,aAAT,CAAwBzH,UAAxB,EAAoC0H,OAApC,EAA6ClD,MAA7C,EAAqDnP,GAArD,EAA0D7B,KAA1D,EAAiEC,MAAjE,EAAyE2Q,EAAzE,EAA6EK,KAA7E,EAAoF;;AAElF,QAAInB,QAAUN,QAAQM,KAAtB;AAAA,QACIC,UAAUP,QAAQO,OADtB;AAAA,QAEIoE,QAAU3E,QAAQQ,WAFtB;;AAIAgB,aAASA,OAAOpJ,WAAP,EAAT;;AAEA,QAAI,CAACqJ,KAAL,EAAY;AACVA,cAAQ,EAAR;AACD;;AAED,QAAIpP,QAAQ,EAAR,IAAcA,QAAQ,IAA1B,EAAgC;AAC9B,UAAImP,WAAW,EAAX,IAAiBA,WAAW,IAAhC,EAAsC;AACpC;AACAA,iBAASkD,QAAQtM,WAAR,GAAsBxE,OAAtB,CAA8B,OAA9B,EAAuC,GAAvC,CAAT;AACD;AACDvB,YAAM,MAAMmP,MAAZ;;AAEA,UAAI,CAACpT,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4B8E,MAAMkB,MAAN,CAA5B,CAAL,EAAiD;AAC/CnP,cAAMiO,MAAMkB,MAAN,CAAN;AACA,YAAI,CAACpT,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4B+E,QAAQiB,MAAR,CAA5B,CAAL,EAAmD;AACjDC,kBAAQlB,QAAQiB,MAAR,CAAR;AACD;AACD,YAAI,CAACpT,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BmJ,MAAMnD,MAAN,CAA5B,CAAL,EAAiD;AAC/ChR,kBAAQmU,MAAMnD,MAAN,EAAchR,KAAtB;AACAC,mBAASkU,MAAMnD,MAAN,EAAc/Q,MAAvB;AACD;AACF,OATD,MASO;AACL,eAAOuM,UAAP;AACD;AACF;;AAED0H,cAAUA,QAAQ9Q,OAAR,CAAgB,IAAhB,EAAsB,QAAtB,CAAV;AACA8Q,cAAUtW,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiCsH,OAAjC,EAA0C,IAA1C,EAAgD,KAAhD,CAAV;AACArS,UAAMjE,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiC/K,GAAjC,EAAsC,IAAtC,EAA4C,KAA5C,CAAN;AACA,QAAIkF,SAAS,eAAelF,GAAf,GAAqB,SAArB,GAAiCqS,OAAjC,GAA2C,GAAxD;;AAEA,QAAIjD,KAAJ,EAAW;AACTA,cAAQA,MAAM7N,OAAN,CAAc,IAAd,EAAoB,QAApB,CAAR;AACA6N,cAAQrT,SAASoM,MAAT,CAAgB4C,gBAAhB,CAAiCqE,KAAjC,EAAwC,IAAxC,EAA8C,KAA9C,CAAR;AACAlK,gBAAU,aAAakK,KAAb,GAAqB,GAA/B;AACD;;AAED,QAAIjR,SAASC,MAAb,EAAqB;AACnBD,cAAUA,UAAU,GAAX,GAAkB,MAAlB,GAA2BA,KAApC;AACAC,eAAUA,WAAW,GAAZ,GAAmB,MAAnB,GAA4BA,MAArC;;AAEA8G,gBAAU,aAAa/G,KAAb,GAAqB,GAA/B;AACA+G,gBAAU,cAAc9G,MAAd,GAAuB,GAAjC;AACD;;AAED8G,cAAU,KAAV;AACA,WAAOA,MAAP;AACD;;AAED;AACAvB,SAAOA,KAAKpC,OAAL,CAAa4Q,eAAb,EAA8BC,aAA9B,CAAP;;AAEA;AACAzO,SAAOA,KAAKpC,OAAL,CAAa2Q,YAAb,EAA2BE,aAA3B,CAAP;;AAEAzO,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,cAA5B,EAA4C7J,IAA5C,EAAkDiJ,OAAlD,EAA2De,OAA3D,CAAP;AACA,SAAOhK,IAAP;AACD,CAxED;;AA0EA5H,SAAS6M,SAAT,CAAmB,gBAAnB,EAAqC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACrE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,uBAA5B,EAAqD7J,IAArD,EAA2DiJ,OAA3D,EAAoEe,OAApE,CAAP;;AAEA,MAAIf,QAAQ9F,yBAAZ,EAAuC;AACrC;AACA;AACAnD,WAAOA,KAAKpC,OAAL,CAAa,gDAAb,EAA+D,uBAA/D,CAAP;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,8CAAb,EAA6D,eAA7D,CAAP;AACA;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,gCAAb,EAA+C,qBAA/C,CAAP;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,0BAAb,EAAyC,aAAzC,CAAP;AAED,GATD,MASO;AACL;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,oCAAb,EAAmD,qBAAnD,CAAP;AACAoC,WAAOA,KAAKpC,OAAL,CAAa,4BAAb,EAA2C,aAA3C,CAAP;AACD;;AAEDoC,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,sBAA5B,EAAoD7J,IAApD,EAA0DiJ,OAA1D,EAAmEe,OAAnE,CAAP;AACA,SAAOhK,IAAP;AACD,CAtBD;;AAwBA;;;AAGA5H,SAAS6M,SAAT,CAAmB,OAAnB,EAA4B,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAC5D;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,cAA5B,EAA4C7J,IAA5C,EAAkDiJ,OAAlD,EAA2De,OAA3D,CAAP;AACA;;;;;;;AAOA,WAAS4E,gBAAT,CAA2BC,OAA3B,EAAoCC,YAApC,EAAkD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA9E,YAAQS,UAAR;;AAEA;AACAoE,cAAUA,QAAQjR,OAAR,CAAgB,SAAhB,EAA2B,IAA3B,CAAV;;AAEA;AACAiR,eAAW,IAAX;;AAEA,QAAIjF,MAAM,8GAAV;AAAA,QACImF,gBAAiB,mBAAmBvN,IAAnB,CAAwBqN,OAAxB,CADrB;;AAGAA,cAAUA,QAAQjR,OAAR,CAAgBgM,GAAhB,EAAqB,UAAU5C,UAAV,EAAsBC,EAAtB,EAA0BgE,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsC6D,OAAtC,EAA+CC,OAA/C,EAAwD;AACrFA,gBAAWA,WAAWA,QAAQC,IAAR,OAAmB,EAAzC;AACA,UAAIC,OAAO/W,SAAS6M,SAAT,CAAmB,SAAnB,EAA8BkG,EAA9B,EAAkClC,OAAlC,EAA2Ce,OAA3C,CAAX;AAAA,UACIoF,cAAc,EADlB;;AAGA;AACA,UAAIJ,WAAW/F,QAAQzF,SAAvB,EAAkC;AAChC4L,sBAAc,wDAAd;AACAD,eAAOA,KAAKvR,OAAL,CAAa,qBAAb,EAAoC,YAAY;AACrD,cAAIyR,MAAM,mGAAV;AACA,cAAIJ,OAAJ,EAAa;AACXI,mBAAO,UAAP;AACD;AACDA,iBAAO,GAAP;AACA,iBAAOA,GAAP;AACD,SAPM,CAAP;AAQD;AACD;AACA;AACA;AACA,UAAIpI,MAAOkI,KAAKzD,MAAL,CAAY,QAAZ,IAAwB,CAAC,CAApC,EAAwC;AACtCyD,eAAO/W,SAAS6M,SAAT,CAAmB,kBAAnB,EAAuCkK,IAAvC,EAA6ClG,OAA7C,EAAsDe,OAAtD,CAAP;AACAmF,eAAO/W,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCkK,IAAjC,EAAuClG,OAAvC,EAAgDe,OAAhD,CAAP;AACD,OAHD,MAGO;AACL;AACAmF,eAAO/W,SAAS6M,SAAT,CAAmB,OAAnB,EAA4BkK,IAA5B,EAAkClG,OAAlC,EAA2Ce,OAA3C,CAAP;AACAmF,eAAOA,KAAKvR,OAAL,CAAa,KAAb,EAAoB,EAApB,CAAP,CAHK,CAG2B;AAChC,YAAImR,aAAJ,EAAmB;AACjBI,iBAAO/W,SAAS6M,SAAT,CAAmB,YAAnB,EAAiCkK,IAAjC,EAAuClG,OAAvC,EAAgDe,OAAhD,CAAP;AACD,SAFD,MAEO;AACLmF,iBAAO/W,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCkK,IAAhC,EAAsClG,OAAtC,EAA+Ce,OAA/C,CAAP;AACD;AACF;AACDmF,aAAQ,UAAUC,WAAV,GAAwB,GAAxB,GAA8BD,IAA9B,GAAqC,SAA7C;AACA,aAAOA,IAAP;AACD,KAnCS,CAAV;;AAqCA;AACAN,cAAUA,QAAQjR,OAAR,CAAgB,KAAhB,EAAuB,EAAvB,CAAV;;AAEAoM,YAAQS,UAAR;;AAEA,QAAIqE,YAAJ,EAAkB;AAChBD,gBAAUA,QAAQjR,OAAR,CAAgB,MAAhB,EAAwB,EAAxB,CAAV;AACD;;AAED,WAAOiR,OAAP;AACD;;AAED;;;;;;;AAOA,WAASS,qBAAT,CAA+BC,IAA/B,EAAqCC,QAArC,EAA+CV,YAA/C,EAA6D;AAC3D;AACA;AACA,QAAIW,aAAcD,aAAa,IAAd,GAAsB,qBAAtB,GAA8C,qBAA/D;AAAA,QACEE,WAAW,EADb;AAAA,QAEEnO,SAAS,EAFX;;AAIA,QAAIgO,KAAK7D,MAAL,CAAY+D,UAAZ,MAA4B,CAAC,CAAjC,EAAoC;AAClC,OAAC,SAASE,OAAT,CAAiBrC,GAAjB,EAAsB;AACrB,YAAI/K,MAAM+K,IAAI5B,MAAJ,CAAW+D,UAAX,CAAV;AACA,YAAIlN,QAAQ,CAAC,CAAb,EAAgB;AACd;AACAhB,oBAAU,UAAUiO,QAAV,GAAqB,GAArB,GAA2BZ,iBAAiBtB,IAAIhF,KAAJ,CAAU,CAAV,EAAa/F,GAAb,CAAjB,EAAoC,CAAC,CAACuM,YAAtC,CAA3B,GAAiF,IAAjF,GAAwFU,QAAxF,GAAmG,OAA7G;;AAEA;AACAA,qBAAYA,aAAa,IAAd,GAAsB,IAAtB,GAA6B,IAAxC;AACAC,uBAAcD,aAAa,IAAd,GAAsB,qBAAtB,GAA8C,qBAA3D;;AAEA;AACAG,kBAAQrC,IAAIhF,KAAJ,CAAU/F,GAAV,CAAR;AACD,SAVD,MAUO;AACLhB,oBAAU,UAAUiO,QAAV,GAAqB,GAArB,GAA2BZ,iBAAiBtB,GAAjB,EAAsB,CAAC,CAACwB,YAAxB,CAA3B,GAAmE,IAAnE,GAA0EU,QAA1E,GAAqF,OAA/F;AACD;AACF,OAfD,EAeGD,IAfH;AAgBA,WAAK,IAAI/R,IAAI,CAAb,EAAgBA,IAAIkS,SAASpV,MAA7B,EAAqC,EAAEkD,CAAvC,EAA0C,CAEzC;AACF,KApBD,MAoBO;AACL+D,eAAS,UAAUiO,QAAV,GAAqB,GAArB,GAA2BZ,iBAAiBW,IAAjB,EAAuB,CAAC,CAACT,YAAzB,CAA3B,GAAoE,IAApE,GAA2EU,QAA3E,GAAsF,OAA/F;AACD;;AAED,WAAOjO,MAAP;AACD;;AAED;AACA;AACAvB,UAAQ,IAAR;;AAEA;AACA,MAAI4P,YAAY,6FAAhB;;AAEA,MAAI5F,QAAQS,UAAZ,EAAwB;AACtBzK,WAAOA,KAAKpC,OAAL,CAAagS,SAAb,EAAwB,UAAU5I,UAAV,EAAsBuI,IAAtB,EAA4BtE,EAA5B,EAAgC;AAC7D,UAAIuE,WAAYvE,GAAGS,MAAH,CAAU,QAAV,IAAsB,CAAC,CAAxB,GAA6B,IAA7B,GAAoC,IAAnD;AACA,aAAO4D,sBAAsBC,IAAtB,EAA4BC,QAA5B,EAAsC,IAAtC,CAAP;AACD,KAHM,CAAP;AAID,GALD,MAKO;AACLI,gBAAY,uGAAZ;AACA;AACA5P,WAAOA,KAAKpC,OAAL,CAAagS,SAAb,EAAwB,UAAU5I,UAAV,EAAsBC,EAAtB,EAA0BsI,IAA1B,EAAgCrE,EAAhC,EAAoC;;AAEjE,UAAIsE,WAAYtE,GAAGQ,MAAH,CAAU,QAAV,IAAsB,CAAC,CAAxB,GAA6B,IAA7B,GAAoC,IAAnD;AACA,aAAO4D,sBAAsBC,IAAtB,EAA4BC,QAA5B,CAAP;AACD,KAJM,CAAP;AAKD;;AAED;AACAxP,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,EAAnB,CAAP;;AAEAoC,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,aAA5B,EAA2C7J,IAA3C,EAAiDiJ,OAAjD,EAA0De,OAA1D,CAAP;AACA,SAAOhK,IAAP;AACD,CAhKD;;AAkKA;;;AAGA5H,SAAS6M,SAAT,CAAmB,SAAnB,EAA8B,UAAUjF,IAAV,EAAgB;AAC5C;;AAEA;AACA;;AACAA,SAAOA,KAAKpC,OAAL,CAAa,kBAAb,EAAiC,IAAjC,CAAP,CAL4C,CAKG;;AAE/C;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,KAAb,EAAoB,EAApB,CAAP;;AAEA,SAAOoC,IAAP;AACD,CAXD;;AAaA;;;AAGA5H,SAAS6M,SAAT,CAAmB,YAAnB,EAAiC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACjE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,mBAA5B,EAAiD7J,IAAjD,EAAuDiJ,OAAvD,EAAgEe,OAAhE,CAAP;AACA;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,OAAb,EAAsB,EAAtB,CAAP;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,OAAb,EAAsB,EAAtB,CAAP;;AAEA,MAAIiS,QAAQ7P,KAAKzC,KAAL,CAAW,SAAX,CAAZ;AAAA,MACIuS,WAAW,EADf;AAAA,MAEIlQ,MAAMiQ,MAAMvV,MAFhB,CARiE,CAUzC;;AAExB,OAAK,IAAIkD,IAAI,CAAb,EAAgBA,IAAIoC,GAApB,EAAyBpC,GAAzB,EAA8B;AAC5B,QAAIJ,MAAMyS,MAAMrS,CAAN,CAAV;AACA;AACA,QAAIJ,IAAIsO,MAAJ,CAAW,gBAAX,KAAgC,CAApC,EAAuC;AACrCoE,eAAS7Q,IAAT,CAAc7B,GAAd;AACD,KAFD,MAEO;AACLA,YAAMhF,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC7H,GAAhC,EAAqC6L,OAArC,EAA8Ce,OAA9C,CAAN;AACA5M,YAAMA,IAAIQ,OAAJ,CAAY,YAAZ,EAA0B,KAA1B,CAAN;AACAR,aAAO,MAAP;AACA0S,eAAS7Q,IAAT,CAAc7B,GAAd;AACD;AACF;;AAED;AACAwC,QAAMkQ,SAASxV,MAAf;AACA,OAAKkD,IAAI,CAAT,EAAYA,IAAIoC,GAAhB,EAAqBpC,GAArB,EAA0B;AACxB,QAAI2P,YAAY,EAAhB;AAAA,QACI4C,aAAaD,SAAStS,CAAT,CADjB;AAAA,QAEIwS,WAAW,KAFf;AAGA;AACA,WAAOD,WAAWrE,MAAX,CAAkB,eAAlB,KAAsC,CAA7C,EAAgD;AAC9C,UAAIuE,QAAQzP,OAAO0P,EAAnB;AAAA,UACIC,MAAQ3P,OAAO4P,EADnB;;AAGA,UAAIH,UAAU,GAAd,EAAmB;AACjB9C,oBAAYnD,QAAQG,WAAR,CAAoBgG,GAApB,CAAZ;AACD,OAFD,MAEO;AACL;AACA,YAAIH,QAAJ,EAAc;AACZ;AACA7C,sBAAY/U,SAAS6M,SAAT,CAAmB,YAAnB,EAAiC+E,QAAQzG,YAAR,CAAqB4M,GAArB,EAA0BnQ,IAA3D,CAAZ;AACD,SAHD,MAGO;AACLmN,sBAAYnD,QAAQzG,YAAR,CAAqB4M,GAArB,EAA0B5D,SAAtC;AACD;AACF;AACDY,kBAAYA,UAAUvP,OAAV,CAAkB,KAAlB,EAAyB,MAAzB,CAAZ,CAf8C,CAeA;;AAE9CmS,mBAAaA,WAAWnS,OAAX,CAAmB,2BAAnB,EAAgDuP,SAAhD,CAAb;AACA;AACA,UAAI,gCAAgC3L,IAAhC,CAAqCuO,UAArC,CAAJ,EAAsD;AACpDC,mBAAW,IAAX;AACD;AACF;AACDF,aAAStS,CAAT,IAAcuS,UAAd;AACD;AACD/P,SAAO8P,SAASjH,IAAT,CAAc,MAAd,CAAP;AACA;AACA7I,SAAOA,KAAKpC,OAAL,CAAa,OAAb,EAAsB,EAAtB,CAAP;AACAoC,SAAOA,KAAKpC,OAAL,CAAa,OAAb,EAAsB,EAAtB,CAAP;AACA,SAAOoM,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,kBAA5B,EAAgD7J,IAAhD,EAAsDiJ,OAAtD,EAA+De,OAA/D,CAAP;AACD,CA9DD;;AAgEA;;;AAGA5R,SAAS6M,SAAT,CAAmB,cAAnB,EAAmC,UAAUK,GAAV,EAAetF,IAAf,EAAqBiJ,OAArB,EAA8Be,OAA9B,EAAuC;AACxE;;AAEA,MAAI1E,IAAIY,MAAR,EAAgB;AACdlG,WAAOsF,IAAIY,MAAJ,CAAWlG,IAAX,EAAiBgK,QAAQ7R,SAAzB,EAAoC8Q,OAApC,CAAP;AAED,GAHD,MAGO,IAAI3D,IAAIa,KAAR,EAAe;AACpB;AACA,QAAIkK,KAAK/K,IAAIa,KAAb;AACA,QAAI,CAACkK,EAAD,YAAe7P,MAAnB,EAA2B;AACzB6P,WAAK,IAAI7P,MAAJ,CAAW6P,EAAX,EAAe,GAAf,CAAL;AACD;AACDrQ,WAAOA,KAAKpC,OAAL,CAAayS,EAAb,EAAiB/K,IAAI1H,OAArB,CAAP;AACD;;AAED,SAAOoC,IAAP;AACD,CAhBD;;AAkBA;;;;AAIA5H,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAChE;;AAEAhK,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,kBAA5B,EAAgD7J,IAAhD,EAAsDiJ,OAAtD,EAA+De,OAA/D,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCjF,IAAhC,EAAsCiJ,OAAtC,EAA+Ce,OAA/C,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,uCAAnB,EAA4DjF,IAA5D,EAAkEiJ,OAAlE,EAA2Ee,OAA3E,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,wBAAnB,EAA6CjF,IAA7C,EAAmDiJ,OAAnD,EAA4De,OAA5D,CAAP;;AAEA;AACA;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,QAAnB,EAA6BjF,IAA7B,EAAmCiJ,OAAnC,EAA4Ce,OAA5C,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,SAAnB,EAA8BjF,IAA9B,EAAoCiJ,OAApC,EAA6Ce,OAA7C,CAAP;;AAEA;AACA;AACA;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCjF,IAAhC,EAAsCiJ,OAAtC,EAA+Ce,OAA/C,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,qBAAnB,EAA0CjF,IAA1C,EAAgDiJ,OAAhD,EAAyDe,OAAzD,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,gBAAnB,EAAqCjF,IAArC,EAA2CiJ,OAA3C,EAAoDe,OAApD,CAAP;AACAhK,SAAO5H,SAAS6M,SAAT,CAAmB,eAAnB,EAAoCjF,IAApC,EAA0CiJ,OAA1C,EAAmDe,OAAnD,CAAP;;AAEA;AACAhK,SAAOA,KAAKpC,OAAL,CAAa,QAAb,EAAuB,WAAvB,CAAP;;AAEAoC,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,iBAA5B,EAA+C7J,IAA/C,EAAqDiJ,OAArD,EAA8De,OAA9D,CAAP;AACA,SAAOhK,IAAP;AACD,CA1BD;;AA4BA5H,SAAS6M,SAAT,CAAmB,eAAnB,EAAoC,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AACpE;;AAEA,MAAIf,QAAQ7F,aAAZ,EAA2B;AACzBpD,WAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,sBAA5B,EAAoD7J,IAApD,EAA0DiJ,OAA1D,EAAmEe,OAAnE,CAAP;AACAhK,WAAOA,KAAKpC,OAAL,CAAa,+BAAb,EAA8C,eAA9C,CAAP;AACAoC,WAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,qBAA5B,EAAmD7J,IAAnD,EAAyDiJ,OAAzD,EAAkEe,OAAlE,CAAP;AACD;;AAED,SAAOhK,IAAP;AACD,CAVD;;AAYA;;;;;;AAMA5H,SAAS6M,SAAT,CAAmB,iBAAnB,EAAsC,UAAUjF,IAAV,EAAgB;AACpD;;AACA,SAAOA,KAAKpC,OAAL,CAAa,YAAb,EAA2B,EAA3B,CAAP;AACD,CAHD;;AAKA;;;;;;;;;;;;;;;;;;;;;;;;;AAyBAxF,SAAS6M,SAAT,CAAmB,sBAAnB,EAA2C,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAC3E;;AAEA,MAAI7D,QAAQ,8JAAZ;;AAEA;AACAnG,UAAQ,IAAR;;AAEAA,SAAOA,KAAKpC,OAAL,CAAauI,KAAb,EAAoB,UAAUa,UAAV,EAAsBwE,MAAtB,EAA8BnP,GAA9B,EAAmC7B,KAAnC,EAA0CC,MAA1C,EAAkD6V,UAAlD,EAA8D7E,KAA9D,EAAqE;AAC9FD,aAASA,OAAOpJ,WAAP,EAAT;AACA4H,YAAQM,KAAR,CAAckB,MAAd,IAAwBpT,SAAS6M,SAAT,CAAmB,qBAAnB,EAA0C5I,GAA1C,CAAxB,CAF8F,CAErB;;AAEzE,QAAIiU,UAAJ,EAAgB;AACd;AACA;AACA,aAAOA,aAAa7E,KAApB;AAED,KALD,MAKO;AACL,UAAIA,KAAJ,EAAW;AACTzB,gBAAQO,OAAR,CAAgBiB,MAAhB,IAA0BC,MAAM7N,OAAN,CAAc,MAAd,EAAsB,QAAtB,CAA1B;AACD;AACD,UAAIqL,QAAQhG,kBAAR,IAA8BzI,KAA9B,IAAuCC,MAA3C,EAAmD;AACjDuP,gBAAQQ,WAAR,CAAoBgB,MAApB,IAA8B;AAC5BhR,iBAAQA,KADoB;AAE5BC,kBAAQA;AAFoB,SAA9B;AAID;AACF;AACD;AACA,WAAO,EAAP;AACD,GAtBM,CAAP;;AAwBA;AACAuF,SAAOA,KAAKpC,OAAL,CAAa,IAAb,EAAmB,EAAnB,CAAP;;AAEA,SAAOoC,IAAP;AACD,CApCD;;AAsCA5H,SAAS6M,SAAT,CAAmB,QAAnB,EAA6B,UAAUjF,IAAV,EAAgBiJ,OAAhB,EAAyBe,OAAzB,EAAkC;AAC7D;;AAEA,MAAI,CAACf,QAAQ5F,MAAb,EAAqB;AACnB,WAAOrD,IAAP;AACD;;AAED,MAAIuQ,WAAW,4HAAf;;AAEA,WAASC,WAAT,CAAqBC,KAArB,EAA4B;AAC1B,QAAI,eAAejP,IAAf,CAAoBiP,KAApB,CAAJ,EAAgC;AAC9B,aAAO,2BAAP;AACD,KAFD,MAEO,IAAI,qBAAqBjP,IAArB,CAA0BiP,KAA1B,CAAJ,EAAsC;AAC3C,aAAO,4BAAP;AACD,KAFM,MAEA,IAAI,sBAAsBjP,IAAtB,CAA2BiP,KAA3B,CAAJ,EAAuC;AAC5C,aAAO,6BAAP;AACD,KAFM,MAEA;AACL,aAAO,EAAP;AACD;AACF;;AAED,WAASC,YAAT,CAAsBrC,MAAtB,EAA8B7O,KAA9B,EAAqC;AACnC,QAAImR,KAAK,EAAT;AACAtC,aAASA,OAAOa,IAAP,EAAT;AACA,QAAIjG,QAAQ2H,aAAZ,EAA2B;AACzBD,WAAK,UAAUtC,OAAOzQ,OAAP,CAAe,IAAf,EAAqB,GAArB,EAA0BwE,WAA1B,EAAV,GAAoD,GAAzD;AACD;AACDiM,aAASjW,SAAS6M,SAAT,CAAmB,WAAnB,EAAgCoJ,MAAhC,EAAwCpF,OAAxC,EAAiDe,OAAjD,CAAT;;AAEA,WAAO,QAAQ2G,EAAR,GAAanR,KAAb,GAAqB,GAArB,GAA2B6O,MAA3B,GAAoC,SAA3C;AACD;;AAED,WAASwC,UAAT,CAAoBC,IAApB,EAA0BtR,KAA1B,EAAiC;AAC/B,QAAIuR,UAAU3Y,SAAS6M,SAAT,CAAmB,WAAnB,EAAgC6L,IAAhC,EAAsC7H,OAAtC,EAA+Ce,OAA/C,CAAd;AACA,WAAO,QAAQxK,KAAR,GAAgB,GAAhB,GAAsBuR,OAAtB,GAAgC,SAAvC;AACD;;AAED,WAASC,UAAT,CAAoBC,OAApB,EAA6BC,KAA7B,EAAoC;AAClC,QAAIC,KAAK,0BAAT;AAAA,QACIC,SAASH,QAAQ3W,MADrB;;AAGA,SAAK,IAAIkD,IAAI,CAAb,EAAgBA,IAAI4T,MAApB,EAA4B,EAAE5T,CAA9B,EAAiC;AAC/B2T,YAAMF,QAAQzT,CAAR,CAAN;AACD;AACD2T,UAAM,4BAAN;;AAEA,SAAK3T,IAAI,CAAT,EAAYA,IAAI0T,MAAM5W,MAAtB,EAA8B,EAAEkD,CAAhC,EAAmC;AACjC2T,YAAM,QAAN;AACA,WAAK,IAAIrG,KAAK,CAAd,EAAiBA,KAAKsG,MAAtB,EAA8B,EAAEtG,EAAhC,EAAoC;AAClCqG,cAAMD,MAAM1T,CAAN,EAASsN,EAAT,CAAN;AACD;AACDqG,YAAM,SAAN;AACD;AACDA,UAAM,sBAAN;AACA,WAAOA,EAAP;AACD;;AAEDnR,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,eAA5B,EAA6C7J,IAA7C,EAAmDiJ,OAAnD,EAA4De,OAA5D,CAAP;;AAEAhK,SAAOA,KAAKpC,OAAL,CAAa2S,QAAb,EAAuB,UAAUc,QAAV,EAAoB;;AAEhD,QAAI7T,CAAJ;AAAA,QAAO8T,aAAaD,SAAS9T,KAAT,CAAe,IAAf,CAApB;;AAEA;AACA,SAAKC,IAAI,CAAT,EAAYA,IAAI8T,WAAWhX,MAA3B,EAAmC,EAAEkD,CAArC,EAAwC;AACtC,UAAI,gBAAgBgE,IAAhB,CAAqB8P,WAAW9T,CAAX,CAArB,CAAJ,EAAyC;AACvC8T,mBAAW9T,CAAX,IAAgB8T,WAAW9T,CAAX,EAAcI,OAAd,CAAsB,eAAtB,EAAuC,EAAvC,CAAhB;AACD;AACD,UAAI,YAAY4D,IAAZ,CAAiB8P,WAAW9T,CAAX,CAAjB,CAAJ,EAAqC;AACnC8T,mBAAW9T,CAAX,IAAgB8T,WAAW9T,CAAX,EAAcI,OAAd,CAAsB,WAAtB,EAAmC,EAAnC,CAAhB;AACD;AACF;;AAED,QAAI2T,aAAaD,WAAW,CAAX,EAAc/T,KAAd,CAAoB,GAApB,EAAyBiU,GAAzB,CAA6B,UAAU1K,CAAV,EAAa;AAAE,aAAOA,EAAEoI,IAAF,EAAP;AAAiB,KAA7D,CAAjB;AAAA,QACIuC,YAAYH,WAAW,CAAX,EAAc/T,KAAd,CAAoB,GAApB,EAAyBiU,GAAzB,CAA6B,UAAU1K,CAAV,EAAa;AAAE,aAAOA,EAAEoI,IAAF,EAAP;AAAiB,KAA7D,CADhB;AAAA,QAEIwC,WAAW,EAFf;AAAA,QAGIT,UAAU,EAHd;AAAA,QAIIU,SAAS,EAJb;AAAA,QAKIT,QAAQ,EALZ;;AAOAI,eAAWzR,KAAX;AACAyR,eAAWzR,KAAX;;AAEA,SAAKrC,IAAI,CAAT,EAAYA,IAAI8T,WAAWhX,MAA3B,EAAmC,EAAEkD,CAArC,EAAwC;AACtC,UAAI8T,WAAW9T,CAAX,EAAc0R,IAAd,OAAyB,EAA7B,EAAiC;AAC/B;AACD;AACDwC,eAASzS,IAAT,CACEqS,WAAW9T,CAAX,EACGD,KADH,CACS,GADT,EAEGiU,GAFH,CAEO,UAAU1K,CAAV,EAAa;AAChB,eAAOA,EAAEoI,IAAF,EAAP;AACD,OAJH,CADF;AAOD;;AAED,QAAIqC,WAAWjX,MAAX,GAAoBmX,UAAUnX,MAAlC,EAA0C;AACxC,aAAO+W,QAAP;AACD;;AAED,SAAK7T,IAAI,CAAT,EAAYA,IAAIiU,UAAUnX,MAA1B,EAAkC,EAAEkD,CAApC,EAAuC;AACrCmU,aAAO1S,IAAP,CAAYuR,YAAYiB,UAAUjU,CAAV,CAAZ,CAAZ;AACD;;AAED,SAAKA,IAAI,CAAT,EAAYA,IAAI+T,WAAWjX,MAA3B,EAAmC,EAAEkD,CAArC,EAAwC;AACtC,UAAIpF,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BmM,OAAOnU,CAAP,CAA5B,CAAJ,EAA4C;AAC1CmU,eAAOnU,CAAP,IAAY,EAAZ;AACD;AACDyT,cAAQhS,IAAR,CAAayR,aAAaa,WAAW/T,CAAX,CAAb,EAA4BmU,OAAOnU,CAAP,CAA5B,CAAb;AACD;;AAED,SAAKA,IAAI,CAAT,EAAYA,IAAIkU,SAASpX,MAAzB,EAAiC,EAAEkD,CAAnC,EAAsC;AACpC,UAAIoU,MAAM,EAAV;AACA,WAAK,IAAI9G,KAAK,CAAd,EAAiBA,KAAKmG,QAAQ3W,MAA9B,EAAsC,EAAEwQ,EAAxC,EAA4C;AAC1C,YAAI1S,SAASoM,MAAT,CAAgBgB,WAAhB,CAA4BkM,SAASlU,CAAT,EAAYsN,EAAZ,CAA5B,CAAJ,EAAkD,CAEjD;AACD8G,YAAI3S,IAAJ,CAAS4R,WAAWa,SAASlU,CAAT,EAAYsN,EAAZ,CAAX,EAA4B6G,OAAO7G,EAAP,CAA5B,CAAT;AACD;AACDoG,YAAMjS,IAAN,CAAW2S,GAAX;AACD;;AAED,WAAOZ,WAAWC,OAAX,EAAoBC,KAApB,CAAP;AACD,GAhEM,CAAP;;AAkEAlR,SAAOgK,QAAQ7R,SAAR,CAAkB0R,SAAlB,CAA4B,cAA5B,EAA4C7J,IAA5C,EAAkDiJ,OAAlD,EAA2De,OAA3D,CAAP;;AAEA,SAAOhK,IAAP;AACD,CAhID;;AAkIA;;;AAGA5H,SAAS6M,SAAT,CAAmB,sBAAnB,EAA2C,UAAUjF,IAAV,EAAgB;AACzD;;AAEAA,SAAOA,KAAKpC,OAAL,CAAa,WAAb,EAA0B,UAAUoJ,UAAV,EAAsBC,EAAtB,EAA0B;AACzD,QAAI4K,oBAAoBlE,SAAS1G,EAAT,CAAxB;AACA,WAAOzO,OAAOsZ,YAAP,CAAoBD,iBAApB,CAAP;AACD,GAHM,CAAP;AAIA,SAAO7R,IAAP;AACD,CARD;AASAc,OAAOC,OAAP,GAAiB3I,QAAjB,C;;;;;;;;;ACz9EA;;;;AAIA,IAAIsD,cAAc,CAAlB;AACA,IAAIC,eAAe,CAAnB;AACAV,GAAG8W,aAAH,CAAiB;AACfC,SADe,mBACPC,GADO,EACF;AACXvW,kBAAcuW,IAAIvW,WAAlB;AACAC,mBAAesW,IAAItW,YAAnB;AACD;AAJc,CAAjB;;AAOA,IAAMoW,gBAAgB,SAAhBA,aAAgB,GAAM;AAC1B,SAAO,CAAErW,WAAF,EAAeC,YAAf,CAAP;AACD,CAFD;;AAIA,IAAM7C,eAAgB,YAAM;AAC1B,MAAIoZ,WAAW,IAAf;;AAEA,SAAO;AACLxY,SAAK,aAACP,QAAD,EAA2B;AAAA,UAAhBT,IAAgB,uEAAT,IAAS;;AAC9B,UAAI,CAACwZ,QAAL,EAAe;AAAA;;AACbA,8CACG/Y,QADH,IACcT,IADd;AAGD;AACD,aAAOwZ,SAAS/Y,QAAT,CAAP;AACD,KARI;AASLJ,WAAO,iBAAM;AACXmZ,iBAAW,IAAX;AACD;AAXI,GAAP;AAaD,CAhBoB,EAArB;;AAkBApR,OAAOC,OAAP,GAAiB;AACfgR,8BADe;AAEfjZ;AAFe,CAAjB,C","file":"wxParse.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","import HtmlToJson from './utils/html2json';\r\nimport showdown from './utils/showdown.js';\r\nimport { getSystemInfo, bindInstance } from './utils/util';\r\n\r\nComponent({\r\n  properties: {\r\n    nodes: {\r\n      type: null,\r\n      observer(val) {\r\n        const { language } = this.properties\r\n        if (val) {\r\n          if (language === 'html') {\r\n            this._parseNodes(val)\r\n          }\r\n\r\n          if (language === 'markdown' || language === 'md') {\r\n            const converter = new showdown.Converter();\r\n            const parseNodes = converter.makeHtml(val);\r\n            this._parseNodes(parseNodes)\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    language: {\r\n      type: String,\r\n      value: 'html' // html | markdown (md)\r\n    }\r\n  },\r\n\r\n  data: {\r\n    nodesData: [],\r\n    bindData: {},\r\n  },\r\n\r\n  detached() {\r\n    // \r\n    bindInstance.clear()\r\n  },\r\n\r\n  methods: {\r\n    _parseHtml(html, bindName) {\r\n      bindName = 'wxParseData'\r\n\r\n      //htmljson\r\n      const transData = HtmlToJson.html2json(html, bindName)\r\n\r\n      transData.view = {}\r\n      transData.view.imagePadding = 0\r\n      this.setData({\r\n        nodesData: transData.nodes,\r\n        bindData: {\r\n          [bindName]: transData\r\n        }\r\n      })\r\n      bindInstance.set(bindName, transData)\r\n      console.log(this.data)\r\n    },\r\n\r\n    _parseNodes(nodes) {\r\n      if (typeof nodes === 'string') { // html\r\n        this._parseHtml(nodes)\r\n      } else if (Array.isArray(nodes)) { // html \r\n        this.setData({ nodesData: nodes })\r\n      } else { // \r\n        const nodesData = [ nodes ]\r\n        this.setData({ nodesData })\r\n      }\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {*} e \r\n     */\r\n    wxParseImgLoad(e) {\r\n      // image node\r\n      const { from: tagFrom, index } = e.target.dataset || {}\r\n      if (typeof tagFrom !== 'undefined' && tagFrom.length > 0) {\r\n        const { width, height } = e.detail\r\n        \r\n        //view padding\r\n        const recal = this._wxAutoImageCal(width, height)\r\n        this.setData({\r\n          width: recal.imageWidth,\r\n          height: recal.imageHeight,\r\n          [`nodesData[${index}].loaded`]: true,\r\n        })\r\n      }\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {*} e \r\n     */\r\n    wxParseImgTap(e) {\r\n      const { src } = e.target.dataset\r\n      const bindName = 'wxParseData'\r\n      const { imageUrls } = bindInstance.set(bindName)\r\n      wx.previewImage({ \r\n        current: src,\r\n        urls: imageUrls\r\n      })\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {*} originalWidth \r\n     * @param {*} originalHeight \r\n     */\r\n    _wxAutoImageCal(originalWidth, originalHeight) {\r\n      let autoWidth = 0, autoHeight = 0;\r\n      const results = {}\r\n      const [ windowWidth, windowHeight ] = getSystemInfo()\r\n\r\n      // \r\n      if (originalWidth > windowWidth) { //widthwidth\r\n        autoWidth = windowWidth\r\n        autoHeight = (autoWidth * originalHeight) / originalWidth\r\n        results.imageWidth = autoWidth\r\n        results.imageHeight = autoHeight\r\n      } else { // \r\n        results.imageWidth = originalWidth\r\n        results.imageHeight = originalHeight\r\n      }\r\n      return results\r\n    },\r\n\r\n    /**\r\n     * a\r\n     * 1. pagehandleTagATap\r\n     * 2. pagehandleTagATap\r\n     * @param {*} e \r\n     */\r\n    wxParseTagATap(e) {\r\n      const { src = '' } = e.currentTarget.dataset\r\n\r\n      // triggerEvent\r\n      const curPages =  getCurrentPages();\r\n      const currentPage = curPages[curPages.length - 1]\r\n      if (currentPage && currentPage.handleTagATap) {\r\n        currentPage.handleTagATap(src)\r\n        return\r\n      }\r\n\r\n      // \r\n      const isInnerPage = src.indexOf('http') === -1\r\n      if (isInnerPage) {\r\n        wx.navigateTo({\r\n          url: src\r\n        })\r\n      } else {\r\n        wx.navigateTo({\r\n          url: `/miniprogram_npm/wx-minicomponent/wxParse/webviewPage/webviewPage?src=${src}`\r\n        })\r\n      }\r\n    }\r\n  }\r\n})","/**\r\n * html2Json : https://github.com/Jxck/html2json\r\n * \r\n * \r\n */\r\n\r\nvar __placeImgeUrlHttps = \"https\";\r\nvar __emojisReg = '';\r\nvar __emojisBaseSrc = '';\r\nvar __emojis = {};\r\nvar wxDiscode = require('./wxDiscode.js');\r\nvar HTMLParser = require('./htmlparser.js');\r\n// Empty Elements - HTML 5\r\nvar empty = makeMap(\"area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr\");\r\n// Block Elements - HTML 5\r\nvar block = makeMap(\"br,a,code,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video\");\r\n\r\n// Inline Elements - HTML 5\r\nvar inline = makeMap(\"abbr,acronym,applet,b,basefont,bdo,big,button,cite,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var\");\r\n\r\n// Elements that you can, intentionally, leave open\r\n// (and which close themselves)\r\nvar closeSelf = makeMap(\"colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr\");\r\n\r\n// Attributes that have their values filled in disabled=\"disabled\"\r\nvar fillAttrs = makeMap(\"checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected\");\r\n\r\n// Special Elements (can contain anything)\r\nvar special = makeMap(\"wxxxcode-style,script,style,view,scroll-view,block\");\r\nfunction makeMap(str) {\r\n    var obj = {}, items = str.split(\",\");\r\n    for (var i = 0; i < items.length; i++)\r\n        obj[items[i]] = true;\r\n    return obj;\r\n}\r\n\r\nfunction q(v) {\r\n    return '\"' + v + '\"';\r\n}\r\n\r\nfunction removeDOCTYPE(html) {\r\n    return html\r\n        .replace(/<\\?xml.*\\?>\\n/, '')\r\n        .replace(/<.*!doctype.*\\>\\n/, '')\r\n        .replace(/<.*!DOCTYPE.*\\>\\n/, '');\r\n}\r\n\r\nfunction trimHtml(html) {\r\n  return html\r\n        .replace(/\\r?\\n+/g, '')\r\n        .replace(/<!--.*?-->/ig, '')\r\n        .replace(/\\/\\*.*?\\*\\//ig, '')\r\n        .replace(/[ ]+</ig, '<')\r\n}\r\n\r\n\r\nfunction html2json(html, bindName) {\r\n    //\r\n    html = removeDOCTYPE(html);\r\n    html = trimHtml(html);\r\n    html = wxDiscode.strDiscode(html);\r\n    //node\r\n    var bufArray = [];\r\n    var results = {\r\n        node: bindName,\r\n        nodes: [],\r\n        images:[],\r\n        imageUrls:[]\r\n    };\r\n    var index = 0;\r\n    HTMLParser(html, {\r\n        start: function (tag, attrs, unary) {\r\n            //debug(tag, attrs, unary);\r\n            // node for this element\r\n            var node = {\r\n                node: 'element',\r\n                tag: tag,\r\n            };\r\n\r\n            if (bufArray.length === 0) {\r\n                node.index = index.toString()\r\n                index += 1\r\n            } else {\r\n                var parent = bufArray[0];\r\n                if (parent.nodes === undefined) {\r\n                    parent.nodes = [];\r\n                }\r\n                node.index = parent.index + '.' + parent.nodes.length\r\n            }\r\n\r\n            if (block[tag]) {\r\n                node.tagType = \"block\";\r\n            } else if (inline[tag]) {\r\n                node.tagType = \"inline\";\r\n            } else if (closeSelf[tag]) {\r\n                node.tagType = \"closeSelf\";\r\n            }\r\n\r\n            if (attrs.length !== 0) {\r\n                node.attr = attrs.reduce(function (pre, attr) {\r\n                    var name = attr.name;\r\n                    var value = attr.value;\r\n                    if (name == 'class') {\r\n                        // console.dir(value);\r\n                        //  value = value.join(\"\")\r\n                        node.classStr = value;\r\n                    }\r\n                    // has multi attibutes\r\n                    // make it array of attribute\r\n                    if (name == 'style') {\r\n                        // console.dir(value);\r\n                        //  value = value.join(\"\")\r\n                        node.styleStr = value;\r\n                    }\r\n                    if (value.match(/ /)) {\r\n                        value = value.split(' ');\r\n                    }\r\n                    \r\n\r\n                    // if attr already exists\r\n                    // merge it\r\n                    if (pre[name]) {\r\n                        if (Array.isArray(pre[name])) {\r\n                            // already array, push to last\r\n                            pre[name].push(value);\r\n                        } else {\r\n                            // single value, make it array\r\n                            pre[name] = [pre[name], value];\r\n                        }\r\n                    } else {\r\n                        // not exist, put it\r\n                        pre[name] = value;\r\n                    }\r\n\r\n                    return pre;\r\n                }, {});\r\n            }\r\n\r\n            //img\r\n            if (node.tag === 'img') {\r\n                node.imgIndex = results.images.length;\r\n                var imgUrl = node.attr.src;\r\n                if (imgUrl[0] == '') {\r\n                    imgUrl.splice(0, 1);\r\n                }\r\n                imgUrl = wxDiscode.urlToHttpUrl(imgUrl, __placeImgeUrlHttps);\r\n                node.attr.src = imgUrl;\r\n                node.from = bindName;\r\n                results.images.push(node);\r\n                results.imageUrls.push(imgUrl);\r\n            }\r\n            \r\n            // font\r\n            if (node.tag === 'font') {\r\n                var fontSize = ['x-small', 'small', 'medium', 'large', 'x-large', 'xx-large', '-webkit-xxx-large'];\r\n                var styleAttrs = {\r\n                    'color': 'color',\r\n                    'face': 'font-family',\r\n                    'size': 'font-size'\r\n                };\r\n                if (!node.attr.style) node.attr.style = [];\r\n                if (!node.styleStr) node.styleStr = '';\r\n                for (var key in styleAttrs) {\r\n                    if (node.attr[key]) {\r\n                        var value = key === 'size' ? fontSize[node.attr[key]-1] : node.attr[key];\r\n                        node.attr.style.push(styleAttrs[key]);\r\n                        node.attr.style.push(value);\r\n                        node.styleStr += styleAttrs[key] + ': ' + value + ';';\r\n                    }\r\n                }\r\n            }\r\n\r\n            //source\r\n            if(node.tag === 'source'){\r\n                results.source = node.attr.src;\r\n            }\r\n            \r\n            if (unary) {\r\n                // if this tag doesn't have end tag\r\n                // like <img src=\"hoge.png\"/>\r\n                // add to parents\r\n                var parent = bufArray[0] || results;\r\n                if (parent.nodes === undefined) {\r\n                    parent.nodes = [];\r\n                }\r\n                parent.nodes.push(node);\r\n            } else {\r\n                bufArray.unshift(node);\r\n            }\r\n        },\r\n        end: function (tag) {\r\n            //debug(tag);\r\n            // merge into parent tag\r\n            var node = bufArray.shift();\r\n            if (node.tag !== tag) console.error('invalid state: mismatch end tag');\r\n\r\n            //sourcevideosrc\r\n            if(node.tag === 'video' && results.source){\r\n                node.attr.src = results.source;\r\n                delete results.source;\r\n            }\r\n            \r\n            if (bufArray.length === 0) {\r\n                results.nodes.push(node);\r\n            } else {\r\n                var parent = bufArray[0];\r\n                if (parent.nodes === undefined) {\r\n                    parent.nodes = [];\r\n                }\r\n                parent.nodes.push(node);\r\n            }\r\n        },\r\n        chars: function (text) {\r\n            //debug(text);\r\n            var node = {\r\n                node: 'text',\r\n                text: text,\r\n                textArray:transEmojiStr(text)\r\n            };\r\n            \r\n            if (bufArray.length === 0) {\r\n                node.index = index.toString()\r\n                index += 1\r\n                results.nodes.push(node);\r\n            } else {\r\n                var parent = bufArray[0];\r\n                if (parent.nodes === undefined) {\r\n                    parent.nodes = [];\r\n                }\r\n                node.index = parent.index + '.' + parent.nodes.length\r\n                parent.nodes.push(node);\r\n            }\r\n        },\r\n        comment: function (text) {\r\n            //debug(text);\r\n            // var node = {\r\n            //     node: 'comment',\r\n            //     text: text,\r\n            // };\r\n            // var parent = bufArray[0];\r\n            // if (parent.nodes === undefined) {\r\n            //     parent.nodes = [];\r\n            // }\r\n            // parent.nodes.push(node);\r\n        },\r\n    });\r\n    return results;\r\n};\r\n\r\nfunction transEmojiStr(str){\r\n  // var eReg = new RegExp(\"[\"+__reg+' '+\"]\");\r\n//   str = str.replace(/\\[([^\\[\\]]+)\\]/g,':$1:')\r\n  \r\n  var emojiObjs = [];\r\n  //\r\n  if(__emojisReg.length == 0 || !__emojis){\r\n      var emojiObj = {}\r\n      emojiObj.node = \"text\";\r\n      emojiObj.text = str;\r\n      array = [emojiObj];\r\n      return array;\r\n  }\r\n  //\r\n  str = str.replace(/\\[([^\\[\\]]+)\\]/g,':$1:')\r\n  var eReg = new RegExp(\"[:]\");\r\n  var array = str.split(eReg);\r\n  for(var i = 0; i < array.length; i++){\r\n    var ele = array[i];\r\n    var emojiObj = {};\r\n    if(__emojis[ele]){\r\n      emojiObj.node = \"element\";\r\n      emojiObj.tag = \"emoji\";\r\n      emojiObj.text = __emojis[ele];\r\n      emojiObj.baseSrc= __emojisBaseSrc;\r\n    }else{\r\n      emojiObj.node = \"text\";\r\n      emojiObj.text = ele;\r\n    }\r\n    emojiObjs.push(emojiObj);\r\n  }\r\n  \r\n  return emojiObjs;\r\n}\r\n\r\nfunction emojisInit(reg='',baseSrc=\"/wxParse/emojis/\",emojis){\r\n    __emojisReg = reg;\r\n    __emojisBaseSrc=baseSrc;\r\n    __emojis=emojis;\r\n}\r\n\r\nmodule.exports = {\r\n    html2json: html2json,\r\n    emojisInit:emojisInit\r\n};\r\n\r\n","// HTML \r\nfunction strNumDiscode(str){\r\n  str = str.replace(/&forall;/g, '');\r\n  str = str.replace(/&part;/g, '');\r\n  str = str.replace(/&exists;/g, '');\r\n  str = str.replace(/&empty;/g, '');\r\n  str = str.replace(/&nabla;/g, '');\r\n  str = str.replace(/&isin;/g, '');\r\n  str = str.replace(/&notin;/g, '');\r\n  str = str.replace(/&ni;/g, '');\r\n  str = str.replace(/&prod;/g, '');\r\n  str = str.replace(/&sum;/g, '');\r\n  str = str.replace(/&minus;/g, '');\r\n  str = str.replace(/&lowast;/g, '');\r\n  str = str.replace(/&radic;/g, '');\r\n  str = str.replace(/&prop;/g, '');\r\n  str = str.replace(/&infin;/g, '');\r\n  str = str.replace(/&ang;/g, '');\r\n  str = str.replace(/&and;/g, '');\r\n  str = str.replace(/&or;/g, '');\r\n  str = str.replace(/&cap;/g, '');\r\n  str = str.replace(/&cap;/g, '');\r\n  str = str.replace(/&int;/g, '');\r\n  str = str.replace(/&there4;/g, '');\r\n  str = str.replace(/&sim;/g, '');\r\n  str = str.replace(/&cong;/g, '');\r\n  str = str.replace(/&asymp;/g, '');\r\n  str = str.replace(/&ne;/g, '');\r\n  str = str.replace(/&le;/g, '');\r\n  str = str.replace(/&ge;/g, '');\r\n  str = str.replace(/&sub;/g, '');\r\n  str = str.replace(/&sup;/g, '');\r\n  str = str.replace(/&nsub;/g, '');\r\n  str = str.replace(/&sube;/g, '');\r\n  str = str.replace(/&supe;/g, '');\r\n  str = str.replace(/&oplus;/g, '');\r\n  str = str.replace(/&otimes;/g, '');\r\n  str = str.replace(/&perp;/g, '');\r\n  str = str.replace(/&sdot;/g, '');\r\n  return str;\r\n}\r\n\r\n//HTML \r\nfunction strGreeceDiscode(str){\r\n  str = str.replace(/&Alpha;/g, '');\r\n  str = str.replace(/&Beta;/g, '');\r\n  str = str.replace(/&Gamma;/g, '');\r\n  str = str.replace(/&Delta;/g, '');\r\n  str = str.replace(/&Epsilon;/g, '');\r\n  str = str.replace(/&Zeta;/g, '');\r\n  str = str.replace(/&Eta;/g, '');\r\n  str = str.replace(/&Theta;/g, '');\r\n  str = str.replace(/&Iota;/g, '');\r\n  str = str.replace(/&Kappa;/g, '');\r\n  str = str.replace(/&Lambda;/g, '');\r\n  str = str.replace(/&Mu;/g, '');\r\n  str = str.replace(/&Nu;/g, '');\r\n  str = str.replace(/&Xi;/g, '');\r\n  str = str.replace(/&Omicron;/g, '');\r\n  str = str.replace(/&Pi;/g, '');\r\n  str = str.replace(/&Rho;/g, '');\r\n  str = str.replace(/&Sigma;/g, '');\r\n  str = str.replace(/&Tau;/g, '');\r\n  str = str.replace(/&Upsilon;/g, '');\r\n  str = str.replace(/&Phi;/g, '');\r\n  str = str.replace(/&Chi;/g, '');\r\n  str = str.replace(/&Psi;/g, '');\r\n  str = str.replace(/&Omega;/g, '');\r\n\r\n  str = str.replace(/&alpha;/g, '');\r\n  str = str.replace(/&beta;/g, '');\r\n  str = str.replace(/&gamma;/g, '');\r\n  str = str.replace(/&delta;/g, '');\r\n  str = str.replace(/&epsilon;/g, '');\r\n  str = str.replace(/&zeta;/g, '');\r\n  str = str.replace(/&eta;/g, '');\r\n  str = str.replace(/&theta;/g, '');\r\n  str = str.replace(/&iota;/g, '');\r\n  str = str.replace(/&kappa;/g, '');\r\n  str = str.replace(/&lambda;/g, '');\r\n  str = str.replace(/&mu;/g, '');\r\n  str = str.replace(/&nu;/g, '');\r\n  str = str.replace(/&xi;/g, '');\r\n  str = str.replace(/&omicron;/g, '');\r\n  str = str.replace(/&pi;/g, '');\r\n  str = str.replace(/&rho;/g, '');\r\n  str = str.replace(/&sigmaf;/g, '');\r\n  str = str.replace(/&sigma;/g, '');\r\n  str = str.replace(/&tau;/g, '');\r\n  str = str.replace(/&upsilon;/g, '');\r\n  str = str.replace(/&phi;/g, '');\r\n  str = str.replace(/&chi;/g, '');\r\n  str = str.replace(/&psi;/g, '');\r\n  str = str.replace(/&omega;/g, '');\r\n  str = str.replace(/&thetasym;/g, '');\r\n  str = str.replace(/&upsih;/g, '');\r\n  str = str.replace(/&piv;/g, '');\r\n  str = str.replace(/&middot;/g, '');\r\n  return str;\r\n}\r\n\r\n// \r\n\r\nfunction strcharacterDiscode(str){\r\n  // \r\n  str = str.replace(/&nbsp;/g, ' ');\r\n  str = str.replace(/&quot;/g, \"'\");\r\n  str = str.replace(/&amp;/g, '&');\r\n  // str = str.replace(/&lt;/g, '');\r\n  // str = str.replace(/&gt;/g, '');\r\n\r\n  str = str.replace(/&lt;/g, '<');\r\n  str = str.replace(/&gt;/g, '>');\r\n  str = str.replace(/&#8226;/g, '');\r\n\r\n  return str;\r\n}\r\n\r\n// HTML \r\nfunction strOtherDiscode(str){\r\n  str = str.replace(/&OElig;/g, '');\r\n  str = str.replace(/&oelig;/g, '');\r\n  str = str.replace(/&Scaron;/g, '');\r\n  str = str.replace(/&scaron;/g, '');\r\n  str = str.replace(/&Yuml;/g, '');\r\n  str = str.replace(/&fnof;/g, '');\r\n  str = str.replace(/&circ;/g, '');\r\n  str = str.replace(/&tilde;/g, '');\r\n  str = str.replace(/&ensp;/g, '');\r\n  str = str.replace(/&emsp;/g, '');\r\n  str = str.replace(/&thinsp;/g, '');\r\n  str = str.replace(/&zwnj;/g, '');\r\n  str = str.replace(/&zwj;/g, '');\r\n  str = str.replace(/&lrm;/g, '');\r\n  str = str.replace(/&rlm;/g, '');\r\n  str = str.replace(/&ndash;/g, '');\r\n  str = str.replace(/&mdash;/g, '');\r\n  str = str.replace(/&lsquo;/g, '');\r\n  str = str.replace(/&rsquo;/g, '');\r\n  str = str.replace(/&sbquo;/g, '');\r\n  str = str.replace(/&ldquo;/g, '');\r\n  str = str.replace(/&rdquo;/g, '');\r\n  str = str.replace(/&bdquo;/g, '');\r\n  str = str.replace(/&dagger;/g, '');\r\n  str = str.replace(/&Dagger;/g, '');\r\n  str = str.replace(/&bull;/g, '');\r\n  str = str.replace(/&hellip;/g, '');\r\n  str = str.replace(/&permil;/g, '');\r\n  str = str.replace(/&prime;/g, '');\r\n  str = str.replace(/&Prime;/g, '');\r\n  str = str.replace(/&lsaquo;/g, '');\r\n  str = str.replace(/&rsaquo;/g, '');\r\n  str = str.replace(/&oline;/g, '');\r\n  str = str.replace(/&euro;/g, '');\r\n  str = str.replace(/&trade;/g, '');\r\n\r\n  str = str.replace(/&larr;/g, '');\r\n  str = str.replace(/&uarr;/g, '');\r\n  str = str.replace(/&rarr;/g, '');\r\n  str = str.replace(/&darr;/g, '');\r\n  str = str.replace(/&harr;/g, '');\r\n  str = str.replace(/&crarr;/g, '');\r\n  str = str.replace(/&lceil;/g, '');\r\n  str = str.replace(/&rceil;/g, '');\r\n\r\n  str = str.replace(/&lfloor;/g, '');\r\n  str = str.replace(/&rfloor;/g, '');\r\n  str = str.replace(/&loz;/g, '');\r\n  str = str.replace(/&spades;/g, '');\r\n  str = str.replace(/&clubs;/g, '');\r\n  str = str.replace(/&hearts;/g, '');\r\n\r\n  str = str.replace(/&diams;/g, '');\r\n  str = str.replace(/&#39;/g, '\\'');\r\n  return str;\r\n}\r\n\r\nfunction strMoreDiscode(str){\r\n  str = str.replace(/\\r\\n/g,\"\");  \r\n  str = str.replace(/\\n/g,\"\");\r\n\r\n  // str = str.replace(/code/g,\"wxxxcode-style\");\r\n  return str;\r\n}\r\n\r\nfunction strDiscode(str){\r\n  str = strNumDiscode(str);\r\n  str = strGreeceDiscode(str);\r\n  str = strcharacterDiscode(str);\r\n  str = strOtherDiscode(str);\r\n  str = strMoreDiscode(str);\r\n  return str;\r\n}\r\nfunction urlToHttpUrl(url,rep){\r\n  \r\n  var patt1 = new RegExp(\"^//\");\r\n  var result = patt1.test(url);\r\n  if(result){\r\n      url = rep+\":\"+url;\r\n  }\r\n  return  url;\r\n}\r\n\r\nmodule.exports = {\r\n  strDiscode:strDiscode,\r\n  urlToHttpUrl:urlToHttpUrl\r\n}","/**\r\n * \r\n * htmlParser: https://github.com/blowsie/Pure-JavaScript-HTML5-Parser\r\n * \r\n */\r\n\r\n// Regular Expressions for parsing tags and attributes\r\nvar startTag = /^<([-A-Za-z0-9_]+)((?:\\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)>/,\r\n\tendTag = /^<\\/([-A-Za-z0-9_]+)[^>]*>/,\r\n\tattr = /([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\\s*=\\s*(?:(?:\"((?:\\\\.|[^\"])*)\")|(?:'((?:\\\\.|[^'])*)')|([^>\\s]+)))?/g;\r\n\r\n// Empty Elements - HTML 5\r\nvar empty = makeMap(\"area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr\");\r\n\r\n// Block Elements - HTML 5\r\nvar block = makeMap(\"a,address,code,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video\");\r\n\r\n// Inline Elements - HTML 5\r\nvar inline = makeMap(\"abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var\");\r\n\r\n// Elements that you can, intentionally, leave open\r\n// (and which close themselves)\r\nvar closeSelf = makeMap(\"colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr\");\r\n\r\n// Attributes that have their values filled in disabled=\"disabled\"\r\nvar fillAttrs = makeMap(\"checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected\");\r\n\r\n// Special Elements (can contain anything)\r\nvar special = makeMap(\"wxxxcode-style,script,style,view,scroll-view,block\");\r\n\r\nfunction HTMLParser(html, handler) {\r\n\tvar index, chars, match, stack = [], last = html;\r\n\tstack.last = function () {\r\n\t\treturn this[this.length - 1];\r\n\t};\r\n\r\n\twhile (html) {\r\n\t\tchars = true;\r\n\r\n\t\t// Make sure we're not in a script or style element\r\n\t\tif (!stack.last() || !special[stack.last()]) {\r\n\r\n\t\t\t// Comment\r\n\t\t\tif (html.indexOf(\"<!--\") == 0) {\r\n\t\t\t\tindex = html.indexOf(\"-->\");\r\n\r\n\t\t\t\tif (index >= 0) {\r\n\t\t\t\t\tif (handler.comment)\r\n\t\t\t\t\t\thandler.comment(html.substring(4, index));\r\n\t\t\t\t\thtml = html.substring(index + 3);\r\n\t\t\t\t\tchars = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// end tag\r\n\t\t\t} else if (html.indexOf(\"</\") == 0) {\r\n\t\t\t\tmatch = html.match(endTag);\r\n\r\n\t\t\t\tif (match) {\r\n\t\t\t\t\thtml = html.substring(match[0].length);\r\n\t\t\t\t\tmatch[0].replace(endTag, parseEndTag);\r\n\t\t\t\t\tchars = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// start tag\r\n\t\t\t} else if (html.indexOf(\"<\") == 0) {\r\n\t\t\t\tmatch = html.match(startTag);\r\n\r\n\t\t\t\tif (match) {\r\n\t\t\t\t\thtml = html.substring(match[0].length);\r\n\t\t\t\t\tmatch[0].replace(startTag, parseStartTag);\r\n\t\t\t\t\tchars = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (chars) {\r\n\t\t\t\tindex = html.indexOf(\"<\");\r\n\t\t\t\tvar text = ''\r\n\t\t\t\twhile (index === 0) {\r\n                                  text += \"<\";\r\n                                  html = html.substring(1);\r\n                                  index = html.indexOf(\"<\");\r\n\t\t\t\t}\r\n\t\t\t\ttext += index < 0 ? html : html.substring(0, index);\r\n\t\t\t\thtml = index < 0 ? \"\" : html.substring(index);\r\n\r\n\t\t\t\tif (handler.chars)\r\n\t\t\t\t\thandler.chars(text);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\thtml = html.replace(new RegExp(\"([\\\\s\\\\S]*?)<\\/\" + stack.last() + \"[^>]*>\"), function (all, text) {\r\n\t\t\t\ttext = text.replace(/<!--([\\s\\S]*?)-->|<!\\[CDATA\\[([\\s\\S]*?)]]>/g, \"$1$2\");\r\n\t\t\t\tif (handler.chars)\r\n\t\t\t\t\thandler.chars(text);\r\n\r\n\t\t\t\treturn \"\";\r\n\t\t\t});\r\n\r\n\r\n\t\t\tparseEndTag(\"\", stack.last());\r\n\t\t}\r\n\r\n\t\tif (html == last)\r\n\t\t\tthrow \"Parse Error: \" + html;\r\n\t\tlast = html;\r\n\t}\r\n\r\n\t// Clean up any remaining tags\r\n\tparseEndTag();\r\n\r\n\tfunction parseStartTag(tag, tagName, rest, unary) {\r\n\t\ttagName = tagName.toLowerCase();\r\n\r\n\t\tif (block[tagName]) {\r\n\t\t\twhile (stack.last() && inline[stack.last()]) {\r\n\t\t\t\tparseEndTag(\"\", stack.last());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (closeSelf[tagName] && stack.last() == tagName) {\r\n\t\t\tparseEndTag(\"\", tagName);\r\n\t\t}\r\n\r\n\t\tunary = empty[tagName] || !!unary;\r\n\r\n\t\tif (!unary)\r\n\t\t\tstack.push(tagName);\r\n\r\n\t\tif (handler.start) {\r\n\t\t\tvar attrs = [];\r\n\r\n\t\t\trest.replace(attr, function (match, name) {\r\n\t\t\t\tvar value = arguments[2] ? arguments[2] :\r\n\t\t\t\t\targuments[3] ? arguments[3] :\r\n\t\t\t\t\t\targuments[4] ? arguments[4] :\r\n\t\t\t\t\t\t\tfillAttrs[name] ? name : \"\";\r\n\r\n\t\t\t\tattrs.push({\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tvalue: value,\r\n\t\t\t\t\tescaped: value.replace(/(^|[^\\\\])\"/g, '$1\\\\\\\"') //\"\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tif (handler.start) {\r\n\t\t\t\thandler.start(tagName, attrs, unary);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tfunction parseEndTag(tag, tagName) {\r\n\t\t// If no tag name is provided, clean shop\r\n\t\tif (!tagName)\r\n\t\t\tvar pos = 0;\r\n\r\n\t\t// Find the closest opened tag of the same type\r\n\t\telse {\r\n\t\t\ttagName = tagName.toLowerCase();\r\n\t\t\tfor (var pos = stack.length - 1; pos >= 0; pos--)\r\n\t\t\t\tif (stack[pos] == tagName)\r\n\t\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (pos >= 0) {\r\n\t\t\t// Close all the open elements, up the stack\r\n\t\t\tfor (var i = stack.length - 1; i >= pos; i--)\r\n\t\t\t\tif (handler.end)\r\n\t\t\t\t\thandler.end(stack[i]);\r\n\r\n\t\t\t// Remove the open elements from the stack\r\n\t\t\tstack.length = pos;\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\nfunction makeMap(str) {\r\n\tvar obj = {}, items = str.split(\",\");\r\n\tfor (var i = 0; i < items.length; i++)\r\n\t\tobj[items[i]] = true;\r\n\treturn obj;\r\n}\r\n\r\nmodule.exports = HTMLParser;\r\n","/**\r\n * showdown: https://github.com/showdownjs/showdown\r\n */\r\n\r\nfunction getDefaultOpts(simple) {\r\n  'use strict';\r\n\r\n  var defaultOptions = {\r\n    omitExtraWLInCodeBlocks: {\r\n      defaultValue: false,\r\n      describe: 'Omit the default extra whiteline added to code blocks',\r\n      type: 'boolean'\r\n    },\r\n    noHeaderId: {\r\n      defaultValue: false,\r\n      describe: 'Turn on/off generated header id',\r\n      type: 'boolean'\r\n    },\r\n    prefixHeaderId: {\r\n      defaultValue: false,\r\n      describe: 'Specify a prefix to generated header ids',\r\n      type: 'string'\r\n    },\r\n    headerLevelStart: {\r\n      defaultValue: false,\r\n      describe: 'The header blocks level start',\r\n      type: 'integer'\r\n    },\r\n    parseImgDimensions: {\r\n      defaultValue: false,\r\n      describe: 'Turn on/off image dimension parsing',\r\n      type: 'boolean'\r\n    },\r\n    simplifiedAutoLink: {\r\n      defaultValue: false,\r\n      describe: 'Turn on/off GFM autolink style',\r\n      type: 'boolean'\r\n    },\r\n    literalMidWordUnderscores: {\r\n      defaultValue: false,\r\n      describe: 'Parse midword underscores as literal underscores',\r\n      type: 'boolean'\r\n    },\r\n    strikethrough: {\r\n      defaultValue: false,\r\n      describe: 'Turn on/off strikethrough support',\r\n      type: 'boolean'\r\n    },\r\n    tables: {\r\n      defaultValue: false,\r\n      describe: 'Turn on/off tables support',\r\n      type: 'boolean'\r\n    },\r\n    tablesHeaderId: {\r\n      defaultValue: false,\r\n      describe: 'Add an id to table headers',\r\n      type: 'boolean'\r\n    },\r\n    ghCodeBlocks: {\r\n      defaultValue: true,\r\n      describe: 'Turn on/off GFM fenced code blocks support',\r\n      type: 'boolean'\r\n    },\r\n    tasklists: {\r\n      defaultValue: false,\r\n      describe: 'Turn on/off GFM tasklist support',\r\n      type: 'boolean'\r\n    },\r\n    smoothLivePreview: {\r\n      defaultValue: false,\r\n      describe: 'Prevents weird effects in live previews due to incomplete input',\r\n      type: 'boolean'\r\n    },\r\n    smartIndentationFix: {\r\n      defaultValue: false,\r\n      description: 'Tries to smartly fix identation in es6 strings',\r\n      type: 'boolean'\r\n    }\r\n  };\r\n  if (simple === false) {\r\n    return JSON.parse(JSON.stringify(defaultOptions));\r\n  }\r\n  var ret = {};\r\n  for (var opt in defaultOptions) {\r\n    if (defaultOptions.hasOwnProperty(opt)) {\r\n      ret[opt] = defaultOptions[opt].defaultValue;\r\n    }\r\n  }\r\n  return ret;\r\n}\r\n\r\n/**\r\n * Created by Tivie on 06-01-2015.\r\n */\r\n\r\n// Private properties\r\nvar showdown = {},\r\n    parsers = {},\r\n    extensions = {},\r\n    globalOptions = getDefaultOpts(true),\r\n    flavor = {\r\n      github: {\r\n        omitExtraWLInCodeBlocks:   true,\r\n        prefixHeaderId:            'user-content-',\r\n        simplifiedAutoLink:        true,\r\n        literalMidWordUnderscores: true,\r\n        strikethrough:             true,\r\n        tables:                    true,\r\n        tablesHeaderId:            true,\r\n        ghCodeBlocks:              true,\r\n        tasklists:                 true\r\n      },\r\n      vanilla: getDefaultOpts(true)\r\n    };\r\n\r\n/**\r\n * helper namespace\r\n * @type {{}}\r\n */\r\nshowdown.helper = {};\r\n\r\n/**\r\n * TODO LEGACY SUPPORT CODE\r\n * @type {{}}\r\n */\r\nshowdown.extensions = {};\r\n\r\n/**\r\n * Set a global option\r\n * @static\r\n * @param {string} key\r\n * @param {*} value\r\n * @returns {showdown}\r\n */\r\nshowdown.setOption = function (key, value) {\r\n  'use strict';\r\n  globalOptions[key] = value;\r\n  return this;\r\n};\r\n\r\n/**\r\n * Get a global option\r\n * @static\r\n * @param {string} key\r\n * @returns {*}\r\n */\r\nshowdown.getOption = function (key) {\r\n  'use strict';\r\n  return globalOptions[key];\r\n};\r\n\r\n/**\r\n * Get the global options\r\n * @static\r\n * @returns {{}}\r\n */\r\nshowdown.getOptions = function () {\r\n  'use strict';\r\n  return globalOptions;\r\n};\r\n\r\n/**\r\n * Reset global options to the default values\r\n * @static\r\n */\r\nshowdown.resetOptions = function () {\r\n  'use strict';\r\n  globalOptions = getDefaultOpts(true);\r\n};\r\n\r\n/**\r\n * Set the flavor showdown should use as default\r\n * @param {string} name\r\n */\r\nshowdown.setFlavor = function (name) {\r\n  'use strict';\r\n  if (flavor.hasOwnProperty(name)) {\r\n    var preset = flavor[name];\r\n    for (var option in preset) {\r\n      if (preset.hasOwnProperty(option)) {\r\n        globalOptions[option] = preset[option];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get the default options\r\n * @static\r\n * @param {boolean} [simple=true]\r\n * @returns {{}}\r\n */\r\nshowdown.getDefaultOptions = function (simple) {\r\n  'use strict';\r\n  return getDefaultOpts(simple);\r\n};\r\n\r\n/**\r\n * Get or set a subParser\r\n *\r\n * subParser(name)       - Get a registered subParser\r\n * subParser(name, func) - Register a subParser\r\n * @static\r\n * @param {string} name\r\n * @param {function} [func]\r\n * @returns {*}\r\n */\r\nshowdown.subParser = function (name, func) {\r\n  'use strict';\r\n  if (showdown.helper.isString(name)) {\r\n    if (typeof func !== 'undefined') {\r\n      parsers[name] = func;\r\n    } else {\r\n      if (parsers.hasOwnProperty(name)) {\r\n        return parsers[name];\r\n      } else {\r\n        throw Error('SubParser named ' + name + ' not registered!');\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Gets or registers an extension\r\n * @static\r\n * @param {string} name\r\n * @param {object|function=} ext\r\n * @returns {*}\r\n */\r\nshowdown.extension = function (name, ext) {\r\n  'use strict';\r\n\r\n  if (!showdown.helper.isString(name)) {\r\n    throw Error('Extension \\'name\\' must be a string');\r\n  }\r\n\r\n  name = showdown.helper.stdExtName(name);\r\n\r\n  // Getter\r\n  if (showdown.helper.isUndefined(ext)) {\r\n    if (!extensions.hasOwnProperty(name)) {\r\n      throw Error('Extension named ' + name + ' is not registered!');\r\n    }\r\n    return extensions[name];\r\n\r\n    // Setter\r\n  } else {\r\n    // Expand extension if it's wrapped in a function\r\n    if (typeof ext === 'function') {\r\n      ext = ext();\r\n    }\r\n\r\n    // Ensure extension is an array\r\n    if (!showdown.helper.isArray(ext)) {\r\n      ext = [ext];\r\n    }\r\n\r\n    var validExtension = validate(ext, name);\r\n\r\n    if (validExtension.valid) {\r\n      extensions[name] = ext;\r\n    } else {\r\n      throw Error(validExtension.error);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Gets all extensions registered\r\n * @returns {{}}\r\n */\r\nshowdown.getAllExtensions = function () {\r\n  'use strict';\r\n  return extensions;\r\n};\r\n\r\n/**\r\n * Remove an extension\r\n * @param {string} name\r\n */\r\nshowdown.removeExtension = function (name) {\r\n  'use strict';\r\n  delete extensions[name];\r\n};\r\n\r\n/**\r\n * Removes all extensions\r\n */\r\nshowdown.resetExtensions = function () {\r\n  'use strict';\r\n  extensions = {};\r\n};\r\n\r\n/**\r\n * Validate extension\r\n * @param {array} extension\r\n * @param {string} name\r\n * @returns {{valid: boolean, error: string}}\r\n */\r\nfunction validate(extension, name) {\r\n  'use strict';\r\n\r\n  var errMsg = (name) ? 'Error in ' + name + ' extension->' : 'Error in unnamed extension',\r\n    ret = {\r\n      valid: true,\r\n      error: ''\r\n    };\r\n\r\n  if (!showdown.helper.isArray(extension)) {\r\n    extension = [extension];\r\n  }\r\n\r\n  for (var i = 0; i < extension.length; ++i) {\r\n    var baseMsg = errMsg + ' sub-extension ' + i + ': ',\r\n        ext = extension[i];\r\n    if (typeof ext !== 'object') {\r\n      ret.valid = false;\r\n      ret.error = baseMsg + 'must be an object, but ' + typeof ext + ' given';\r\n      return ret;\r\n    }\r\n\r\n    if (!showdown.helper.isString(ext.type)) {\r\n      ret.valid = false;\r\n      ret.error = baseMsg + 'property \"type\" must be a string, but ' + typeof ext.type + ' given';\r\n      return ret;\r\n    }\r\n\r\n    var type = ext.type = ext.type.toLowerCase();\r\n\r\n    // normalize extension type\r\n    if (type === 'language') {\r\n      type = ext.type = 'lang';\r\n    }\r\n\r\n    if (type === 'html') {\r\n      type = ext.type = 'output';\r\n    }\r\n\r\n    if (type !== 'lang' && type !== 'output' && type !== 'listener') {\r\n      ret.valid = false;\r\n      ret.error = baseMsg + 'type ' + type + ' is not recognized. Valid values: \"lang/language\", \"output/html\" or \"listener\"';\r\n      return ret;\r\n    }\r\n\r\n    if (type === 'listener') {\r\n      if (showdown.helper.isUndefined(ext.listeners)) {\r\n        ret.valid = false;\r\n        ret.error = baseMsg + '. Extensions of type \"listener\" must have a property called \"listeners\"';\r\n        return ret;\r\n      }\r\n    } else {\r\n      if (showdown.helper.isUndefined(ext.filter) && showdown.helper.isUndefined(ext.regex)) {\r\n        ret.valid = false;\r\n        ret.error = baseMsg + type + ' extensions must define either a \"regex\" property or a \"filter\" method';\r\n        return ret;\r\n      }\r\n    }\r\n\r\n    if (ext.listeners) {\r\n      if (typeof ext.listeners !== 'object') {\r\n        ret.valid = false;\r\n        ret.error = baseMsg + '\"listeners\" property must be an object but ' + typeof ext.listeners + ' given';\r\n        return ret;\r\n      }\r\n      for (var ln in ext.listeners) {\r\n        if (ext.listeners.hasOwnProperty(ln)) {\r\n          if (typeof ext.listeners[ln] !== 'function') {\r\n            ret.valid = false;\r\n            ret.error = baseMsg + '\"listeners\" property must be an hash of [event name]: [callback]. listeners.' + ln +\r\n              ' must be a function but ' + typeof ext.listeners[ln] + ' given';\r\n            return ret;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (ext.filter) {\r\n      if (typeof ext.filter !== 'function') {\r\n        ret.valid = false;\r\n        ret.error = baseMsg + '\"filter\" must be a function, but ' + typeof ext.filter + ' given';\r\n        return ret;\r\n      }\r\n    } else if (ext.regex) {\r\n      if (showdown.helper.isString(ext.regex)) {\r\n        ext.regex = new RegExp(ext.regex, 'g');\r\n      }\r\n      if (!ext.regex instanceof RegExp) {\r\n        ret.valid = false;\r\n        ret.error = baseMsg + '\"regex\" property must either be a string or a RegExp object, but ' + typeof ext.regex + ' given';\r\n        return ret;\r\n      }\r\n      if (showdown.helper.isUndefined(ext.replace)) {\r\n        ret.valid = false;\r\n        ret.error = baseMsg + '\"regex\" extensions must implement a replace string or function';\r\n        return ret;\r\n      }\r\n    }\r\n  }\r\n  return ret;\r\n}\r\n\r\n/**\r\n * Validate extension\r\n * @param {object} ext\r\n * @returns {boolean}\r\n */\r\nshowdown.validateExtension = function (ext) {\r\n  'use strict';\r\n\r\n  var validateExtension = validate(ext, null);\r\n  if (!validateExtension.valid) {\r\n    console.warn(validateExtension.error);\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\n/**\r\n * showdownjs helper functions\r\n */\r\n\r\nif (!showdown.hasOwnProperty('helper')) {\r\n  showdown.helper = {};\r\n}\r\n\r\n/**\r\n * Check if var is string\r\n * @static\r\n * @param {string} a\r\n * @returns {boolean}\r\n */\r\nshowdown.helper.isString = function isString(a) {\r\n  'use strict';\r\n  return (typeof a === 'string' || a instanceof String);\r\n};\r\n\r\n/**\r\n * Check if var is a function\r\n * @static\r\n * @param {string} a\r\n * @returns {boolean}\r\n */\r\nshowdown.helper.isFunction = function isFunction(a) {\r\n  'use strict';\r\n  var getType = {};\r\n  return a && getType.toString.call(a) === '[object Function]';\r\n};\r\n\r\n/**\r\n * ForEach helper function\r\n * @static\r\n * @param {*} obj\r\n * @param {function} callback\r\n */\r\nshowdown.helper.forEach = function forEach(obj, callback) {\r\n  'use strict';\r\n  if (typeof obj.forEach === 'function') {\r\n    obj.forEach(callback);\r\n  } else {\r\n    for (var i = 0; i < obj.length; i++) {\r\n      callback(obj[i], i, obj);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * isArray helper function\r\n * @static\r\n * @param {*} a\r\n * @returns {boolean}\r\n */\r\nshowdown.helper.isArray = function isArray(a) {\r\n  'use strict';\r\n  return a.constructor === Array;\r\n};\r\n\r\n/**\r\n * Check if value is undefined\r\n * @static\r\n * @param {*} value The value to check.\r\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\r\n */\r\nshowdown.helper.isUndefined = function isUndefined(value) {\r\n  'use strict';\r\n  return typeof value === 'undefined';\r\n};\r\n\r\n/**\r\n * Standardidize extension name\r\n * @static\r\n * @param {string} s extension name\r\n * @returns {string}\r\n */\r\nshowdown.helper.stdExtName = function (s) {\r\n  'use strict';\r\n  return s.replace(/[_-]||\\s/g, '').toLowerCase();\r\n};\r\n\r\nfunction escapeCharactersCallback(wholeMatch, m1) {\r\n  'use strict';\r\n  var charCodeToEscape = m1.charCodeAt(0);\r\n  return '~E' + charCodeToEscape + 'E';\r\n}\r\n\r\n/**\r\n * Callback used to escape characters when passing through String.replace\r\n * @static\r\n * @param {string} wholeMatch\r\n * @param {string} m1\r\n * @returns {string}\r\n */\r\nshowdown.helper.escapeCharactersCallback = escapeCharactersCallback;\r\n\r\n/**\r\n * Escape characters in a string\r\n * @static\r\n * @param {string} text\r\n * @param {string} charsToEscape\r\n * @param {boolean} afterBackslash\r\n * @returns {XML|string|void|*}\r\n */\r\nshowdown.helper.escapeCharacters = function escapeCharacters(text, charsToEscape, afterBackslash) {\r\n  'use strict';\r\n  // First we have to escape the escape characters so that\r\n  // we can build a character class out of them\r\n  var regexString = '([' + charsToEscape.replace(/([\\[\\]\\\\])/g, '\\\\$1') + '])';\r\n\r\n  if (afterBackslash) {\r\n    regexString = '\\\\\\\\' + regexString;\r\n  }\r\n\r\n  var regex = new RegExp(regexString, 'g');\r\n  text = text.replace(regex, escapeCharactersCallback);\r\n\r\n  return text;\r\n};\r\n\r\nvar rgxFindMatchPos = function (str, left, right, flags) {\r\n  'use strict';\r\n  var f = flags || '',\r\n    g = f.indexOf('g') > -1,\r\n    x = new RegExp(left + '|' + right, 'g' + f.replace(/g/g, '')),\r\n    l = new RegExp(left, f.replace(/g/g, '')),\r\n    pos = [],\r\n    t, s, m, start, end;\r\n\r\n  do {\r\n    t = 0;\r\n    while ((m = x.exec(str))) {\r\n      if (l.test(m[0])) {\r\n        if (!(t++)) {\r\n          s = x.lastIndex;\r\n          start = s - m[0].length;\r\n        }\r\n      } else if (t) {\r\n        if (!--t) {\r\n          end = m.index + m[0].length;\r\n          var obj = {\r\n            left: {start: start, end: s},\r\n            match: {start: s, end: m.index},\r\n            right: {start: m.index, end: end},\r\n            wholeMatch: {start: start, end: end}\r\n          };\r\n          pos.push(obj);\r\n          if (!g) {\r\n            return pos;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  } while (t && (x.lastIndex = s));\r\n\r\n  return pos;\r\n};\r\n\r\n/**\r\n * matchRecursiveRegExp\r\n *\r\n * (c) 2007 Steven Levithan <stevenlevithan.com>\r\n * MIT License\r\n *\r\n * Accepts a string to search, a left and right format delimiter\r\n * as regex patterns, and optional regex flags. Returns an array\r\n * of matches, allowing nested instances of left/right delimiters.\r\n * Use the \"g\" flag to return all matches, otherwise only the\r\n * first is returned. Be careful to ensure that the left and\r\n * right format delimiters produce mutually exclusive matches.\r\n * Backreferences are not supported within the right delimiter\r\n * due to how it is internally combined with the left delimiter.\r\n * When matching strings whose format delimiters are unbalanced\r\n * to the left or right, the output is intentionally as a\r\n * conventional regex library with recursion support would\r\n * produce, e.g. \"<<x>\" and \"<x>>\" both produce [\"x\"] when using\r\n * \"<\" and \">\" as the delimiters (both strings contain a single,\r\n * balanced instance of \"<x>\").\r\n *\r\n * examples:\r\n * matchRecursiveRegExp(\"test\", \"\\\\(\", \"\\\\)\")\r\n * returns: []\r\n * matchRecursiveRegExp(\"<t<<e>><s>>t<>\", \"<\", \">\", \"g\")\r\n * returns: [\"t<<e>><s>\", \"\"]\r\n * matchRecursiveRegExp(\"<div id=\\\"x\\\">test</div>\", \"<div\\\\b[^>]*>\", \"</div>\", \"gi\")\r\n * returns: [\"test\"]\r\n */\r\nshowdown.helper.matchRecursiveRegExp = function (str, left, right, flags) {\r\n  'use strict';\r\n\r\n  var matchPos = rgxFindMatchPos (str, left, right, flags),\r\n    results = [];\r\n\r\n  for (var i = 0; i < matchPos.length; ++i) {\r\n    results.push([\r\n      str.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),\r\n      str.slice(matchPos[i].match.start, matchPos[i].match.end),\r\n      str.slice(matchPos[i].left.start, matchPos[i].left.end),\r\n      str.slice(matchPos[i].right.start, matchPos[i].right.end)\r\n    ]);\r\n  }\r\n  return results;\r\n};\r\n\r\n/**\r\n *\r\n * @param {string} str\r\n * @param {string|function} replacement\r\n * @param {string} left\r\n * @param {string} right\r\n * @param {string} flags\r\n * @returns {string}\r\n */\r\nshowdown.helper.replaceRecursiveRegExp = function (str, replacement, left, right, flags) {\r\n  'use strict';\r\n\r\n  if (!showdown.helper.isFunction(replacement)) {\r\n    var repStr = replacement;\r\n    replacement = function () {\r\n      return repStr;\r\n    };\r\n  }\r\n\r\n  var matchPos = rgxFindMatchPos(str, left, right, flags),\r\n      finalStr = str,\r\n      lng = matchPos.length;\r\n\r\n  if (lng > 0) {\r\n    var bits = [];\r\n    if (matchPos[0].wholeMatch.start !== 0) {\r\n      bits.push(str.slice(0, matchPos[0].wholeMatch.start));\r\n    }\r\n    for (var i = 0; i < lng; ++i) {\r\n      bits.push(\r\n        replacement(\r\n          str.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),\r\n          str.slice(matchPos[i].match.start, matchPos[i].match.end),\r\n          str.slice(matchPos[i].left.start, matchPos[i].left.end),\r\n          str.slice(matchPos[i].right.start, matchPos[i].right.end)\r\n        )\r\n      );\r\n      if (i < lng - 1) {\r\n        bits.push(str.slice(matchPos[i].wholeMatch.end, matchPos[i + 1].wholeMatch.start));\r\n      }\r\n    }\r\n    if (matchPos[lng - 1].wholeMatch.end < str.length) {\r\n      bits.push(str.slice(matchPos[lng - 1].wholeMatch.end));\r\n    }\r\n    finalStr = bits.join('');\r\n  }\r\n  return finalStr;\r\n};\r\n\r\n/**\r\n * POLYFILLS\r\n */\r\nif (showdown.helper.isUndefined(console)) {\r\n  console = {\r\n    warn: function (msg) {\r\n      'use strict';\r\n      alert(msg);\r\n    },\r\n    log: function (msg) {\r\n      'use strict';\r\n      alert(msg);\r\n    },\r\n    error: function (msg) {\r\n      'use strict';\r\n      throw msg;\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Created by Estevao on 31-05-2015.\r\n */\r\n\r\n/**\r\n * Showdown Converter class\r\n * @class\r\n * @param {object} [converterOptions]\r\n * @returns {Converter}\r\n */\r\nshowdown.Converter = function (converterOptions) {\r\n  'use strict';\r\n\r\n  var\r\n      /**\r\n       * Options used by this converter\r\n       * @private\r\n       * @type {{}}\r\n       */\r\n      options = {},\r\n\r\n      /**\r\n       * Language extensions used by this converter\r\n       * @private\r\n       * @type {Array}\r\n       */\r\n      langExtensions = [],\r\n\r\n      /**\r\n       * Output modifiers extensions used by this converter\r\n       * @private\r\n       * @type {Array}\r\n       */\r\n      outputModifiers = [],\r\n\r\n      /**\r\n       * Event listeners\r\n       * @private\r\n       * @type {{}}\r\n       */\r\n      listeners = {};\r\n\r\n  _constructor();\r\n\r\n  /**\r\n   * Converter constructor\r\n   * @private\r\n   */\r\n  function _constructor() {\r\n    converterOptions = converterOptions || {};\r\n\r\n    for (var gOpt in globalOptions) {\r\n      if (globalOptions.hasOwnProperty(gOpt)) {\r\n        options[gOpt] = globalOptions[gOpt];\r\n      }\r\n    }\r\n\r\n    // Merge options\r\n    if (typeof converterOptions === 'object') {\r\n      for (var opt in converterOptions) {\r\n        if (converterOptions.hasOwnProperty(opt)) {\r\n          options[opt] = converterOptions[opt];\r\n        }\r\n      }\r\n    } else {\r\n      throw Error('Converter expects the passed parameter to be an object, but ' + typeof converterOptions +\r\n      ' was passed instead.');\r\n    }\r\n\r\n    if (options.extensions) {\r\n      showdown.helper.forEach(options.extensions, _parseExtension);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Parse extension\r\n   * @param {*} ext\r\n   * @param {string} [name='']\r\n   * @private\r\n   */\r\n  function _parseExtension(ext, name) {\r\n\r\n    name = name || null;\r\n    // If it's a string, the extension was previously loaded\r\n    if (showdown.helper.isString(ext)) {\r\n      ext = showdown.helper.stdExtName(ext);\r\n      name = ext;\r\n\r\n      // LEGACY_SUPPORT CODE\r\n      if (showdown.extensions[ext]) {\r\n        console.warn('DEPRECATION WARNING: ' + ext + ' is an old extension that uses a deprecated loading method.' +\r\n          'Please inform the developer that the extension should be updated!');\r\n        legacyExtensionLoading(showdown.extensions[ext], ext);\r\n        return;\r\n      // END LEGACY SUPPORT CODE\r\n\r\n      } else if (!showdown.helper.isUndefined(extensions[ext])) {\r\n        ext = extensions[ext];\r\n\r\n      } else {\r\n        throw Error('Extension \"' + ext + '\" could not be loaded. It was either not found or is not a valid extension.');\r\n      }\r\n    }\r\n\r\n    if (typeof ext === 'function') {\r\n      ext = ext();\r\n    }\r\n\r\n    if (!showdown.helper.isArray(ext)) {\r\n      ext = [ext];\r\n    }\r\n\r\n    var validExt = validate(ext, name);\r\n    if (!validExt.valid) {\r\n      throw Error(validExt.error);\r\n    }\r\n\r\n    for (var i = 0; i < ext.length; ++i) {\r\n      switch (ext[i].type) {\r\n\r\n        case 'lang':\r\n          langExtensions.push(ext[i]);\r\n          break;\r\n\r\n        case 'output':\r\n          outputModifiers.push(ext[i]);\r\n          break;\r\n      }\r\n      if (ext[i].hasOwnProperty(listeners)) {\r\n        for (var ln in ext[i].listeners) {\r\n          if (ext[i].listeners.hasOwnProperty(ln)) {\r\n            listen(ln, ext[i].listeners[ln]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * LEGACY_SUPPORT\r\n   * @param {*} ext\r\n   * @param {string} name\r\n   */\r\n  function legacyExtensionLoading(ext, name) {\r\n    if (typeof ext === 'function') {\r\n      ext = ext(new showdown.Converter());\r\n    }\r\n    if (!showdown.helper.isArray(ext)) {\r\n      ext = [ext];\r\n    }\r\n    var valid = validate(ext, name);\r\n\r\n    if (!valid.valid) {\r\n      throw Error(valid.error);\r\n    }\r\n\r\n    for (var i = 0; i < ext.length; ++i) {\r\n      switch (ext[i].type) {\r\n        case 'lang':\r\n          langExtensions.push(ext[i]);\r\n          break;\r\n        case 'output':\r\n          outputModifiers.push(ext[i]);\r\n          break;\r\n        default:// should never reach here\r\n          throw Error('Extension loader error: Type unrecognized!!!');\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to an event\r\n   * @param {string} name\r\n   * @param {function} callback\r\n   */\r\n  function listen(name, callback) {\r\n    if (!showdown.helper.isString(name)) {\r\n      throw Error('Invalid argument in converter.listen() method: name must be a string, but ' + typeof name + ' given');\r\n    }\r\n\r\n    if (typeof callback !== 'function') {\r\n      throw Error('Invalid argument in converter.listen() method: callback must be a function, but ' + typeof callback + ' given');\r\n    }\r\n\r\n    if (!listeners.hasOwnProperty(name)) {\r\n      listeners[name] = [];\r\n    }\r\n    listeners[name].push(callback);\r\n  }\r\n\r\n  function rTrimInputText(text) {\r\n    var rsp = text.match(/^\\s*/)[0].length,\r\n        rgx = new RegExp('^\\\\s{0,' + rsp + '}', 'gm');\r\n    return text.replace(rgx, '');\r\n  }\r\n\r\n  /**\r\n   * Dispatch an event\r\n   * @private\r\n   * @param {string} evtName Event name\r\n   * @param {string} text Text\r\n   * @param {{}} options Converter Options\r\n   * @param {{}} globals\r\n   * @returns {string}\r\n   */\r\n  this._dispatch = function dispatch (evtName, text, options, globals) {\r\n    if (listeners.hasOwnProperty(evtName)) {\r\n      for (var ei = 0; ei < listeners[evtName].length; ++ei) {\r\n        var nText = listeners[evtName][ei](evtName, text, this, options, globals);\r\n        if (nText && typeof nText !== 'undefined') {\r\n          text = nText;\r\n        }\r\n      }\r\n    }\r\n    return text;\r\n  };\r\n\r\n  /**\r\n   * Listen to an event\r\n   * @param {string} name\r\n   * @param {function} callback\r\n   * @returns {showdown.Converter}\r\n   */\r\n  this.listen = function (name, callback) {\r\n    listen(name, callback);\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Converts a markdown string into HTML\r\n   * @param {string} text\r\n   * @returns {*}\r\n   */\r\n  this.makeHtml = function (text) {\r\n    //check if text is not falsy\r\n    if (!text) {\r\n      return text;\r\n    }\r\n\r\n    var globals = {\r\n      gHtmlBlocks:     [],\r\n      gHtmlMdBlocks:   [],\r\n      gHtmlSpans:      [],\r\n      gUrls:           {},\r\n      gTitles:         {},\r\n      gDimensions:     {},\r\n      gListLevel:      0,\r\n      hashLinkCounts:  {},\r\n      langExtensions:  langExtensions,\r\n      outputModifiers: outputModifiers,\r\n      converter:       this,\r\n      ghCodeBlocks:    []\r\n    };\r\n\r\n    // attacklab: Replace ~ with ~T\r\n    // This lets us use tilde as an escape char to avoid md5 hashes\r\n    // The choice of character is arbitrary; anything that isn't\r\n    // magic in Markdown will work.\r\n    text = text.replace(/~/g, '~T');\r\n\r\n    // attacklab: Replace $ with ~D\r\n    // RegExp interprets $ as a special character\r\n    // when it's in a replacement string\r\n    text = text.replace(/\\$/g, '~D');\r\n\r\n    // Standardize line endings\r\n    text = text.replace(/\\r\\n/g, '\\n'); // DOS to Unix\r\n    text = text.replace(/\\r/g, '\\n'); // Mac to Unix\r\n\r\n    if (options.smartIndentationFix) {\r\n      text = rTrimInputText(text);\r\n    }\r\n\r\n    // Make sure text begins and ends with a couple of newlines:\r\n    //text = '\\n\\n' + text + '\\n\\n';\r\n    text = text;\r\n    // detab\r\n    text = showdown.subParser('detab')(text, options, globals);\r\n\r\n    // stripBlankLines\r\n    text = showdown.subParser('stripBlankLines')(text, options, globals);\r\n\r\n    //run languageExtensions\r\n    showdown.helper.forEach(langExtensions, function (ext) {\r\n      text = showdown.subParser('runExtension')(ext, text, options, globals);\r\n    });\r\n\r\n    // run the sub parsers\r\n    text = showdown.subParser('hashPreCodeTags')(text, options, globals);\r\n    text = showdown.subParser('githubCodeBlocks')(text, options, globals);\r\n    text = showdown.subParser('hashHTMLBlocks')(text, options, globals);\r\n    text = showdown.subParser('hashHTMLSpans')(text, options, globals);\r\n    text = showdown.subParser('stripLinkDefinitions')(text, options, globals);\r\n    text = showdown.subParser('blockGamut')(text, options, globals);\r\n    text = showdown.subParser('unhashHTMLSpans')(text, options, globals);\r\n    text = showdown.subParser('unescapeSpecialChars')(text, options, globals);\r\n\r\n    // attacklab: Restore dollar signs\r\n    text = text.replace(/~D/g, '$$');\r\n\r\n    // attacklab: Restore tildes\r\n    text = text.replace(/~T/g, '~');\r\n\r\n    // Run output modifiers\r\n    showdown.helper.forEach(outputModifiers, function (ext) {\r\n      text = showdown.subParser('runExtension')(ext, text, options, globals);\r\n    });\r\n    return text;\r\n  };\r\n\r\n  /**\r\n   * Set an option of this Converter instance\r\n   * @param {string} key\r\n   * @param {*} value\r\n   */\r\n  this.setOption = function (key, value) {\r\n    options[key] = value;\r\n  };\r\n\r\n  /**\r\n   * Get the option of this Converter instance\r\n   * @param {string} key\r\n   * @returns {*}\r\n   */\r\n  this.getOption = function (key) {\r\n    return options[key];\r\n  };\r\n\r\n  /**\r\n   * Get the options of this Converter instance\r\n   * @returns {{}}\r\n   */\r\n  this.getOptions = function () {\r\n    return options;\r\n  };\r\n\r\n  /**\r\n   * Add extension to THIS converter\r\n   * @param {{}} extension\r\n   * @param {string} [name=null]\r\n   */\r\n  this.addExtension = function (extension, name) {\r\n    name = name || null;\r\n    _parseExtension(extension, name);\r\n  };\r\n\r\n  /**\r\n   * Use a global registered extension with THIS converter\r\n   * @param {string} extensionName Name of the previously registered extension\r\n   */\r\n  this.useExtension = function (extensionName) {\r\n    _parseExtension(extensionName);\r\n  };\r\n\r\n  /**\r\n   * Set the flavor THIS converter should use\r\n   * @param {string} name\r\n   */\r\n  this.setFlavor = function (name) {\r\n    if (flavor.hasOwnProperty(name)) {\r\n      var preset = flavor[name];\r\n      for (var option in preset) {\r\n        if (preset.hasOwnProperty(option)) {\r\n          options[option] = preset[option];\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Remove an extension from THIS converter.\r\n   * Note: This is a costly operation. It's better to initialize a new converter\r\n   * and specify the extensions you wish to use\r\n   * @param {Array} extension\r\n   */\r\n  this.removeExtension = function (extension) {\r\n    if (!showdown.helper.isArray(extension)) {\r\n      extension = [extension];\r\n    }\r\n    for (var a = 0; a < extension.length; ++a) {\r\n      var ext = extension[a];\r\n      for (var i = 0; i < langExtensions.length; ++i) {\r\n        if (langExtensions[i] === ext) {\r\n          langExtensions[i].splice(i, 1);\r\n        }\r\n      }\r\n      for (var ii = 0; ii < outputModifiers.length; ++i) {\r\n        if (outputModifiers[ii] === ext) {\r\n          outputModifiers[ii].splice(i, 1);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get all extension of THIS converter\r\n   * @returns {{language: Array, output: Array}}\r\n   */\r\n  this.getAllExtensions = function () {\r\n    return {\r\n      language: langExtensions,\r\n      output: outputModifiers\r\n    };\r\n  };\r\n};\r\n\r\n/**\r\n * Turn Markdown link shortcuts into XHTML <a> tags.\r\n */\r\nshowdown.subParser('anchors', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('anchors.before', text, options, globals);\r\n\r\n  var writeAnchorTag = function (wholeMatch, m1, m2, m3, m4, m5, m6, m7) {\r\n    if (showdown.helper.isUndefined(m7)) {\r\n      m7 = '';\r\n    }\r\n    wholeMatch = m1;\r\n    var linkText = m2,\r\n        linkId = m3.toLowerCase(),\r\n        url = m4,\r\n        title = m7;\r\n\r\n    if (!url) {\r\n      if (!linkId) {\r\n        // lower-case and turn embedded newlines into spaces\r\n        linkId = linkText.toLowerCase().replace(/ ?\\n/g, ' ');\r\n      }\r\n      url = '#' + linkId;\r\n\r\n      if (!showdown.helper.isUndefined(globals.gUrls[linkId])) {\r\n        url = globals.gUrls[linkId];\r\n        if (!showdown.helper.isUndefined(globals.gTitles[linkId])) {\r\n          title = globals.gTitles[linkId];\r\n        }\r\n      } else {\r\n        if (wholeMatch.search(/\\(\\s*\\)$/m) > -1) {\r\n          // Special case for explicit empty url\r\n          url = '';\r\n        } else {\r\n          return wholeMatch;\r\n        }\r\n      }\r\n    }\r\n\r\n    url = showdown.helper.escapeCharacters(url, '*_', false);\r\n    var result = '<a href=\"' + url + '\"';\r\n\r\n    if (title !== '' && title !== null) {\r\n      title = title.replace(/\"/g, '&quot;');\r\n      title = showdown.helper.escapeCharacters(title, '*_', false);\r\n      result += ' title=\"' + title + '\"';\r\n    }\r\n\r\n    result += '>' + linkText + '</a>';\r\n\r\n    return result;\r\n  };\r\n\r\n  // First, handle reference-style links: [link text] [id]\r\n  /*\r\n   text = text.replace(/\r\n   (\t\t\t\t\t\t\t// wrap whole match in $1\r\n   \\[\r\n   (\r\n   (?:\r\n   \\[[^\\]]*\\]\t\t// allow brackets nested one level\r\n   |\r\n   [^\\[]\t\t\t// or anything else\r\n   )*\r\n   )\r\n   \\]\r\n\r\n   [ ]?\t\t\t\t\t// one optional space\r\n   (?:\\n[ ]*)?\t\t\t\t// one optional newline followed by spaces\r\n\r\n   \\[\r\n   (.*?)\t\t\t\t\t// id = $3\r\n   \\]\r\n   )()()()()\t\t\t\t\t// pad remaining backreferences\r\n   /g,_DoAnchors_callback);\r\n   */\r\n  text = text.replace(/(\\[((?:\\[[^\\]]*]|[^\\[\\]])*)][ ]?(?:\\n[ ]*)?\\[(.*?)])()()()()/g, writeAnchorTag);\r\n\r\n  //\r\n  // Next, inline-style links: [link text](url \"optional title\")\r\n  //\r\n\r\n  /*\r\n   text = text.replace(/\r\n   (\t\t\t\t\t\t// wrap whole match in $1\r\n   \\[\r\n   (\r\n   (?:\r\n   \\[[^\\]]*\\]\t// allow brackets nested one level\r\n   |\r\n   [^\\[\\]]\t\t\t// or anything else\r\n   )\r\n   )\r\n   \\]\r\n   \\(\t\t\t\t\t\t// literal paren\r\n   [ \\t]*\r\n   ()\t\t\t\t\t\t// no id, so leave $3 empty\r\n   <?(.*?)>?\t\t\t\t// href = $4\r\n   [ \\t]*\r\n   (\t\t\t\t\t\t// $5\r\n   (['\"])\t\t\t\t// quote char = $6\r\n   (.*?)\t\t\t\t// Title = $7\r\n   \\6\t\t\t\t\t// matching quote\r\n   [ \\t]*\t\t\t\t// ignore any spaces/tabs between closing quote and )\r\n   )?\t\t\t\t\t\t// title is optional\r\n   \\)\r\n   )\r\n   /g,writeAnchorTag);\r\n   */\r\n  text = text.replace(/(\\[((?:\\[[^\\]]*]|[^\\[\\]])*)]\\([ \\t]*()<?(.*?(?:\\(.*?\\).*?)?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,\r\n                      writeAnchorTag);\r\n\r\n  //\r\n  // Last, handle reference-style shortcuts: [link text]\r\n  // These must come last in case you've also got [link test][1]\r\n  // or [link test](/foo)\r\n  //\r\n\r\n  /*\r\n   text = text.replace(/\r\n   (                // wrap whole match in $1\r\n   \\[\r\n   ([^\\[\\]]+)       // link text = $2; can't contain '[' or ']'\r\n   \\]\r\n   )()()()()()      // pad rest of backreferences\r\n   /g, writeAnchorTag);\r\n   */\r\n  text = text.replace(/(\\[([^\\[\\]]+)])()()()()()/g, writeAnchorTag);\r\n\r\n  text = globals.converter._dispatch('anchors.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\nshowdown.subParser('autoLinks', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('autoLinks.before', text, options, globals);\r\n\r\n  var simpleURLRegex  = /\\b(((https?|ftp|dict):\\/\\/|www\\.)[^'\">\\s]+\\.[^'\">\\s]+)(?=\\s|$)(?![\"<>])/gi,\r\n      delimUrlRegex   = /<(((https?|ftp|dict):\\/\\/|www\\.)[^'\">\\s]+)>/gi,\r\n      simpleMailRegex = /(?:^|[ \\n\\t])([A-Za-z0-9!#$%&'*+-/=?^_`\\{|}~\\.]+@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)(?:$|[ \\n\\t])/gi,\r\n      delimMailRegex  = /<(?:mailto:)?([-.\\w]+@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi;\r\n\r\n  text = text.replace(delimUrlRegex, replaceLink);\r\n  text = text.replace(delimMailRegex, replaceMail);\r\n  // simpleURLRegex  = /\\b(((https?|ftp|dict):\\/\\/|www\\.)[-.+~:?#@!$&'()*,;=[\\]\\w]+)\\b/gi,\r\n  // Email addresses: <address@domain.foo>\r\n\r\n  if (options.simplifiedAutoLink) {\r\n    text = text.replace(simpleURLRegex, replaceLink);\r\n    text = text.replace(simpleMailRegex, replaceMail);\r\n  }\r\n\r\n  function replaceLink(wm, link) {\r\n    var lnkTxt = link;\r\n    if (/^www\\./i.test(link)) {\r\n      link = link.replace(/^www\\./i, 'http://www.');\r\n    }\r\n    return '<a href=\"' + link + '\">' + lnkTxt + '</a>';\r\n  }\r\n\r\n  function replaceMail(wholeMatch, m1) {\r\n    var unescapedStr = showdown.subParser('unescapeSpecialChars')(m1);\r\n    return showdown.subParser('encodeEmailAddress')(unescapedStr);\r\n  }\r\n\r\n  text = globals.converter._dispatch('autoLinks.after', text, options, globals);\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * These are all the transformations that form block-level\r\n * tags like paragraphs, headers, and list items.\r\n */\r\nshowdown.subParser('blockGamut', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('blockGamut.before', text, options, globals);\r\n\r\n  // we parse blockquotes first so that we can have headings and hrs\r\n  // inside blockquotes\r\n  text = showdown.subParser('blockQuotes')(text, options, globals);\r\n  text = showdown.subParser('headers')(text, options, globals);\r\n\r\n  // Do Horizontal Rules:\r\n  var key = showdown.subParser('hashBlock')('<hr />', options, globals);\r\n  text = text.replace(/^[ ]{0,2}([ ]?\\*[ ]?){3,}[ \\t]*$/gm, key);\r\n  text = text.replace(/^[ ]{0,2}([ ]?\\-[ ]?){3,}[ \\t]*$/gm, key);\r\n  text = text.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \\t]*$/gm, key);\r\n\r\n  text = showdown.subParser('lists')(text, options, globals);\r\n  text = showdown.subParser('codeBlocks')(text, options, globals);\r\n  text = showdown.subParser('tables')(text, options, globals);\r\n\r\n  // We already ran _HashHTMLBlocks() before, in Markdown(), but that\r\n  // was to escape raw HTML in the original Markdown source. This time,\r\n  // we're escaping the markup we've just created, so that we don't wrap\r\n  // <p> tags around block-level tags.\r\n  text = showdown.subParser('hashHTMLBlocks')(text, options, globals);\r\n  text = showdown.subParser('paragraphs')(text, options, globals);\r\n\r\n  text = globals.converter._dispatch('blockGamut.after', text, options, globals);\r\n\r\n  return text;\r\n});\r\n\r\nshowdown.subParser('blockQuotes', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('blockQuotes.before', text, options, globals);\r\n  /*\r\n   text = text.replace(/\r\n   (\t\t\t\t\t\t\t\t// Wrap whole match in $1\r\n   (\r\n   ^[ \\t]*>[ \\t]?\t\t\t// '>' at the start of a line\r\n   .+\\n\t\t\t\t\t// rest of the first line\r\n   (.+\\n)*\t\t\t\t\t// subsequent consecutive lines\r\n   \\n*\t\t\t\t\t\t// blanks\r\n   )+\r\n   )\r\n   /gm, function(){...});\r\n   */\r\n\r\n  text = text.replace(/((^[ \\t]{0,3}>[ \\t]?.+\\n(.+\\n)*\\n*)+)/gm, function (wholeMatch, m1) {\r\n    var bq = m1;\r\n\r\n    // attacklab: hack around Konqueror 3.5.4 bug:\r\n    // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\r\n    bq = bq.replace(/^[ \\t]*>[ \\t]?/gm, '~0'); // trim one level of quoting\r\n\r\n    // attacklab: clean up hack\r\n    bq = bq.replace(/~0/g, '');\r\n\r\n    bq = bq.replace(/^[ \\t]+$/gm, ''); // trim whitespace-only lines\r\n    bq = showdown.subParser('githubCodeBlocks')(bq, options, globals);\r\n    bq = showdown.subParser('blockGamut')(bq, options, globals); // recurse\r\n\r\n    bq = bq.replace(/(^|\\n)/g, '$1  ');\r\n    // These leading spaces screw with <pre> content, so we need to fix that:\r\n    bq = bq.replace(/(\\s*<pre>[^\\r]+?<\\/pre>)/gm, function (wholeMatch, m1) {\r\n      var pre = m1;\r\n      // attacklab: hack around Konqueror 3.5.4 bug:\r\n      pre = pre.replace(/^  /mg, '~0');\r\n      pre = pre.replace(/~0/g, '');\r\n      return pre;\r\n    });\r\n\r\n    return showdown.subParser('hashBlock')('<blockquote>\\n' + bq + '\\n</blockquote>', options, globals);\r\n  });\r\n\r\n  text = globals.converter._dispatch('blockQuotes.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\n/**\r\n * Process Markdown `<pre><code>` blocks.\r\n */\r\nshowdown.subParser('codeBlocks', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('codeBlocks.before', text, options, globals);\r\n  /*\r\n   text = text.replace(text,\r\n   /(?:\\n\\n|^)\r\n   (\t\t\t\t\t\t\t\t// $1 = the code block -- one or more lines, starting with a space/tab\r\n   (?:\r\n   (?:[ ]{4}|\\t)\t\t\t// Lines must start with a tab or a tab-width of spaces - attacklab: g_tab_width\r\n   .*\\n+\r\n   )+\r\n   )\r\n   (\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))\t// attacklab: g_tab_width\r\n   /g,function(){...});\r\n   */\r\n\r\n  // attacklab: sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\r\n  text += '~0';\r\n\r\n  var pattern = /(?:\\n\\n|^)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))/g;\r\n  text = text.replace(pattern, function (wholeMatch, m1, m2) {\r\n    var codeblock = m1,\r\n        nextChar = m2,\r\n        end = '\\n';\r\n\r\n    codeblock = showdown.subParser('outdent')(codeblock);\r\n    codeblock = showdown.subParser('encodeCode')(codeblock);\r\n    codeblock = showdown.subParser('detab')(codeblock);\r\n    codeblock = codeblock.replace(/^\\n+/g, ''); // trim leading newlines\r\n    codeblock = codeblock.replace(/\\n+$/g, ''); // trim trailing newlines\r\n\r\n    if (options.omitExtraWLInCodeBlocks) {\r\n      end = '';\r\n    }\r\n\r\n    codeblock = '<pre><code>' + codeblock + end + '</code></pre>';\r\n\r\n    return showdown.subParser('hashBlock')(codeblock, options, globals) + nextChar;\r\n  });\r\n\r\n  // attacklab: strip sentinel\r\n  text = text.replace(/~0/, '');\r\n\r\n  text = globals.converter._dispatch('codeBlocks.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\n/**\r\n *\r\n *   *  Backtick quotes are used for <code></code> spans.\r\n *\r\n *   *  You can use multiple backticks as the delimiters if you want to\r\n *     include literal backticks in the code span. So, this input:\r\n *\r\n *         Just type ``foo `bar` baz`` at the prompt.\r\n *\r\n *       Will translate to:\r\n *\r\n *         <p>Just type <code>foo `bar` baz</code> at the prompt.</p>\r\n *\r\n *    There's no arbitrary limit to the number of backticks you\r\n *    can use as delimters. If you need three consecutive backticks\r\n *    in your code, use four for delimiters, etc.\r\n *\r\n *  *  You can use spaces to get literal backticks at the edges:\r\n *\r\n *         ... type `` `bar` `` ...\r\n *\r\n *       Turns to:\r\n *\r\n *         ... type <code>`bar`</code> ...\r\n */\r\nshowdown.subParser('codeSpans', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('codeSpans.before', text, options, globals);\r\n\r\n  /*\r\n   text = text.replace(/\r\n   (^|[^\\\\])\t\t\t\t\t// Character before opening ` can't be a backslash\r\n   (`+)\t\t\t\t\t\t// $2 = Opening run of `\r\n   (\t\t\t\t\t\t\t// $3 = The code block\r\n   [^\\r]*?\r\n   [^`]\t\t\t\t\t// attacklab: work around lack of lookbehind\r\n   )\r\n   \\2\t\t\t\t\t\t\t// Matching closer\r\n   (?!`)\r\n   /gm, function(){...});\r\n   */\r\n\r\n  if (typeof(text) === 'undefined') {\r\n    text = '';\r\n  }\r\n  text = text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,\r\n    function (wholeMatch, m1, m2, m3) {\r\n      var c = m3;\r\n      c = c.replace(/^([ \\t]*)/g, '');\t// leading whitespace\r\n      c = c.replace(/[ \\t]*$/g, '');\t// trailing whitespace\r\n      c = showdown.subParser('encodeCode')(c);\r\n      return m1 + '<code>' + c + '</code>';\r\n    }\r\n  );\r\n\r\n  text = globals.converter._dispatch('codeSpans.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\n/**\r\n * Convert all tabs to spaces\r\n */\r\nshowdown.subParser('detab', function (text) {\r\n  'use strict';\r\n\r\n  // expand first n-1 tabs\r\n  text = text.replace(/\\t(?=\\t)/g, '    '); // g_tab_width\r\n\r\n  // replace the nth with two sentinels\r\n  text = text.replace(/\\t/g, '~A~B');\r\n\r\n  // use the sentinel to anchor our regex so it doesn't explode\r\n  text = text.replace(/~B(.+?)~A/g, function (wholeMatch, m1) {\r\n    var leadingText = m1,\r\n        numSpaces = 4 - leadingText.length % 4;  // g_tab_width\r\n\r\n    // there *must* be a better way to do this:\r\n    for (var i = 0; i < numSpaces; i++) {\r\n      leadingText += ' ';\r\n    }\r\n\r\n    return leadingText;\r\n  });\r\n\r\n  // clean up sentinels\r\n  text = text.replace(/~A/g, '    ');  // g_tab_width\r\n  text = text.replace(/~B/g, '');\r\n\r\n  return text;\r\n\r\n});\r\n\r\n/**\r\n * Smart processing for ampersands and angle brackets that need to be encoded.\r\n */\r\nshowdown.subParser('encodeAmpsAndAngles', function (text) {\r\n  'use strict';\r\n  // Ampersand-encoding based entirely on Nat Irons's Amputator MT plugin:\r\n  // http://bumppo.net/projects/amputator/\r\n  text = text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g, '&amp;');\r\n\r\n  // Encode naked <'s\r\n  text = text.replace(/<(?![a-z\\/?\\$!])/gi, '&lt;');\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * Returns the string, with after processing the following backslash escape sequences.\r\n *\r\n * attacklab: The polite way to do this is with the new escapeCharacters() function:\r\n *\r\n *    text = escapeCharacters(text,\"\\\\\",true);\r\n *    text = escapeCharacters(text,\"`*_{}[]()>#+-.!\",true);\r\n *\r\n * ...but we're sidestepping its use of the (slow) RegExp constructor\r\n * as an optimization for Firefox.  This function gets called a LOT.\r\n */\r\nshowdown.subParser('encodeBackslashEscapes', function (text) {\r\n  'use strict';\r\n  text = text.replace(/\\\\(\\\\)/g, showdown.helper.escapeCharactersCallback);\r\n  text = text.replace(/\\\\([`*_{}\\[\\]()>#+-.!])/g, showdown.helper.escapeCharactersCallback);\r\n  return text;\r\n});\r\n\r\n/**\r\n * Encode/escape certain characters inside Markdown code runs.\r\n * The point is that in code, these characters are literals,\r\n * and lose their special Markdown meanings.\r\n */\r\nshowdown.subParser('encodeCode', function (text) {\r\n  'use strict';\r\n\r\n  // Encode all ampersands; HTML entities are not\r\n  // entities within a Markdown code span.\r\n  text = text.replace(/&/g, '&amp;');\r\n\r\n  // Do the angle bracket song and dance:\r\n  text = text.replace(/</g, '&lt;');\r\n  text = text.replace(/>/g, '&gt;');\r\n\r\n  // Now, escape characters that are magic in Markdown:\r\n  text = showdown.helper.escapeCharacters(text, '*_{}[]\\\\', false);\r\n\r\n  // jj the line above breaks this:\r\n  //---\r\n  //* Item\r\n  //   1. Subitem\r\n  //            special char: *\r\n  // ---\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n *  Input: an email address, e.g. \"foo@example.com\"\r\n *\r\n *  Output: the email address as a mailto link, with each character\r\n *    of the address encoded as either a decimal or hex entity, in\r\n *    the hopes of foiling most address harvesting spam bots. E.g.:\r\n *\r\n *    <a href=\"&#x6D;&#97;&#105;&#108;&#x74;&#111;:&#102;&#111;&#111;&#64;&#101;\r\n *       x&#x61;&#109;&#x70;&#108;&#x65;&#x2E;&#99;&#111;&#109;\">&#102;&#111;&#111;\r\n *       &#64;&#101;x&#x61;&#109;&#x70;&#108;&#x65;&#x2E;&#99;&#111;&#109;</a>\r\n *\r\n *  Based on a filter by Matthew Wickline, posted to the BBEdit-Talk\r\n *  mailing list: <http://tinyurl.com/yu7ue>\r\n *\r\n */\r\nshowdown.subParser('encodeEmailAddress', function (addr) {\r\n  'use strict';\r\n\r\n  var encode = [\r\n    function (ch) {\r\n      return '&#' + ch.charCodeAt(0) + ';';\r\n    },\r\n    function (ch) {\r\n      return '&#x' + ch.charCodeAt(0).toString(16) + ';';\r\n    },\r\n    function (ch) {\r\n      return ch;\r\n    }\r\n  ];\r\n\r\n  addr = 'mailto:' + addr;\r\n\r\n  addr = addr.replace(/./g, function (ch) {\r\n    if (ch === '@') {\r\n      // this *must* be encoded. I insist.\r\n      ch = encode[Math.floor(Math.random() * 2)](ch);\r\n    } else if (ch !== ':') {\r\n      // leave ':' alone (to spot mailto: later)\r\n      var r = Math.random();\r\n      // roughly 10% raw, 45% hex, 45% dec\r\n      ch = (\r\n        r > 0.9 ? encode[2](ch) : r > 0.45 ? encode[1](ch) : encode[0](ch)\r\n      );\r\n    }\r\n    return ch;\r\n  });\r\n\r\n  addr = '<a href=\"' + addr + '\">' + addr + '</a>';\r\n  addr = addr.replace(/\">.+:/g, '\">'); // strip the mailto: from the visible part\r\n\r\n  return addr;\r\n});\r\n\r\n/**\r\n * Within tags -- meaning between < and > -- encode [\\ ` * _] so they\r\n * don't conflict with their use in Markdown for code, italics and strong.\r\n */\r\nshowdown.subParser('escapeSpecialCharsWithinTagAttributes', function (text) {\r\n  'use strict';\r\n\r\n  // Build a regex to find HTML tags and comments.  See Friedl's\r\n  // \"Mastering Regular Expressions\", 2nd Ed., pp. 200-201.\r\n  var regex = /(<[a-z\\/!$](\"[^\"]*\"|'[^']*'|[^'\">])*>|<!(--.*?--\\s*)+>)/gi;\r\n\r\n  text = text.replace(regex, function (wholeMatch) {\r\n    var tag = wholeMatch.replace(/(.)<\\/?code>(?=.)/g, '$1`');\r\n    tag = showdown.helper.escapeCharacters(tag, '\\\\`*_', false);\r\n    return tag;\r\n  });\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * Handle github codeblocks prior to running HashHTML so that\r\n * HTML contained within the codeblock gets escaped properly\r\n * Example:\r\n * ```ruby\r\n *     def hello_world(x)\r\n *       puts \"Hello, #{x}\"\r\n *     end\r\n * ```\r\n */\r\nshowdown.subParser('githubCodeBlocks', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  // early exit if option is not enabled\r\n  if (!options.ghCodeBlocks) {\r\n    return text;\r\n  }\r\n\r\n  text = globals.converter._dispatch('githubCodeBlocks.before', text, options, globals);\r\n\r\n  text += '~0';\r\n\r\n  text = text.replace(/(?:^|\\n)```(.*)\\n([\\s\\S]*?)\\n```/g, function (wholeMatch, language, codeblock) {\r\n    var end = (options.omitExtraWLInCodeBlocks) ? '' : '\\n';\r\n\r\n    // First parse the github code block\r\n    codeblock = showdown.subParser('encodeCode')(codeblock);\r\n    codeblock = showdown.subParser('detab')(codeblock);\r\n    codeblock = codeblock.replace(/^\\n+/g, ''); // trim leading newlines\r\n    codeblock = codeblock.replace(/\\n+$/g, ''); // trim trailing whitespace\r\n\r\n    codeblock = '<pre><code' + (language ? ' class=\"' + language + ' language-' + language + '\"' : '') + '>' + codeblock + end + '</code></pre>';\r\n\r\n    codeblock = showdown.subParser('hashBlock')(codeblock, options, globals);\r\n\r\n    // Since GHCodeblocks can be false positives, we need to\r\n    // store the primitive text and the parsed text in a global var,\r\n    // and then return a token\r\n    return '\\n\\n~G' + (globals.ghCodeBlocks.push({text: wholeMatch, codeblock: codeblock}) - 1) + 'G\\n\\n';\r\n  });\r\n\r\n  // attacklab: strip sentinel\r\n  text = text.replace(/~0/, '');\r\n\r\n  return globals.converter._dispatch('githubCodeBlocks.after', text, options, globals);\r\n});\r\n\r\nshowdown.subParser('hashBlock', function (text, options, globals) {\r\n  'use strict';\r\n  text = text.replace(/(^\\n+|\\n+$)/g, '');\r\n  return '\\n\\n~K' + (globals.gHtmlBlocks.push(text) - 1) + 'K\\n\\n';\r\n});\r\n\r\nshowdown.subParser('hashElement', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  return function (wholeMatch, m1) {\r\n    var blockText = m1;\r\n\r\n    // Undo double lines\r\n    blockText = blockText.replace(/\\n\\n/g, '\\n');\r\n    blockText = blockText.replace(/^\\n/, '');\r\n\r\n    // strip trailing blank lines\r\n    blockText = blockText.replace(/\\n+$/g, '');\r\n\r\n    // Replace the element text with a marker (\"~KxK\" where x is its key)\r\n    blockText = '\\n\\n~K' + (globals.gHtmlBlocks.push(blockText) - 1) + 'K\\n\\n';\r\n\r\n    return blockText;\r\n  };\r\n});\r\n\r\nshowdown.subParser('hashHTMLBlocks', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  var blockTags = [\r\n      'pre',\r\n      'div',\r\n      'h1',\r\n      'h2',\r\n      'h3',\r\n      'h4',\r\n      'h5',\r\n      'h6',\r\n      'blockquote',\r\n      'table',\r\n      'dl',\r\n      'ol',\r\n      'ul',\r\n      'script',\r\n      'noscript',\r\n      'form',\r\n      'fieldset',\r\n      'iframe',\r\n      'math',\r\n      'style',\r\n      'section',\r\n      'header',\r\n      'footer',\r\n      'nav',\r\n      'article',\r\n      'aside',\r\n      'address',\r\n      'audio',\r\n      'canvas',\r\n      'figure',\r\n      'hgroup',\r\n      'output',\r\n      'video',\r\n      'p'\r\n    ],\r\n    repFunc = function (wholeMatch, match, left, right) {\r\n      var txt = wholeMatch;\r\n      // check if this html element is marked as markdown\r\n      // if so, it's contents should be parsed as markdown\r\n      if (left.search(/\\bmarkdown\\b/) !== -1) {\r\n        txt = left + globals.converter.makeHtml(match) + right;\r\n      }\r\n      return '\\n\\n~K' + (globals.gHtmlBlocks.push(txt) - 1) + 'K\\n\\n';\r\n    };\r\n\r\n  for (var i = 0; i < blockTags.length; ++i) {\r\n    text = showdown.helper.replaceRecursiveRegExp(text, repFunc, '^(?: |\\\\t){0,3}<' + blockTags[i] + '\\\\b[^>]*>', '</' + blockTags[i] + '>', 'gim');\r\n  }\r\n\r\n  // HR SPECIAL CASE\r\n  text = text.replace(/(\\n[ ]{0,3}(<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g,\r\n    showdown.subParser('hashElement')(text, options, globals));\r\n\r\n  // Special case for standalone HTML comments:\r\n  text = text.replace(/(<!--[\\s\\S]*?-->)/g,\r\n    showdown.subParser('hashElement')(text, options, globals));\r\n\r\n  // PHP and ASP-style processor instructions (<?...?> and <%...%>)\r\n  text = text.replace(/(?:\\n\\n)([ ]{0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g,\r\n    showdown.subParser('hashElement')(text, options, globals));\r\n  return text;\r\n});\r\n\r\n/**\r\n * Hash span elements that should not be parsed as markdown\r\n */\r\nshowdown.subParser('hashHTMLSpans', function (text, config, globals) {\r\n  'use strict';\r\n\r\n  var matches = showdown.helper.matchRecursiveRegExp(text, '<code\\\\b[^>]*>', '</code>', 'gi');\r\n\r\n  for (var i = 0; i < matches.length; ++i) {\r\n    text = text.replace(matches[i][0], '~L' + (globals.gHtmlSpans.push(matches[i][0]) - 1) + 'L');\r\n  }\r\n  return text;\r\n});\r\n\r\n/**\r\n * Unhash HTML spans\r\n */\r\nshowdown.subParser('unhashHTMLSpans', function (text, config, globals) {\r\n  'use strict';\r\n\r\n  for (var i = 0; i < globals.gHtmlSpans.length; ++i) {\r\n    text = text.replace('~L' + i + 'L', globals.gHtmlSpans[i]);\r\n  }\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * Hash span elements that should not be parsed as markdown\r\n */\r\nshowdown.subParser('hashPreCodeTags', function (text, config, globals) {\r\n  'use strict';\r\n\r\n  var repFunc = function (wholeMatch, match, left, right) {\r\n    // encode html entities\r\n    var codeblock = left + showdown.subParser('encodeCode')(match) + right;\r\n    return '\\n\\n~G' + (globals.ghCodeBlocks.push({text: wholeMatch, codeblock: codeblock}) - 1) + 'G\\n\\n';\r\n  };\r\n\r\n  text = showdown.helper.replaceRecursiveRegExp(text, repFunc, '^(?: |\\\\t){0,3}<pre\\\\b[^>]*>\\\\s*<code\\\\b[^>]*>', '^(?: |\\\\t){0,3}</code>\\\\s*</pre>', 'gim');\r\n  return text;\r\n});\r\n\r\nshowdown.subParser('headers', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('headers.before', text, options, globals);\r\n\r\n  var prefixHeader = options.prefixHeaderId,\r\n      headerLevelStart = (isNaN(parseInt(options.headerLevelStart))) ? 1 : parseInt(options.headerLevelStart),\r\n\r\n  // Set text-style headers:\r\n  //\tHeader 1\r\n  //\t========\r\n  //\r\n  //\tHeader 2\r\n  //\t--------\r\n  //\r\n      setextRegexH1 = (options.smoothLivePreview) ? /^(.+)[ \\t]*\\n={2,}[ \\t]*\\n+/gm : /^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,\r\n      setextRegexH2 = (options.smoothLivePreview) ? /^(.+)[ \\t]*\\n-{2,}[ \\t]*\\n+/gm : /^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm;\r\n\r\n  text = text.replace(setextRegexH1, function (wholeMatch, m1) {\r\n\r\n    var spanGamut = showdown.subParser('spanGamut')(m1, options, globals),\r\n        hID = (options.noHeaderId) ? '' : ' id=\"' + headerId(m1) + '\"',\r\n        hLevel = headerLevelStart,\r\n        hashBlock = '<h' + hLevel + hID + '>' + spanGamut + '</h' + hLevel + '>';\r\n    return showdown.subParser('hashBlock')(hashBlock, options, globals);\r\n  });\r\n\r\n  text = text.replace(setextRegexH2, function (matchFound, m1) {\r\n    var spanGamut = showdown.subParser('spanGamut')(m1, options, globals),\r\n        hID = (options.noHeaderId) ? '' : ' id=\"' + headerId(m1) + '\"',\r\n        hLevel = headerLevelStart + 1,\r\n      hashBlock = '<h' + hLevel + hID + '>' + spanGamut + '</h' + hLevel + '>';\r\n    return showdown.subParser('hashBlock')(hashBlock, options, globals);\r\n  });\r\n\r\n  // atx-style headers:\r\n  //  # Header 1\r\n  //  ## Header 2\r\n  //  ## Header 2 with closing hashes ##\r\n  //  ...\r\n  //  ###### Header 6\r\n  //\r\n  text = text.replace(/^(#{1,6})[ \\t]*(.+?)[ \\t]*#*\\n+/gm, function (wholeMatch, m1, m2) {\r\n    var span = showdown.subParser('spanGamut')(m2, options, globals),\r\n        hID = (options.noHeaderId) ? '' : ' id=\"' + headerId(m2) + '\"',\r\n        hLevel = headerLevelStart - 1 + m1.length,\r\n        header = '<h' + hLevel + hID + '>' + span + '</h' + hLevel + '>';\r\n\r\n    return showdown.subParser('hashBlock')(header, options, globals);\r\n  });\r\n\r\n  function headerId(m) {\r\n    var title, escapedId = m.replace(/[^\\w]/g, '').toLowerCase();\r\n\r\n    if (globals.hashLinkCounts[escapedId]) {\r\n      title = escapedId + '-' + (globals.hashLinkCounts[escapedId]++);\r\n    } else {\r\n      title = escapedId;\r\n      globals.hashLinkCounts[escapedId] = 1;\r\n    }\r\n\r\n    // Prefix id to prevent causing inadvertent pre-existing style matches.\r\n    if (prefixHeader === true) {\r\n      prefixHeader = 'section';\r\n    }\r\n\r\n    if (showdown.helper.isString(prefixHeader)) {\r\n      return prefixHeader + title;\r\n    }\r\n    return title;\r\n  }\r\n\r\n  text = globals.converter._dispatch('headers.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\n/**\r\n * Turn Markdown image shortcuts into <img> tags.\r\n */\r\nshowdown.subParser('images', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('images.before', text, options, globals);\r\n\r\n  var inlineRegExp    = /!\\[(.*?)]\\s?\\([ \\t]*()<?(\\S+?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:(['\"])(.*?)\\6[ \\t]*)?\\)/g,\r\n      referenceRegExp = /!\\[([^\\]]*?)] ?(?:\\n *)?\\[(.*?)]()()()()()/g;\r\n\r\n  function writeImageTag (wholeMatch, altText, linkId, url, width, height, m5, title) {\r\n\r\n    var gUrls   = globals.gUrls,\r\n        gTitles = globals.gTitles,\r\n        gDims   = globals.gDimensions;\r\n\r\n    linkId = linkId.toLowerCase();\r\n\r\n    if (!title) {\r\n      title = '';\r\n    }\r\n\r\n    if (url === '' || url === null) {\r\n      if (linkId === '' || linkId === null) {\r\n        // lower-case and turn embedded newlines into spaces\r\n        linkId = altText.toLowerCase().replace(/ ?\\n/g, ' ');\r\n      }\r\n      url = '#' + linkId;\r\n\r\n      if (!showdown.helper.isUndefined(gUrls[linkId])) {\r\n        url = gUrls[linkId];\r\n        if (!showdown.helper.isUndefined(gTitles[linkId])) {\r\n          title = gTitles[linkId];\r\n        }\r\n        if (!showdown.helper.isUndefined(gDims[linkId])) {\r\n          width = gDims[linkId].width;\r\n          height = gDims[linkId].height;\r\n        }\r\n      } else {\r\n        return wholeMatch;\r\n      }\r\n    }\r\n\r\n    altText = altText.replace(/\"/g, '&quot;');\r\n    altText = showdown.helper.escapeCharacters(altText, '*_', false);\r\n    url = showdown.helper.escapeCharacters(url, '*_', false);\r\n    var result = '<img src=\"' + url + '\" alt=\"' + altText + '\"';\r\n\r\n    if (title) {\r\n      title = title.replace(/\"/g, '&quot;');\r\n      title = showdown.helper.escapeCharacters(title, '*_', false);\r\n      result += ' title=\"' + title + '\"';\r\n    }\r\n\r\n    if (width && height) {\r\n      width  = (width === '*') ? 'auto' : width;\r\n      height = (height === '*') ? 'auto' : height;\r\n\r\n      result += ' width=\"' + width + '\"';\r\n      result += ' height=\"' + height + '\"';\r\n    }\r\n\r\n    result += ' />';\r\n    return result;\r\n  }\r\n\r\n  // First, handle reference-style labeled images: ![alt text][id]\r\n  text = text.replace(referenceRegExp, writeImageTag);\r\n\r\n  // Next, handle inline images:  ![alt text](url =<width>x<height> \"optional title\")\r\n  text = text.replace(inlineRegExp, writeImageTag);\r\n\r\n  text = globals.converter._dispatch('images.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\nshowdown.subParser('italicsAndBold', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('italicsAndBold.before', text, options, globals);\r\n\r\n  if (options.literalMidWordUnderscores) {\r\n    //underscores\r\n    // Since we are consuming a \\s character, we need to add it\r\n    text = text.replace(/(^|\\s|>|\\b)__(?=\\S)([\\s\\S]+?)__(?=\\b|<|\\s|$)/gm, '$1<strong>$2</strong>');\r\n    text = text.replace(/(^|\\s|>|\\b)_(?=\\S)([\\s\\S]+?)_(?=\\b|<|\\s|$)/gm, '$1<em>$2</em>');\r\n    //asterisks\r\n    text = text.replace(/(\\*\\*)(?=\\S)([^\\r]*?\\S[*]*)\\1/g, '<strong>$2</strong>');\r\n    text = text.replace(/(\\*)(?=\\S)([^\\r]*?\\S)\\1/g, '<em>$2</em>');\r\n\r\n  } else {\r\n    // <strong> must go first:\r\n    text = text.replace(/(\\*\\*|__)(?=\\S)([^\\r]*?\\S[*_]*)\\1/g, '<strong>$2</strong>');\r\n    text = text.replace(/(\\*|_)(?=\\S)([^\\r]*?\\S)\\1/g, '<em>$2</em>');\r\n  }\r\n\r\n  text = globals.converter._dispatch('italicsAndBold.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\n/**\r\n * Form HTML ordered (numbered) and unordered (bulleted) lists.\r\n */\r\nshowdown.subParser('lists', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('lists.before', text, options, globals);\r\n  /**\r\n   * Process the contents of a single ordered or unordered list, splitting it\r\n   * into individual list items.\r\n   * @param {string} listStr\r\n   * @param {boolean} trimTrailing\r\n   * @returns {string}\r\n   */\r\n  function processListItems (listStr, trimTrailing) {\r\n    // The $g_list_level global keeps track of when we're inside a list.\r\n    // Each time we enter a list, we increment it; when we leave a list,\r\n    // we decrement. If it's zero, we're not in a list anymore.\r\n    //\r\n    // We do this because when we're not inside a list, we want to treat\r\n    // something like this:\r\n    //\r\n    //    I recommend upgrading to version\r\n    //    8. Oops, now this line is treated\r\n    //    as a sub-list.\r\n    //\r\n    // As a single paragraph, despite the fact that the second line starts\r\n    // with a digit-period-space sequence.\r\n    //\r\n    // Whereas when we're inside a list (or sub-list), that line will be\r\n    // treated as the start of a sub-list. What a kludge, huh? This is\r\n    // an aspect of Markdown's syntax that's hard to parse perfectly\r\n    // without resorting to mind-reading. Perhaps the solution is to\r\n    // change the syntax rules such that sub-lists must start with a\r\n    // starting cardinal number; e.g. \"1.\" or \"a.\".\r\n    globals.gListLevel++;\r\n\r\n    // trim trailing blank lines:\r\n    listStr = listStr.replace(/\\n{2,}$/, '\\n');\r\n\r\n    // attacklab: add sentinel to emulate \\z\r\n    listStr += '~0';\r\n\r\n    var rgx = /(\\n)?(^[ \\t]*)([*+-]|\\d+[.])[ \\t]+((\\[(x|X| )?])?[ \\t]*[^\\r]+?(\\n{1,2}))(?=\\n*(~0|\\2([*+-]|\\d+[.])[ \\t]+))/gm,\r\n        isParagraphed = (/\\n[ \\t]*\\n(?!~0)/.test(listStr));\r\n\r\n    listStr = listStr.replace(rgx, function (wholeMatch, m1, m2, m3, m4, taskbtn, checked) {\r\n      checked = (checked && checked.trim() !== '');\r\n      var item = showdown.subParser('outdent')(m4, options, globals),\r\n          bulletStyle = '';\r\n\r\n      // Support for github tasklists\r\n      if (taskbtn && options.tasklists) {\r\n        bulletStyle = ' class=\"task-list-item\" style=\"list-style-type: none;\"';\r\n        item = item.replace(/^[ \\t]*\\[(x|X| )?]/m, function () {\r\n          var otp = '<input type=\"checkbox\" disabled style=\"margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;\"';\r\n          if (checked) {\r\n            otp += ' checked';\r\n          }\r\n          otp += '>';\r\n          return otp;\r\n        });\r\n      }\r\n      // m1 - Leading line or\r\n      // Has a double return (multi paragraph) or\r\n      // Has sublist\r\n      if (m1 || (item.search(/\\n{2,}/) > -1)) {\r\n        item = showdown.subParser('githubCodeBlocks')(item, options, globals);\r\n        item = showdown.subParser('blockGamut')(item, options, globals);\r\n      } else {\r\n        // Recursion for sub-lists:\r\n        item = showdown.subParser('lists')(item, options, globals);\r\n        item = item.replace(/\\n$/, ''); // chomp(item)\r\n        if (isParagraphed) {\r\n          item = showdown.subParser('paragraphs')(item, options, globals);\r\n        } else {\r\n          item = showdown.subParser('spanGamut')(item, options, globals);\r\n        }\r\n      }\r\n      item =  '\\n<li' + bulletStyle + '>' + item + '</li>\\n';\r\n      return item;\r\n    });\r\n\r\n    // attacklab: strip sentinel\r\n    listStr = listStr.replace(/~0/g, '');\r\n\r\n    globals.gListLevel--;\r\n\r\n    if (trimTrailing) {\r\n      listStr = listStr.replace(/\\s+$/, '');\r\n    }\r\n\r\n    return listStr;\r\n  }\r\n\r\n  /**\r\n   * Check and parse consecutive lists (better fix for issue #142)\r\n   * @param {string} list\r\n   * @param {string} listType\r\n   * @param {boolean} trimTrailing\r\n   * @returns {string}\r\n   */\r\n  function parseConsecutiveLists(list, listType, trimTrailing) {\r\n    // check if we caught 2 or more consecutive lists by mistake\r\n    // we use the counterRgx, meaning if listType is UL we look for UL and vice versa\r\n    var counterRxg = (listType === 'ul') ? /^ {0,2}\\d+\\.[ \\t]/gm : /^ {0,2}[*+-][ \\t]/gm,\r\n      subLists = [],\r\n      result = '';\r\n\r\n    if (list.search(counterRxg) !== -1) {\r\n      (function parseCL(txt) {\r\n        var pos = txt.search(counterRxg);\r\n        if (pos !== -1) {\r\n          // slice\r\n          result += '\\n\\n<' + listType + '>' + processListItems(txt.slice(0, pos), !!trimTrailing) + '</' + listType + '>\\n\\n';\r\n\r\n          // invert counterType and listType\r\n          listType = (listType === 'ul') ? 'ol' : 'ul';\r\n          counterRxg = (listType === 'ul') ? /^ {0,2}\\d+\\.[ \\t]/gm : /^ {0,2}[*+-][ \\t]/gm;\r\n\r\n          //recurse\r\n          parseCL(txt.slice(pos));\r\n        } else {\r\n          result += '\\n\\n<' + listType + '>' + processListItems(txt, !!trimTrailing) + '</' + listType + '>\\n\\n';\r\n        }\r\n      })(list);\r\n      for (var i = 0; i < subLists.length; ++i) {\r\n\r\n      }\r\n    } else {\r\n      result = '\\n\\n<' + listType + '>' + processListItems(list, !!trimTrailing) + '</' + listType + '>\\n\\n';\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  // attacklab: add sentinel to hack around khtml/safari bug:\r\n  // http://bugs.webkit.org/show_bug.cgi?id=11231\r\n  text += '~0';\r\n\r\n  // Re-usable pattern to match any entire ul or ol list:\r\n  var wholeList = /^(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;\r\n\r\n  if (globals.gListLevel) {\r\n    text = text.replace(wholeList, function (wholeMatch, list, m2) {\r\n      var listType = (m2.search(/[*+-]/g) > -1) ? 'ul' : 'ol';\r\n      return parseConsecutiveLists(list, listType, true);\r\n    });\r\n  } else {\r\n    wholeList = /(\\n\\n|^\\n?)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;\r\n    //wholeList = /(\\n\\n|^\\n?)( {0,3}([*+-]|\\d+\\.)[ \\t]+[\\s\\S]+?)(?=(~0)|(\\n\\n(?!\\t| {2,}| {0,3}([*+-]|\\d+\\.)[ \\t])))/g;\r\n    text = text.replace(wholeList, function (wholeMatch, m1, list, m3) {\r\n\r\n      var listType = (m3.search(/[*+-]/g) > -1) ? 'ul' : 'ol';\r\n      return parseConsecutiveLists(list, listType);\r\n    });\r\n  }\r\n\r\n  // attacklab: strip sentinel\r\n  text = text.replace(/~0/, '');\r\n\r\n  text = globals.converter._dispatch('lists.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\n/**\r\n * Remove one level of line-leading tabs or spaces\r\n */\r\nshowdown.subParser('outdent', function (text) {\r\n  'use strict';\r\n\r\n  // attacklab: hack around Konqueror 3.5.4 bug:\r\n  // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\r\n  text = text.replace(/^(\\t|[ ]{1,4})/gm, '~0'); // attacklab: g_tab_width\r\n\r\n  // attacklab: clean up hack\r\n  text = text.replace(/~0/g, '');\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n *\r\n */\r\nshowdown.subParser('paragraphs', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('paragraphs.before', text, options, globals);\r\n  // Strip leading and trailing lines:\r\n  text = text.replace(/^\\n+/g, '');\r\n  text = text.replace(/\\n+$/g, '');\r\n\r\n  var grafs = text.split(/\\n{2,}/g),\r\n      grafsOut = [],\r\n      end = grafs.length; // Wrap <p> tags\r\n\r\n  for (var i = 0; i < end; i++) {\r\n    var str = grafs[i];\r\n    // if this is an HTML marker, copy it\r\n    if (str.search(/~(K|G)(\\d+)\\1/g) >= 0) {\r\n      grafsOut.push(str);\r\n    } else {\r\n      str = showdown.subParser('spanGamut')(str, options, globals);\r\n      str = str.replace(/^([ \\t]*)/g, '<p>');\r\n      str += '</p>';\r\n      grafsOut.push(str);\r\n    }\r\n  }\r\n\r\n  /** Unhashify HTML blocks */\r\n  end = grafsOut.length;\r\n  for (i = 0; i < end; i++) {\r\n    var blockText = '',\r\n        grafsOutIt = grafsOut[i],\r\n        codeFlag = false;\r\n    // if this is a marker for an html block...\r\n    while (grafsOutIt.search(/~(K|G)(\\d+)\\1/) >= 0) {\r\n      var delim = RegExp.$1,\r\n          num   = RegExp.$2;\r\n\r\n      if (delim === 'K') {\r\n        blockText = globals.gHtmlBlocks[num];\r\n      } else {\r\n        // we need to check if ghBlock is a false positive\r\n        if (codeFlag) {\r\n          // use encoded version of all text\r\n          blockText = showdown.subParser('encodeCode')(globals.ghCodeBlocks[num].text);\r\n        } else {\r\n          blockText = globals.ghCodeBlocks[num].codeblock;\r\n        }\r\n      }\r\n      blockText = blockText.replace(/\\$/g, '$$$$'); // Escape any dollar signs\r\n\r\n      grafsOutIt = grafsOutIt.replace(/(\\n\\n)?~(K|G)\\d+\\2(\\n\\n)?/, blockText);\r\n      // Check if grafsOutIt is a pre->code\r\n      if (/^<pre\\b[^>]*>\\s*<code\\b[^>]*>/.test(grafsOutIt)) {\r\n        codeFlag = true;\r\n      }\r\n    }\r\n    grafsOut[i] = grafsOutIt;\r\n  }\r\n  text = grafsOut.join('\\n\\n');\r\n  // Strip leading and trailing lines:\r\n  text = text.replace(/^\\n+/g, '');\r\n  text = text.replace(/\\n+$/g, '');\r\n  return globals.converter._dispatch('paragraphs.after', text, options, globals);\r\n});\r\n\r\n/**\r\n * Run extension\r\n */\r\nshowdown.subParser('runExtension', function (ext, text, options, globals) {\r\n  'use strict';\r\n\r\n  if (ext.filter) {\r\n    text = ext.filter(text, globals.converter, options);\r\n\r\n  } else if (ext.regex) {\r\n    // TODO remove this when old extension loading mechanism is deprecated\r\n    var re = ext.regex;\r\n    if (!re instanceof RegExp) {\r\n      re = new RegExp(re, 'g');\r\n    }\r\n    text = text.replace(re, ext.replace);\r\n  }\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * These are all the transformations that occur *within* block-level\r\n * tags like paragraphs, headers, and list items.\r\n */\r\nshowdown.subParser('spanGamut', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  text = globals.converter._dispatch('spanGamut.before', text, options, globals);\r\n  text = showdown.subParser('codeSpans')(text, options, globals);\r\n  text = showdown.subParser('escapeSpecialCharsWithinTagAttributes')(text, options, globals);\r\n  text = showdown.subParser('encodeBackslashEscapes')(text, options, globals);\r\n\r\n  // Process anchor and image tags. Images must come first,\r\n  // because ![foo][f] looks like an anchor.\r\n  text = showdown.subParser('images')(text, options, globals);\r\n  text = showdown.subParser('anchors')(text, options, globals);\r\n\r\n  // Make links out of things like `<http://example.com/>`\r\n  // Must come after _DoAnchors(), because you can use < and >\r\n  // delimiters in inline links like [this](<url>).\r\n  text = showdown.subParser('autoLinks')(text, options, globals);\r\n  text = showdown.subParser('encodeAmpsAndAngles')(text, options, globals);\r\n  text = showdown.subParser('italicsAndBold')(text, options, globals);\r\n  text = showdown.subParser('strikethrough')(text, options, globals);\r\n\r\n  // Do hard breaks:\r\n  text = text.replace(/  +\\n/g, ' <br />\\n');\r\n\r\n  text = globals.converter._dispatch('spanGamut.after', text, options, globals);\r\n  return text;\r\n});\r\n\r\nshowdown.subParser('strikethrough', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  if (options.strikethrough) {\r\n    text = globals.converter._dispatch('strikethrough.before', text, options, globals);\r\n    text = text.replace(/(?:~T){2}([\\s\\S]+?)(?:~T){2}/g, '<del>$1</del>');\r\n    text = globals.converter._dispatch('strikethrough.after', text, options, globals);\r\n  }\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * Strip any lines consisting only of spaces and tabs.\r\n * This makes subsequent regexs easier to write, because we can\r\n * match consecutive blank lines with /\\n+/ instead of something\r\n * contorted like /[ \\t]*\\n+/\r\n */\r\nshowdown.subParser('stripBlankLines', function (text) {\r\n  'use strict';\r\n  return text.replace(/^[ \\t]+$/mg, '');\r\n});\r\n\r\n/**\r\n * Strips link definitions from text, stores the URLs and titles in\r\n * hash references.\r\n * Link defs are in the form: ^[id]: url \"optional title\"\r\n *\r\n * ^[ ]{0,3}\\[(.+)\\]: // id = $1  attacklab: g_tab_width - 1\r\n * [ \\t]*\r\n * \\n?                  // maybe *one* newline\r\n * [ \\t]*\r\n * <?(\\S+?)>?          // url = $2\r\n * [ \\t]*\r\n * \\n?                // maybe one newline\r\n * [ \\t]*\r\n * (?:\r\n * (\\n*)              // any lines skipped = $3 attacklab: lookbehind removed\r\n * [\"(]\r\n * (.+?)              // title = $4\r\n * [\")]\r\n * [ \\t]*\r\n * )?                 // title is optional\r\n * (?:\\n+|$)\r\n * /gm,\r\n * function(){...});\r\n *\r\n */\r\nshowdown.subParser('stripLinkDefinitions', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  var regex = /^ {0,3}\\[(.+)]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"|'(](.+?)[\"|')][ \\t]*)?(?:\\n+|(?=~0))/gm;\r\n\r\n  // attacklab: sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\r\n  text += '~0';\r\n\r\n  text = text.replace(regex, function (wholeMatch, linkId, url, width, height, blankLines, title) {\r\n    linkId = linkId.toLowerCase();\r\n    globals.gUrls[linkId] = showdown.subParser('encodeAmpsAndAngles')(url);  // Link IDs are case-insensitive\r\n\r\n    if (blankLines) {\r\n      // Oops, found blank lines, so it's not a title.\r\n      // Put back the parenthetical statement we stole.\r\n      return blankLines + title;\r\n\r\n    } else {\r\n      if (title) {\r\n        globals.gTitles[linkId] = title.replace(/\"|'/g, '&quot;');\r\n      }\r\n      if (options.parseImgDimensions && width && height) {\r\n        globals.gDimensions[linkId] = {\r\n          width:  width,\r\n          height: height\r\n        };\r\n      }\r\n    }\r\n    // Completely remove the definition from the text\r\n    return '';\r\n  });\r\n\r\n  // attacklab: strip sentinel\r\n  text = text.replace(/~0/, '');\r\n\r\n  return text;\r\n});\r\n\r\nshowdown.subParser('tables', function (text, options, globals) {\r\n  'use strict';\r\n\r\n  if (!options.tables) {\r\n    return text;\r\n  }\r\n\r\n  var tableRgx = /^[ \\t]{0,3}\\|?.+\\|.+\\n[ \\t]{0,3}\\|?[ \\t]*:?[ \\t]*(?:-|=){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*:?[ \\t]*(?:-|=){2,}[\\s\\S]+?(?:\\n\\n|~0)/gm;\r\n\r\n  function parseStyles(sLine) {\r\n    if (/^:[ \\t]*--*$/.test(sLine)) {\r\n      return ' style=\"text-align:left;\"';\r\n    } else if (/^--*[ \\t]*:[ \\t]*$/.test(sLine)) {\r\n      return ' style=\"text-align:right;\"';\r\n    } else if (/^:[ \\t]*--*[ \\t]*:$/.test(sLine)) {\r\n      return ' style=\"text-align:center;\"';\r\n    } else {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  function parseHeaders(header, style) {\r\n    var id = '';\r\n    header = header.trim();\r\n    if (options.tableHeaderId) {\r\n      id = ' id=\"' + header.replace(/ /g, '_').toLowerCase() + '\"';\r\n    }\r\n    header = showdown.subParser('spanGamut')(header, options, globals);\r\n\r\n    return '<th' + id + style + '>' + header + '</th>\\n';\r\n  }\r\n\r\n  function parseCells(cell, style) {\r\n    var subText = showdown.subParser('spanGamut')(cell, options, globals);\r\n    return '<td' + style + '>' + subText + '</td>\\n';\r\n  }\r\n\r\n  function buildTable(headers, cells) {\r\n    var tb = '<table>\\n<thead>\\n<tr>\\n',\r\n        tblLgn = headers.length;\r\n\r\n    for (var i = 0; i < tblLgn; ++i) {\r\n      tb += headers[i];\r\n    }\r\n    tb += '</tr>\\n</thead>\\n<tbody>\\n';\r\n\r\n    for (i = 0; i < cells.length; ++i) {\r\n      tb += '<tr>\\n';\r\n      for (var ii = 0; ii < tblLgn; ++ii) {\r\n        tb += cells[i][ii];\r\n      }\r\n      tb += '</tr>\\n';\r\n    }\r\n    tb += '</tbody>\\n</table>\\n';\r\n    return tb;\r\n  }\r\n\r\n  text = globals.converter._dispatch('tables.before', text, options, globals);\r\n\r\n  text = text.replace(tableRgx, function (rawTable) {\r\n\r\n    var i, tableLines = rawTable.split('\\n');\r\n\r\n    // strip wrong first and last column if wrapped tables are used\r\n    for (i = 0; i < tableLines.length; ++i) {\r\n      if (/^[ \\t]{0,3}\\|/.test(tableLines[i])) {\r\n        tableLines[i] = tableLines[i].replace(/^[ \\t]{0,3}\\|/, '');\r\n      }\r\n      if (/\\|[ \\t]*$/.test(tableLines[i])) {\r\n        tableLines[i] = tableLines[i].replace(/\\|[ \\t]*$/, '');\r\n      }\r\n    }\r\n\r\n    var rawHeaders = tableLines[0].split('|').map(function (s) { return s.trim();}),\r\n        rawStyles = tableLines[1].split('|').map(function (s) { return s.trim();}),\r\n        rawCells = [],\r\n        headers = [],\r\n        styles = [],\r\n        cells = [];\r\n\r\n    tableLines.shift();\r\n    tableLines.shift();\r\n\r\n    for (i = 0; i < tableLines.length; ++i) {\r\n      if (tableLines[i].trim() === '') {\r\n        continue;\r\n      }\r\n      rawCells.push(\r\n        tableLines[i]\r\n          .split('|')\r\n          .map(function (s) {\r\n            return s.trim();\r\n          })\r\n      );\r\n    }\r\n\r\n    if (rawHeaders.length < rawStyles.length) {\r\n      return rawTable;\r\n    }\r\n\r\n    for (i = 0; i < rawStyles.length; ++i) {\r\n      styles.push(parseStyles(rawStyles[i]));\r\n    }\r\n\r\n    for (i = 0; i < rawHeaders.length; ++i) {\r\n      if (showdown.helper.isUndefined(styles[i])) {\r\n        styles[i] = '';\r\n      }\r\n      headers.push(parseHeaders(rawHeaders[i], styles[i]));\r\n    }\r\n\r\n    for (i = 0; i < rawCells.length; ++i) {\r\n      var row = [];\r\n      for (var ii = 0; ii < headers.length; ++ii) {\r\n        if (showdown.helper.isUndefined(rawCells[i][ii])) {\r\n\r\n        }\r\n        row.push(parseCells(rawCells[i][ii], styles[ii]));\r\n      }\r\n      cells.push(row);\r\n    }\r\n\r\n    return buildTable(headers, cells);\r\n  });\r\n\r\n  text = globals.converter._dispatch('tables.after', text, options, globals);\r\n\r\n  return text;\r\n});\r\n\r\n/**\r\n * Swap back in all the special characters we've hidden.\r\n */\r\nshowdown.subParser('unescapeSpecialChars', function (text) {\r\n  'use strict';\r\n\r\n  text = text.replace(/~E(\\d+)E/g, function (wholeMatch, m1) {\r\n    var charCodeToReplace = parseInt(m1);\r\n    return String.fromCharCode(charCodeToReplace);\r\n  });\r\n  return text;\r\n});\r\nmodule.exports = showdown;\r\n","/**\r\n * \r\n */\r\n\r\nlet windowWidth = 0\r\nlet windowHeight = 0\r\nwx.getSystemInfo({\r\n  success(res) {\r\n    windowWidth = res.windowWidth\r\n    windowHeight = res.windowHeight\r\n  }\r\n})\r\n\r\nconst getSystemInfo = () => {\r\n  return [ windowWidth, windowHeight ]\r\n}\r\n\r\nconst bindInstance = (() => {\r\n  let instance = null\r\n\r\n  return {\r\n    set: (bindName, data = null) => {\r\n      if (!instance) {\r\n        instance = {\r\n          [bindName]: data\r\n        } \r\n      }\r\n      return instance[bindName]\r\n    },\r\n    clear: () => {\r\n      instance = null\r\n    }\r\n  }\r\n})();\r\n\r\nmodule.exports = {\r\n  getSystemInfo,\r\n  bindInstance,\r\n}\r\n"],"sourceRoot":""}